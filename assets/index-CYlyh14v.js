var Qm=l=>{throw TypeError(l)};var Dh=(l,t,e)=>t.has(l)||Qm("Cannot "+e);var Wt=(l,t,e)=>(Dh(l,t,"read from private field"),e?e.call(l):t.get(l)),Ii=(l,t,e)=>t.has(l)?Qm("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(l):t.set(l,e),Xe=(l,t,e,s)=>(Dh(l,t,"write to private field"),s?s.call(l,e):t.set(l,e),e),Ui=(l,t,e)=>(Dh(l,t,"access private method"),e);var Jm=(l,t,e,s)=>({set _(a){Xe(l,t,a,e)},get _(){return Wt(l,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function e(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(a){if(a.ep)return;a.ep=!0;const r=e(a);fetch(a.href,r)}})();var Mh={exports:{}},Nr={};var Zm;function Q_(){if(Zm)return Nr;Zm=1;var l=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(s,a,r){var c=null;if(r!==void 0&&(c=""+r),a.key!==void 0&&(c=""+a.key),"key"in a){r={};for(var u in a)u!=="key"&&(r[u]=a[u])}else r=a;return a=r.ref,{$$typeof:l,type:s,key:c,ref:a!==void 0?a:null,props:r}}return Nr.Fragment=t,Nr.jsx=e,Nr.jsxs=e,Nr}var ty;function J_(){return ty||(ty=1,Mh.exports=Q_()),Mh.exports}var st=J_(),Nh={exports:{}},pt={};var ey;function Z_(){if(ey)return pt;ey=1;var l=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),v=Symbol.iterator;function b(M){return M===null||typeof M!="object"?null:(M=v&&M[v]||M["@@iterator"],typeof M=="function"?M:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,E={};function S(M,H,X){this.props=M,this.context=H,this.refs=E,this.updater=X||A}S.prototype.isReactComponent={},S.prototype.setState=function(M,H){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,H,"setState")},S.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function x(){}x.prototype=S.prototype;function C(M,H,X){this.props=M,this.context=H,this.refs=E,this.updater=X||A}var k=C.prototype=new x;k.constructor=C,w(k,S.prototype),k.isPureReactComponent=!0;var L=Array.isArray;function R(){}var D={H:null,A:null,T:null,S:null},z=Object.prototype.hasOwnProperty;function Y(M,H,X){var J=X.ref;return{$$typeof:l,type:M,key:H,ref:J!==void 0?J:null,props:X}}function Q(M,H){return Y(M.type,H,M.props)}function K(M){return typeof M=="object"&&M!==null&&M.$$typeof===l}function dt(M){var H={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(X){return H[X]})}var St=/\/+/g;function vt(M,H){return typeof M=="object"&&M!==null&&M.key!=null?dt(""+M.key):H.toString(36)}function At(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(R,R):(M.status="pending",M.then(function(H){M.status==="pending"&&(M.status="fulfilled",M.value=H)},function(H){M.status==="pending"&&(M.status="rejected",M.reason=H)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function P(M,H,X,J,ot){var ft=typeof M;(ft==="undefined"||ft==="boolean")&&(M=null);var lt=!1;if(M===null)lt=!0;else switch(ft){case"bigint":case"string":case"number":lt=!0;break;case"object":switch(M.$$typeof){case l:case t:lt=!0;break;case p:return lt=M._init,P(lt(M._payload),H,X,J,ot)}}if(lt)return ot=ot(M),lt=J===""?"."+vt(M,0):J,L(ot)?(X="",lt!=null&&(X=lt.replace(St,"$&/")+"/"),P(ot,H,X,"",function(Ks){return Ks})):ot!=null&&(K(ot)&&(ot=Q(ot,X+(ot.key==null||M&&M.key===ot.key?"":(""+ot.key).replace(St,"$&/")+"/")+lt)),H.push(ot)),1;lt=0;var ae=J===""?".":J+":";if(L(M))for(var $t=0;$t<M.length;$t++)J=M[$t],ft=ae+vt(J,$t),lt+=P(J,H,X,ft,ot);else if($t=b(M),typeof $t=="function")for(M=$t.call(M),$t=0;!(J=M.next()).done;)J=J.value,ft=ae+vt(J,$t++),lt+=P(J,H,X,ft,ot);else if(ft==="object"){if(typeof M.then=="function")return P(At(M),H,X,J,ot);throw H=String(M),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return lt}function G(M,H,X){if(M==null)return M;var J=[],ot=0;return P(M,J,"","",function(ft){return H.call(X,ft,ot++)}),J}function W(M){if(M._status===-1){var H=M._result;H=H(),H.then(function(X){(M._status===0||M._status===-1)&&(M._status=1,M._result=X)},function(X){(M._status===0||M._status===-1)&&(M._status=2,M._result=X)}),M._status===-1&&(M._status=0,M._result=H)}if(M._status===1)return M._result.default;throw M._result}var gt=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)},Et={map:G,forEach:function(M,H,X){G(M,function(){H.apply(this,arguments)},X)},count:function(M){var H=0;return G(M,function(){H++}),H},toArray:function(M){return G(M,function(H){return H})||[]},only:function(M){if(!K(M))throw Error("React.Children.only expected to receive a single React element child.");return M}};return pt.Activity=y,pt.Children=Et,pt.Component=S,pt.Fragment=e,pt.Profiler=a,pt.PureComponent=C,pt.StrictMode=s,pt.Suspense=d,pt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,pt.__COMPILER_RUNTIME={__proto__:null,c:function(M){return D.H.useMemoCache(M)}},pt.cache=function(M){return function(){return M.apply(null,arguments)}},pt.cacheSignal=function(){return null},pt.cloneElement=function(M,H,X){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var J=w({},M.props),ot=M.key;if(H!=null)for(ft in H.key!==void 0&&(ot=""+H.key),H)!z.call(H,ft)||ft==="key"||ft==="__self"||ft==="__source"||ft==="ref"&&H.ref===void 0||(J[ft]=H[ft]);var ft=arguments.length-2;if(ft===1)J.children=X;else if(1<ft){for(var lt=Array(ft),ae=0;ae<ft;ae++)lt[ae]=arguments[ae+2];J.children=lt}return Y(M.type,ot,J)},pt.createContext=function(M){return M={$$typeof:c,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:r,_context:M},M},pt.createElement=function(M,H,X){var J,ot={},ft=null;if(H!=null)for(J in H.key!==void 0&&(ft=""+H.key),H)z.call(H,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(ot[J]=H[J]);var lt=arguments.length-2;if(lt===1)ot.children=X;else if(1<lt){for(var ae=Array(lt),$t=0;$t<lt;$t++)ae[$t]=arguments[$t+2];ot.children=ae}if(M&&M.defaultProps)for(J in lt=M.defaultProps,lt)ot[J]===void 0&&(ot[J]=lt[J]);return Y(M,ft,ot)},pt.createRef=function(){return{current:null}},pt.forwardRef=function(M){return{$$typeof:u,render:M}},pt.isValidElement=K,pt.lazy=function(M){return{$$typeof:p,_payload:{_status:-1,_result:M},_init:W}},pt.memo=function(M,H){return{$$typeof:f,type:M,compare:H===void 0?null:H}},pt.startTransition=function(M){var H=D.T,X={};D.T=X;try{var J=M(),ot=D.S;ot!==null&&ot(X,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(R,gt)}catch(ft){gt(ft)}finally{H!==null&&X.types!==null&&(H.types=X.types),D.T=H}},pt.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},pt.use=function(M){return D.H.use(M)},pt.useActionState=function(M,H,X){return D.H.useActionState(M,H,X)},pt.useCallback=function(M,H){return D.H.useCallback(M,H)},pt.useContext=function(M){return D.H.useContext(M)},pt.useDebugValue=function(){},pt.useDeferredValue=function(M,H){return D.H.useDeferredValue(M,H)},pt.useEffect=function(M,H){return D.H.useEffect(M,H)},pt.useEffectEvent=function(M){return D.H.useEffectEvent(M)},pt.useId=function(){return D.H.useId()},pt.useImperativeHandle=function(M,H,X){return D.H.useImperativeHandle(M,H,X)},pt.useInsertionEffect=function(M,H){return D.H.useInsertionEffect(M,H)},pt.useLayoutEffect=function(M,H){return D.H.useLayoutEffect(M,H)},pt.useMemo=function(M,H){return D.H.useMemo(M,H)},pt.useOptimistic=function(M,H){return D.H.useOptimistic(M,H)},pt.useReducer=function(M,H,X){return D.H.useReducer(M,H,X)},pt.useRef=function(M){return D.H.useRef(M)},pt.useState=function(M){return D.H.useState(M)},pt.useSyncExternalStore=function(M,H,X){return D.H.useSyncExternalStore(M,H,X)},pt.useTransition=function(){return D.H.useTransition()},pt.version="19.2.3",pt}var iy;function Rd(){return iy||(iy=1,Nh.exports=Z_()),Nh.exports}var je=Rd(),Lh={exports:{}},Lr={},Bh={exports:{}},Ph={};var sy;function tw(){return sy||(sy=1,(function(l){function t(P,G){var W=P.length;P.push(G);t:for(;0<W;){var gt=W-1>>>1,Et=P[gt];if(0<a(Et,G))P[gt]=G,P[W]=Et,W=gt;else break t}}function e(P){return P.length===0?null:P[0]}function s(P){if(P.length===0)return null;var G=P[0],W=P.pop();if(W!==G){P[0]=W;t:for(var gt=0,Et=P.length,M=Et>>>1;gt<M;){var H=2*(gt+1)-1,X=P[H],J=H+1,ot=P[J];if(0>a(X,W))J<Et&&0>a(ot,X)?(P[gt]=ot,P[J]=W,gt=J):(P[gt]=X,P[H]=W,gt=H);else if(J<Et&&0>a(ot,W))P[gt]=ot,P[J]=W,gt=J;else break t}}return G}function a(P,G){var W=P.sortIndex-G.sortIndex;return W!==0?W:P.id-G.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;l.unstable_now=function(){return r.now()}}else{var c=Date,u=c.now();l.unstable_now=function(){return c.now()-u}}var d=[],f=[],p=1,y=null,v=3,b=!1,A=!1,w=!1,E=!1,S=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function k(P){for(var G=e(f);G!==null;){if(G.callback===null)s(f);else if(G.startTime<=P)s(f),G.sortIndex=G.expirationTime,t(d,G);else break;G=e(f)}}function L(P){if(w=!1,k(P),!A)if(e(d)!==null)A=!0,R||(R=!0,dt());else{var G=e(f);G!==null&&At(L,G.startTime-P)}}var R=!1,D=-1,z=5,Y=-1;function Q(){return E?!0:!(l.unstable_now()-Y<z)}function K(){if(E=!1,R){var P=l.unstable_now();Y=P;var G=!0;try{t:{A=!1,w&&(w=!1,x(D),D=-1),b=!0;var W=v;try{e:{for(k(P),y=e(d);y!==null&&!(y.expirationTime>P&&Q());){var gt=y.callback;if(typeof gt=="function"){y.callback=null,v=y.priorityLevel;var Et=gt(y.expirationTime<=P);if(P=l.unstable_now(),typeof Et=="function"){y.callback=Et,k(P),G=!0;break e}y===e(d)&&s(d),k(P)}else s(d);y=e(d)}if(y!==null)G=!0;else{var M=e(f);M!==null&&At(L,M.startTime-P),G=!1}}break t}finally{y=null,v=W,b=!1}G=void 0}}finally{G?dt():R=!1}}}var dt;if(typeof C=="function")dt=function(){C(K)};else if(typeof MessageChannel<"u"){var St=new MessageChannel,vt=St.port2;St.port1.onmessage=K,dt=function(){vt.postMessage(null)}}else dt=function(){S(K,0)};function At(P,G){D=S(function(){P(l.unstable_now())},G)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(P){P.callback=null},l.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<P?Math.floor(1e3/P):5},l.unstable_getCurrentPriorityLevel=function(){return v},l.unstable_next=function(P){switch(v){case 1:case 2:case 3:var G=3;break;default:G=v}var W=v;v=G;try{return P()}finally{v=W}},l.unstable_requestPaint=function(){E=!0},l.unstable_runWithPriority=function(P,G){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var W=v;v=P;try{return G()}finally{v=W}},l.unstable_scheduleCallback=function(P,G,W){var gt=l.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?gt+W:gt):W=gt,P){case 1:var Et=-1;break;case 2:Et=250;break;case 5:Et=1073741823;break;case 4:Et=1e4;break;default:Et=5e3}return Et=W+Et,P={id:p++,callback:G,priorityLevel:P,startTime:W,expirationTime:Et,sortIndex:-1},W>gt?(P.sortIndex=W,t(f,P),e(d)===null&&P===e(f)&&(w?(x(D),D=-1):w=!0,At(L,W-gt))):(P.sortIndex=Et,t(d,P),A||b||(A=!0,R||(R=!0,dt()))),P},l.unstable_shouldYield=Q,l.unstable_wrapCallback=function(P){var G=v;return function(){var W=v;v=G;try{return P.apply(this,arguments)}finally{v=W}}}})(Ph)),Ph}var ny;function ew(){return ny||(ny=1,Bh.exports=tw()),Bh.exports}var Ih={exports:{}},Ne={};var ay;function iw(){if(ay)return Ne;ay=1;var l=Rd();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var s={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function r(d,f,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:d,containerInfo:f,implementation:p}}var c=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Ne.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Ne.createPortal=function(d,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return r(d,f,null,p)},Ne.flushSync=function(d){var f=c.T,p=s.p;try{if(c.T=null,s.p=2,d)return d()}finally{c.T=f,s.p=p,s.d.f()}},Ne.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(d,f))},Ne.prefetchDNS=function(d){typeof d=="string"&&s.d.D(d)},Ne.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,b=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?s.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:v,fetchPriority:b}):p==="script"&&s.d.X(d,{crossOrigin:y,integrity:v,fetchPriority:b,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Ne.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);s.d.M(d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(d)},Ne.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin);s.d.L(d,p,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Ne.preloadModule=function(d,f){if(typeof d=="string")if(f){var p=u(f.as,f.crossOrigin);s.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(d)},Ne.requestFormReset=function(d){s.d.r(d)},Ne.unstable_batchedUpdates=function(d,f){return d(f)},Ne.useFormState=function(d,f,p){return c.H.useFormState(d,f,p)},Ne.useFormStatus=function(){return c.H.useHostTransitionStatus()},Ne.version="19.2.3",Ne}var ry;function sw(){if(ry)return Ih.exports;ry=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(t){console.error(t)}}return l(),Ih.exports=iw(),Ih.exports}var oy;function nw(){if(oy)return Lr;oy=1;var l=ew(),t=Rd(),e=sw();function s(i){var n="https://react.dev/errors/"+i;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+i+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function r(i){var n=i,o=i;if(i.alternate)for(;n.return;)n=n.return;else{i=n;do n=i,(n.flags&4098)!==0&&(o=n.return),i=n.return;while(i)}return n.tag===3?o:null}function c(i){if(i.tag===13){var n=i.memoizedState;if(n===null&&(i=i.alternate,i!==null&&(n=i.memoizedState)),n!==null)return n.dehydrated}return null}function u(i){if(i.tag===31){var n=i.memoizedState;if(n===null&&(i=i.alternate,i!==null&&(n=i.memoizedState)),n!==null)return n.dehydrated}return null}function d(i){if(r(i)!==i)throw Error(s(188))}function f(i){var n=i.alternate;if(!n){if(n=r(i),n===null)throw Error(s(188));return n!==i?null:i}for(var o=i,h=n;;){var g=o.return;if(g===null)break;var m=g.alternate;if(m===null){if(h=g.return,h!==null){o=h;continue}break}if(g.child===m.child){for(m=g.child;m;){if(m===o)return d(g),i;if(m===h)return d(g),n;m=m.sibling}throw Error(s(188))}if(o.return!==h.return)o=g,h=m;else{for(var _=!1,T=g.child;T;){if(T===o){_=!0,o=g,h=m;break}if(T===h){_=!0,h=g,o=m;break}T=T.sibling}if(!_){for(T=m.child;T;){if(T===o){_=!0,o=m,h=g;break}if(T===h){_=!0,h=m,o=g;break}T=T.sibling}if(!_)throw Error(s(189))}}if(o.alternate!==h)throw Error(s(190))}if(o.tag!==3)throw Error(s(188));return o.stateNode.current===o?i:n}function p(i){var n=i.tag;if(n===5||n===26||n===27||n===6)return i;for(i=i.child;i!==null;){if(n=p(i),n!==null)return n;i=i.sibling}return null}var y=Object.assign,v=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),x=Symbol.for("react.consumer"),C=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function dt(i){return i===null||typeof i!="object"?null:(i=K&&i[K]||i["@@iterator"],typeof i=="function"?i:null)}var St=Symbol.for("react.client.reference");function vt(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===St?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case w:return"Fragment";case S:return"Profiler";case E:return"StrictMode";case L:return"Suspense";case R:return"SuspenseList";case Y:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case A:return"Portal";case C:return i.displayName||"Context";case x:return(i._context.displayName||"Context")+".Consumer";case k:var n=i.render;return i=i.displayName,i||(i=n.displayName||n.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case D:return n=i.displayName||null,n!==null?n:vt(i.type)||"Memo";case z:n=i._payload,i=i._init;try{return vt(i(n))}catch{}}return null}var At=Array.isArray,P=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},gt=[],Et=-1;function M(i){return{current:i}}function H(i){0>Et||(i.current=gt[Et],gt[Et]=null,Et--)}function X(i,n){Et++,gt[Et]=i.current,i.current=n}var J=M(null),ot=M(null),ft=M(null),lt=M(null);function ae(i,n){switch(X(ft,n),X(ot,i),X(J,null),n.nodeType){case 9:case 11:i=(i=n.documentElement)&&(i=i.namespaceURI)?_m(i):0;break;default:if(i=n.tagName,n=n.namespaceURI)n=_m(n),i=wm(n,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}H(J),X(J,i)}function $t(){H(J),H(ot),H(ft)}function Ks(i){i.memoizedState!==null&&X(lt,i);var n=J.current,o=wm(n,i.type);n!==o&&(X(ot,i),X(J,o))}function gs(i){ot.current===i&&(H(J),H(ot)),lt.current===i&&(H(lt),Or._currentValue=W)}var Ws,za;function Gi(i){if(Ws===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);Ws=n&&n[1]||"",za=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ws+i+za}var gc=!1;function pc(i,n){if(!i||gc)return"";gc=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(n){var V=function(){throw Error()};if(Object.defineProperty(V.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(V,[])}catch(F){var j=F}Reflect.construct(i,[],V)}else{try{V.call()}catch(F){j=F}i.call(V.prototype)}}else{try{throw Error()}catch(F){j=F}(V=i())&&typeof V.catch=="function"&&V.catch(function(){})}}catch(F){if(F&&j&&typeof F.stack=="string")return[F.stack,j.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=h.DetermineComponentFrameRoot(),_=m[0],T=m[1];if(_&&T){var O=_.split(`
`),U=T.split(`
`);for(g=h=0;h<O.length&&!O[h].includes("DetermineComponentFrameRoot");)h++;for(;g<U.length&&!U[g].includes("DetermineComponentFrameRoot");)g++;if(h===O.length||g===U.length)for(h=O.length-1,g=U.length-1;1<=h&&0<=g&&O[h]!==U[g];)g--;for(;1<=h&&0<=g;h--,g--)if(O[h]!==U[g]){if(h!==1||g!==1)do if(h--,g--,0>g||O[h]!==U[g]){var $=`
`+O[h].replace(" at new "," at ");return i.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",i.displayName)),$}while(1<=h&&0<=g);break}}}finally{gc=!1,Error.prepareStackTrace=o}return(o=i?i.displayName||i.name:"")?Gi(o):""}function Rb(i,n){switch(i.tag){case 26:case 27:case 5:return Gi(i.type);case 16:return Gi("Lazy");case 13:return i.child!==n&&n!==null?Gi("Suspense Fallback"):Gi("Suspense");case 19:return Gi("SuspenseList");case 0:case 15:return pc(i.type,!1);case 11:return pc(i.type.render,!1);case 1:return pc(i.type,!0);case 31:return Gi("Activity");default:return""}}function Wd(i){try{var n="",o=null;do n+=Rb(i,o),o=i,i=i.return;while(i);return n}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var mc=Object.prototype.hasOwnProperty,yc=l.unstable_scheduleCallback,vc=l.unstable_cancelCallback,Ob=l.unstable_shouldYield,kb=l.unstable_requestPaint,Qe=l.unstable_now,Db=l.unstable_getCurrentPriorityLevel,Qd=l.unstable_ImmediatePriority,Jd=l.unstable_UserBlockingPriority,yo=l.unstable_NormalPriority,Mb=l.unstable_LowPriority,Zd=l.unstable_IdlePriority,Nb=l.log,Lb=l.unstable_setDisableYieldValue,Fa=null,Je=null;function ps(i){if(typeof Nb=="function"&&Lb(i),Je&&typeof Je.setStrictMode=="function")try{Je.setStrictMode(Fa,i)}catch{}}var Ze=Math.clz32?Math.clz32:Ib,Bb=Math.log,Pb=Math.LN2;function Ib(i){return i>>>=0,i===0?32:31-(Bb(i)/Pb|0)|0}var vo=256,bo=262144,_o=4194304;function Qs(i){var n=i&42;if(n!==0)return n;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function wo(i,n,o){var h=i.pendingLanes;if(h===0)return 0;var g=0,m=i.suspendedLanes,_=i.pingedLanes;i=i.warmLanes;var T=h&134217727;return T!==0?(h=T&~m,h!==0?g=Qs(h):(_&=T,_!==0?g=Qs(_):o||(o=T&~i,o!==0&&(g=Qs(o))))):(T=h&~m,T!==0?g=Qs(T):_!==0?g=Qs(_):o||(o=h&~i,o!==0&&(g=Qs(o)))),g===0?0:n!==0&&n!==g&&(n&m)===0&&(m=g&-g,o=n&-n,m>=o||m===32&&(o&4194048)!==0)?n:g}function Ha(i,n){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&n)===0}function Ub(i,n){switch(i){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tf(){var i=_o;return _o<<=1,(_o&62914560)===0&&(_o=4194304),i}function bc(i){for(var n=[],o=0;31>o;o++)n.push(i);return n}function $a(i,n){i.pendingLanes|=n,n!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function jb(i,n,o,h,g,m){var _=i.pendingLanes;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=o,i.entangledLanes&=o,i.errorRecoveryDisabledLanes&=o,i.shellSuspendCounter=0;var T=i.entanglements,O=i.expirationTimes,U=i.hiddenUpdates;for(o=_&~o;0<o;){var $=31-Ze(o),V=1<<$;T[$]=0,O[$]=-1;var j=U[$];if(j!==null)for(U[$]=null,$=0;$<j.length;$++){var F=j[$];F!==null&&(F.lane&=-536870913)}o&=~V}h!==0&&ef(i,h,0),m!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=m&~(_&~n))}function ef(i,n,o){i.pendingLanes|=n,i.suspendedLanes&=~n;var h=31-Ze(n);i.entangledLanes|=n,i.entanglements[h]=i.entanglements[h]|1073741824|o&261930}function sf(i,n){var o=i.entangledLanes|=n;for(i=i.entanglements;o;){var h=31-Ze(o),g=1<<h;g&n|i[h]&n&&(i[h]|=n),o&=~g}}function nf(i,n){var o=n&-n;return o=(o&42)!==0?1:_c(o),(o&(i.suspendedLanes|n))!==0?0:o}function _c(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function wc(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function af(){var i=G.p;return i!==0?i:(i=window.event,i===void 0?32:Gm(i.type))}function rf(i,n){var o=G.p;try{return G.p=i,n()}finally{G.p=o}}var ms=Math.random().toString(36).slice(2),Ae="__reactFiber$"+ms,Fe="__reactProps$"+ms,Dn="__reactContainer$"+ms,Ac="__reactEvents$"+ms,zb="__reactListeners$"+ms,Fb="__reactHandles$"+ms,of="__reactResources$"+ms,Ga="__reactMarker$"+ms;function Sc(i){delete i[Ae],delete i[Fe],delete i[Ac],delete i[zb],delete i[Fb]}function Mn(i){var n=i[Ae];if(n)return n;for(var o=i.parentNode;o;){if(n=o[Dn]||o[Ae]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(i=Rm(i);i!==null;){if(o=i[Ae])return o;i=Rm(i)}return n}i=o,o=i.parentNode}return null}function Nn(i){if(i=i[Ae]||i[Dn]){var n=i.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return i}return null}function qa(i){var n=i.tag;if(n===5||n===26||n===27||n===6)return i.stateNode;throw Error(s(33))}function Ln(i){var n=i[of];return n||(n=i[of]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function ve(i){i[Ga]=!0}var lf=new Set,cf={};function Js(i,n){Bn(i,n),Bn(i+"Capture",n)}function Bn(i,n){for(cf[i]=n,i=0;i<n.length;i++)lf.add(n[i])}var Hb=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),uf={},hf={};function $b(i){return mc.call(hf,i)?!0:mc.call(uf,i)?!1:Hb.test(i)?hf[i]=!0:(uf[i]=!0,!1)}function Ao(i,n,o){if($b(n))if(o===null)i.removeAttribute(n);else{switch(typeof o){case"undefined":case"function":case"symbol":i.removeAttribute(n);return;case"boolean":var h=n.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){i.removeAttribute(n);return}}i.setAttribute(n,""+o)}}function So(i,n,o){if(o===null)i.removeAttribute(n);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(n);return}i.setAttribute(n,""+o)}}function qi(i,n,o,h){if(h===null)i.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttributeNS(n,o,""+h)}}function di(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function df(i){var n=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Gb(i,n,o){var h=Object.getOwnPropertyDescriptor(i.constructor.prototype,n);if(!i.hasOwnProperty(n)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var g=h.get,m=h.set;return Object.defineProperty(i,n,{configurable:!0,get:function(){return g.call(this)},set:function(_){o=""+_,m.call(this,_)}}),Object.defineProperty(i,n,{enumerable:h.enumerable}),{getValue:function(){return o},setValue:function(_){o=""+_},stopTracking:function(){i._valueTracker=null,delete i[n]}}}}function Ec(i){if(!i._valueTracker){var n=df(i)?"checked":"value";i._valueTracker=Gb(i,n,""+i[n])}}function ff(i){if(!i)return!1;var n=i._valueTracker;if(!n)return!0;var o=n.getValue(),h="";return i&&(h=df(i)?i.checked?"true":"false":i.value),i=h,i!==o?(n.setValue(i),!0):!1}function Eo(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var qb=/[\n"\\]/g;function fi(i){return i.replace(qb,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Tc(i,n,o,h,g,m,_,T){i.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?i.type=_:i.removeAttribute("type"),n!=null?_==="number"?(n===0&&i.value===""||i.value!=n)&&(i.value=""+di(n)):i.value!==""+di(n)&&(i.value=""+di(n)):_!=="submit"&&_!=="reset"||i.removeAttribute("value"),n!=null?Cc(i,_,di(n)):o!=null?Cc(i,_,di(o)):h!=null&&i.removeAttribute("value"),g==null&&m!=null&&(i.defaultChecked=!!m),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?i.name=""+di(T):i.removeAttribute("name")}function gf(i,n,o,h,g,m,_,T){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(i.type=m),n!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||n!=null)){Ec(i);return}o=o!=null?""+di(o):"",n=n!=null?""+di(n):o,T||n===i.value||(i.value=n),i.defaultValue=n}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,i.checked=T?i.checked:!!h,i.defaultChecked=!!h,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(i.name=_),Ec(i)}function Cc(i,n,o){n==="number"&&Eo(i.ownerDocument)===i||i.defaultValue===""+o||(i.defaultValue=""+o)}function Pn(i,n,o,h){if(i=i.options,n){n={};for(var g=0;g<o.length;g++)n["$"+o[g]]=!0;for(o=0;o<i.length;o++)g=n.hasOwnProperty("$"+i[o].value),i[o].selected!==g&&(i[o].selected=g),g&&h&&(i[o].defaultSelected=!0)}else{for(o=""+di(o),n=null,g=0;g<i.length;g++){if(i[g].value===o){i[g].selected=!0,h&&(i[g].defaultSelected=!0);return}n!==null||i[g].disabled||(n=i[g])}n!==null&&(n.selected=!0)}}function pf(i,n,o){if(n!=null&&(n=""+di(n),n!==i.value&&(i.value=n),o==null)){i.defaultValue!==n&&(i.defaultValue=n);return}i.defaultValue=o!=null?""+di(o):""}function mf(i,n,o,h){if(n==null){if(h!=null){if(o!=null)throw Error(s(92));if(At(h)){if(1<h.length)throw Error(s(93));h=h[0]}o=h}o==null&&(o=""),n=o}o=di(n),i.defaultValue=o,h=i.textContent,h===o&&h!==""&&h!==null&&(i.value=h),Ec(i)}function In(i,n){if(n){var o=i.firstChild;if(o&&o===i.lastChild&&o.nodeType===3){o.nodeValue=n;return}}i.textContent=n}var Vb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function yf(i,n,o){var h=n.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?h?i.setProperty(n,""):n==="float"?i.cssFloat="":i[n]="":h?i.setProperty(n,o):typeof o!="number"||o===0||Vb.has(n)?n==="float"?i.cssFloat=o:i[n]=(""+o).trim():i[n]=o+"px"}function vf(i,n,o){if(n!=null&&typeof n!="object")throw Error(s(62));if(i=i.style,o!=null){for(var h in o)!o.hasOwnProperty(h)||n!=null&&n.hasOwnProperty(h)||(h.indexOf("--")===0?i.setProperty(h,""):h==="float"?i.cssFloat="":i[h]="");for(var g in n)h=n[g],n.hasOwnProperty(g)&&o[g]!==h&&yf(i,g,h)}else for(var m in n)n.hasOwnProperty(m)&&yf(i,m,n[m])}function xc(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function To(i){return Xb.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Vi(){}var Rc=null;function Oc(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Un=null,jn=null;function bf(i){var n=Nn(i);if(n&&(i=n.stateNode)){var o=i[Fe]||null;t:switch(i=n.stateNode,n.type){case"input":if(Tc(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),n=o.name,o.type==="radio"&&n!=null){for(o=i;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+fi(""+n)+'"][type="radio"]'),n=0;n<o.length;n++){var h=o[n];if(h!==i&&h.form===i.form){var g=h[Fe]||null;if(!g)throw Error(s(90));Tc(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(n=0;n<o.length;n++)h=o[n],h.form===i.form&&ff(h)}break t;case"textarea":pf(i,o.value,o.defaultValue);break t;case"select":n=o.value,n!=null&&Pn(i,!!o.multiple,n,!1)}}}var kc=!1;function _f(i,n,o){if(kc)return i(n,o);kc=!0;try{var h=i(n);return h}finally{if(kc=!1,(Un!==null||jn!==null)&&(dl(),Un&&(n=Un,i=jn,jn=Un=null,bf(n),i)))for(n=0;n<i.length;n++)bf(i[n])}}function Va(i,n){var o=i.stateNode;if(o===null)return null;var h=o[Fe]||null;if(h===null)return null;o=h[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break t;default:i=!1}if(i)return null;if(o&&typeof o!="function")throw Error(s(231,n,typeof o));return o}var Yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dc=!1;if(Yi)try{var Ya={};Object.defineProperty(Ya,"passive",{get:function(){Dc=!0}}),window.addEventListener("test",Ya,Ya),window.removeEventListener("test",Ya,Ya)}catch{Dc=!1}var ys=null,Mc=null,Co=null;function wf(){if(Co)return Co;var i,n=Mc,o=n.length,h,g="value"in ys?ys.value:ys.textContent,m=g.length;for(i=0;i<o&&n[i]===g[i];i++);var _=o-i;for(h=1;h<=_&&n[o-h]===g[m-h];h++);return Co=g.slice(i,1<h?1-h:void 0)}function xo(i){var n=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&n===13&&(i=13)):i=n,i===10&&(i=13),32<=i||i===13?i:0}function Ro(){return!0}function Af(){return!1}function He(i){function n(o,h,g,m,_){this._reactName=o,this._targetInst=g,this.type=h,this.nativeEvent=m,this.target=_,this.currentTarget=null;for(var T in i)i.hasOwnProperty(T)&&(o=i[T],this[T]=o?o(m):m[T]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Ro:Af,this.isPropagationStopped=Af,this}return y(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ro)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ro)},persist:function(){},isPersistent:Ro}),n}var Zs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Oo=He(Zs),Xa=y({},Zs,{view:0,detail:0}),Kb=He(Xa),Nc,Lc,Ka,ko=y({},Xa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pc,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ka&&(Ka&&i.type==="mousemove"?(Nc=i.screenX-Ka.screenX,Lc=i.screenY-Ka.screenY):Lc=Nc=0,Ka=i),Nc)},movementY:function(i){return"movementY"in i?i.movementY:Lc}}),Sf=He(ko),Wb=y({},ko,{dataTransfer:0}),Qb=He(Wb),Jb=y({},Xa,{relatedTarget:0}),Bc=He(Jb),Zb=y({},Zs,{animationName:0,elapsedTime:0,pseudoElement:0}),t0=He(Zb),e0=y({},Zs,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),i0=He(e0),s0=y({},Zs,{data:0}),Ef=He(s0),n0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},a0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},r0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function o0(i){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(i):(i=r0[i])?!!n[i]:!1}function Pc(){return o0}var l0=y({},Xa,{key:function(i){if(i.key){var n=n0[i.key]||i.key;if(n!=="Unidentified")return n}return i.type==="keypress"?(i=xo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?a0[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pc,charCode:function(i){return i.type==="keypress"?xo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?xo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),c0=He(l0),u0=y({},ko,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tf=He(u0),h0=y({},Xa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pc}),d0=He(h0),f0=y({},Zs,{propertyName:0,elapsedTime:0,pseudoElement:0}),g0=He(f0),p0=y({},ko,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),m0=He(p0),y0=y({},Zs,{newState:0,oldState:0}),v0=He(y0),b0=[9,13,27,32],Ic=Yi&&"CompositionEvent"in window,Wa=null;Yi&&"documentMode"in document&&(Wa=document.documentMode);var _0=Yi&&"TextEvent"in window&&!Wa,Cf=Yi&&(!Ic||Wa&&8<Wa&&11>=Wa),xf=" ",Rf=!1;function Of(i,n){switch(i){case"keyup":return b0.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kf(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var zn=!1;function w0(i,n){switch(i){case"compositionend":return kf(n);case"keypress":return n.which!==32?null:(Rf=!0,xf);case"textInput":return i=n.data,i===xf&&Rf?null:i;default:return null}}function A0(i,n){if(zn)return i==="compositionend"||!Ic&&Of(i,n)?(i=wf(),Co=Mc=ys=null,zn=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Cf&&n.locale!=="ko"?null:n.data;default:return null}}var S0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Df(i){var n=i&&i.nodeName&&i.nodeName.toLowerCase();return n==="input"?!!S0[i.type]:n==="textarea"}function Mf(i,n,o,h){Un?jn?jn.push(h):jn=[h]:Un=h,n=bl(n,"onChange"),0<n.length&&(o=new Oo("onChange","change",null,o,h),i.push({event:o,listeners:n}))}var Qa=null,Ja=null;function E0(i){gm(i,0)}function Do(i){var n=qa(i);if(ff(n))return i}function Nf(i,n){if(i==="change")return n}var Lf=!1;if(Yi){var Uc;if(Yi){var jc="oninput"in document;if(!jc){var Bf=document.createElement("div");Bf.setAttribute("oninput","return;"),jc=typeof Bf.oninput=="function"}Uc=jc}else Uc=!1;Lf=Uc&&(!document.documentMode||9<document.documentMode)}function Pf(){Qa&&(Qa.detachEvent("onpropertychange",If),Ja=Qa=null)}function If(i){if(i.propertyName==="value"&&Do(Ja)){var n=[];Mf(n,Ja,i,Oc(i)),_f(E0,n)}}function T0(i,n,o){i==="focusin"?(Pf(),Qa=n,Ja=o,Qa.attachEvent("onpropertychange",If)):i==="focusout"&&Pf()}function C0(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Do(Ja)}function x0(i,n){if(i==="click")return Do(n)}function R0(i,n){if(i==="input"||i==="change")return Do(n)}function O0(i,n){return i===n&&(i!==0||1/i===1/n)||i!==i&&n!==n}var ti=typeof Object.is=="function"?Object.is:O0;function Za(i,n){if(ti(i,n))return!0;if(typeof i!="object"||i===null||typeof n!="object"||n===null)return!1;var o=Object.keys(i),h=Object.keys(n);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var g=o[h];if(!mc.call(n,g)||!ti(i[g],n[g]))return!1}return!0}function Uf(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function jf(i,n){var o=Uf(i);i=0;for(var h;o;){if(o.nodeType===3){if(h=i+o.textContent.length,i<=n&&h>=n)return{node:o,offset:n-i};i=h}t:{for(;o;){if(o.nextSibling){o=o.nextSibling;break t}o=o.parentNode}o=void 0}o=Uf(o)}}function zf(i,n){return i&&n?i===n?!0:i&&i.nodeType===3?!1:n&&n.nodeType===3?zf(i,n.parentNode):"contains"in i?i.contains(n):i.compareDocumentPosition?!!(i.compareDocumentPosition(n)&16):!1:!1}function Ff(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var n=Eo(i.document);n instanceof i.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)i=n.contentWindow;else break;n=Eo(i.document)}return n}function zc(i){var n=i&&i.nodeName&&i.nodeName.toLowerCase();return n&&(n==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||n==="textarea"||i.contentEditable==="true")}var k0=Yi&&"documentMode"in document&&11>=document.documentMode,Fn=null,Fc=null,tr=null,Hc=!1;function Hf(i,n,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Hc||Fn==null||Fn!==Eo(h)||(h=Fn,"selectionStart"in h&&zc(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),tr&&Za(tr,h)||(tr=h,h=bl(Fc,"onSelect"),0<h.length&&(n=new Oo("onSelect","select",null,n,o),i.push({event:n,listeners:h}),n.target=Fn)))}function tn(i,n){var o={};return o[i.toLowerCase()]=n.toLowerCase(),o["Webkit"+i]="webkit"+n,o["Moz"+i]="moz"+n,o}var Hn={animationend:tn("Animation","AnimationEnd"),animationiteration:tn("Animation","AnimationIteration"),animationstart:tn("Animation","AnimationStart"),transitionrun:tn("Transition","TransitionRun"),transitionstart:tn("Transition","TransitionStart"),transitioncancel:tn("Transition","TransitionCancel"),transitionend:tn("Transition","TransitionEnd")},$c={},$f={};Yi&&($f=document.createElement("div").style,"AnimationEvent"in window||(delete Hn.animationend.animation,delete Hn.animationiteration.animation,delete Hn.animationstart.animation),"TransitionEvent"in window||delete Hn.transitionend.transition);function en(i){if($c[i])return $c[i];if(!Hn[i])return i;var n=Hn[i],o;for(o in n)if(n.hasOwnProperty(o)&&o in $f)return $c[i]=n[o];return i}var Gf=en("animationend"),qf=en("animationiteration"),Vf=en("animationstart"),D0=en("transitionrun"),M0=en("transitionstart"),N0=en("transitioncancel"),Yf=en("transitionend"),Xf=new Map,Gc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Gc.push("scrollEnd");function Ci(i,n){Xf.set(i,n),Js(n,[i])}var Mo=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},gi=[],$n=0,qc=0;function No(){for(var i=$n,n=qc=$n=0;n<i;){var o=gi[n];gi[n++]=null;var h=gi[n];gi[n++]=null;var g=gi[n];gi[n++]=null;var m=gi[n];if(gi[n++]=null,h!==null&&g!==null){var _=h.pending;_===null?g.next=g:(g.next=_.next,_.next=g),h.pending=g}m!==0&&Kf(o,g,m)}}function Lo(i,n,o,h){gi[$n++]=i,gi[$n++]=n,gi[$n++]=o,gi[$n++]=h,qc|=h,i.lanes|=h,i=i.alternate,i!==null&&(i.lanes|=h)}function Vc(i,n,o,h){return Lo(i,n,o,h),Bo(i)}function sn(i,n){return Lo(i,null,null,n),Bo(i)}function Kf(i,n,o){i.lanes|=o;var h=i.alternate;h!==null&&(h.lanes|=o);for(var g=!1,m=i.return;m!==null;)m.childLanes|=o,h=m.alternate,h!==null&&(h.childLanes|=o),m.tag===22&&(i=m.stateNode,i===null||i._visibility&1||(g=!0)),i=m,m=m.return;return i.tag===3?(m=i.stateNode,g&&n!==null&&(g=31-Ze(o),i=m.hiddenUpdates,h=i[g],h===null?i[g]=[n]:h.push(n),n.lane=o|536870912),m):null}function Bo(i){if(50<Ar)throw Ar=0,eh=null,Error(s(185));for(var n=i.return;n!==null;)i=n,n=i.return;return i.tag===3?i.stateNode:null}var Gn={};function L0(i,n,o,h){this.tag=i,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(i,n,o,h){return new L0(i,n,o,h)}function Yc(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Xi(i,n){var o=i.alternate;return o===null?(o=ei(i.tag,n,i.key,i.mode),o.elementType=i.elementType,o.type=i.type,o.stateNode=i.stateNode,o.alternate=i,i.alternate=o):(o.pendingProps=n,o.type=i.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=i.flags&65011712,o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,n=i.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=i.sibling,o.index=i.index,o.ref=i.ref,o.refCleanup=i.refCleanup,o}function Wf(i,n){i.flags&=65011714;var o=i.alternate;return o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),i}function Po(i,n,o,h,g,m){var _=0;if(h=i,typeof i=="function")Yc(i)&&(_=1);else if(typeof i=="string")_=j_(i,o,J.current)?26:i==="html"||i==="head"||i==="body"?27:5;else t:switch(i){case Y:return i=ei(31,o,n,g),i.elementType=Y,i.lanes=m,i;case w:return nn(o.children,g,m,n);case E:_=8,g|=24;break;case S:return i=ei(12,o,n,g|2),i.elementType=S,i.lanes=m,i;case L:return i=ei(13,o,n,g),i.elementType=L,i.lanes=m,i;case R:return i=ei(19,o,n,g),i.elementType=R,i.lanes=m,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case C:_=10;break t;case x:_=9;break t;case k:_=11;break t;case D:_=14;break t;case z:_=16,h=null;break t}_=29,o=Error(s(130,i===null?"null":typeof i,"")),h=null}return n=ei(_,o,n,g),n.elementType=i,n.type=h,n.lanes=m,n}function nn(i,n,o,h){return i=ei(7,i,h,n),i.lanes=o,i}function Xc(i,n,o){return i=ei(6,i,null,n),i.lanes=o,i}function Qf(i){var n=ei(18,null,null,0);return n.stateNode=i,n}function Kc(i,n,o){return n=ei(4,i.children!==null?i.children:[],i.key,n),n.lanes=o,n.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},n}var Jf=new WeakMap;function pi(i,n){if(typeof i=="object"&&i!==null){var o=Jf.get(i);return o!==void 0?o:(n={value:i,source:n,stack:Wd(n)},Jf.set(i,n),n)}return{value:i,source:n,stack:Wd(n)}}var qn=[],Vn=0,Io=null,er=0,mi=[],yi=0,vs=null,Ni=1,Li="";function Ki(i,n){qn[Vn++]=er,qn[Vn++]=Io,Io=i,er=n}function Zf(i,n,o){mi[yi++]=Ni,mi[yi++]=Li,mi[yi++]=vs,vs=i;var h=Ni;i=Li;var g=32-Ze(h)-1;h&=~(1<<g),o+=1;var m=32-Ze(n)+g;if(30<m){var _=g-g%5;m=(h&(1<<_)-1).toString(32),h>>=_,g-=_,Ni=1<<32-Ze(n)+g|o<<g|h,Li=m+i}else Ni=1<<m|o<<g|h,Li=i}function Wc(i){i.return!==null&&(Ki(i,1),Zf(i,1,0))}function Qc(i){for(;i===Io;)Io=qn[--Vn],qn[Vn]=null,er=qn[--Vn],qn[Vn]=null;for(;i===vs;)vs=mi[--yi],mi[yi]=null,Li=mi[--yi],mi[yi]=null,Ni=mi[--yi],mi[yi]=null}function tg(i,n){mi[yi++]=Ni,mi[yi++]=Li,mi[yi++]=vs,Ni=n.id,Li=n.overflow,vs=i}var Se=null,Yt=null,Ot=!1,bs=null,vi=!1,Jc=Error(s(519));function _s(i){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ir(pi(n,i)),Jc}function eg(i){var n=i.stateNode,o=i.type,h=i.memoizedProps;switch(n[Ae]=i,n[Fe]=h,o){case"dialog":Ct("cancel",n),Ct("close",n);break;case"iframe":case"object":case"embed":Ct("load",n);break;case"video":case"audio":for(o=0;o<Er.length;o++)Ct(Er[o],n);break;case"source":Ct("error",n);break;case"img":case"image":case"link":Ct("error",n),Ct("load",n);break;case"details":Ct("toggle",n);break;case"input":Ct("invalid",n),gf(n,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Ct("invalid",n);break;case"textarea":Ct("invalid",n),mf(n,h.value,h.defaultValue,h.children)}o=h.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||n.textContent===""+o||h.suppressHydrationWarning===!0||vm(n.textContent,o)?(h.popover!=null&&(Ct("beforetoggle",n),Ct("toggle",n)),h.onScroll!=null&&Ct("scroll",n),h.onScrollEnd!=null&&Ct("scrollend",n),h.onClick!=null&&(n.onclick=Vi),n=!0):n=!1,n||_s(i,!0)}function ig(i){for(Se=i.return;Se;)switch(Se.tag){case 5:case 31:case 13:vi=!1;return;case 27:case 3:vi=!0;return;default:Se=Se.return}}function Yn(i){if(i!==Se)return!1;if(!Ot)return ig(i),Ot=!0,!1;var n=i.tag,o;if((o=n!==3&&n!==27)&&((o=n===5)&&(o=i.type,o=!(o!=="form"&&o!=="button")||mh(i.type,i.memoizedProps)),o=!o),o&&Yt&&_s(i),ig(i),n===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));Yt=xm(i)}else if(n===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));Yt=xm(i)}else n===27?(n=Yt,Ls(i.type)?(i=wh,wh=null,Yt=i):Yt=n):Yt=Se?_i(i.stateNode.nextSibling):null;return!0}function an(){Yt=Se=null,Ot=!1}function Zc(){var i=bs;return i!==null&&(Ve===null?Ve=i:Ve.push.apply(Ve,i),bs=null),i}function ir(i){bs===null?bs=[i]:bs.push(i)}var tu=M(null),rn=null,Wi=null;function ws(i,n,o){X(tu,n._currentValue),n._currentValue=o}function Qi(i){i._currentValue=tu.current,H(tu)}function eu(i,n,o){for(;i!==null;){var h=i.alternate;if((i.childLanes&n)!==n?(i.childLanes|=n,h!==null&&(h.childLanes|=n)):h!==null&&(h.childLanes&n)!==n&&(h.childLanes|=n),i===o)break;i=i.return}}function iu(i,n,o,h){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var m=g.dependencies;if(m!==null){var _=g.child;m=m.firstContext;t:for(;m!==null;){var T=m;m=g;for(var O=0;O<n.length;O++)if(T.context===n[O]){m.lanes|=o,T=m.alternate,T!==null&&(T.lanes|=o),eu(m.return,o,i),h||(_=null);break t}m=T.next}}else if(g.tag===18){if(_=g.return,_===null)throw Error(s(341));_.lanes|=o,m=_.alternate,m!==null&&(m.lanes|=o),eu(_,o,i),_=null}else _=g.child;if(_!==null)_.return=g;else for(_=g;_!==null;){if(_===i){_=null;break}if(g=_.sibling,g!==null){g.return=_.return,_=g;break}_=_.return}g=_}}function Xn(i,n,o,h){i=null;for(var g=n,m=!1;g!==null;){if(!m){if((g.flags&524288)!==0)m=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var _=g.alternate;if(_===null)throw Error(s(387));if(_=_.memoizedProps,_!==null){var T=g.type;ti(g.pendingProps.value,_.value)||(i!==null?i.push(T):i=[T])}}else if(g===lt.current){if(_=g.alternate,_===null)throw Error(s(387));_.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(Or):i=[Or])}g=g.return}i!==null&&iu(n,i,o,h),n.flags|=262144}function Uo(i){for(i=i.firstContext;i!==null;){if(!ti(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function on(i){rn=i,Wi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Ee(i){return sg(rn,i)}function jo(i,n){return rn===null&&on(i),sg(i,n)}function sg(i,n){var o=n._currentValue;if(n={context:n,memoizedValue:o,next:null},Wi===null){if(i===null)throw Error(s(308));Wi=n,i.dependencies={lanes:0,firstContext:n},i.flags|=524288}else Wi=Wi.next=n;return o}var B0=typeof AbortController<"u"?AbortController:function(){var i=[],n=this.signal={aborted:!1,addEventListener:function(o,h){i.push(h)}};this.abort=function(){n.aborted=!0,i.forEach(function(o){return o()})}},P0=l.unstable_scheduleCallback,I0=l.unstable_NormalPriority,ce={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function su(){return{controller:new B0,data:new Map,refCount:0}}function sr(i){i.refCount--,i.refCount===0&&P0(I0,function(){i.controller.abort()})}var nr=null,nu=0,Kn=0,Wn=null;function U0(i,n){if(nr===null){var o=nr=[];nu=0,Kn=oh(),Wn={status:"pending",value:void 0,then:function(h){o.push(h)}}}return nu++,n.then(ng,ng),n}function ng(){if(--nu===0&&nr!==null){Wn!==null&&(Wn.status="fulfilled");var i=nr;nr=null,Kn=0,Wn=null;for(var n=0;n<i.length;n++)(0,i[n])()}}function j0(i,n){var o=[],h={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return i.then(function(){h.status="fulfilled",h.value=n;for(var g=0;g<o.length;g++)(0,o[g])(n)},function(g){for(h.status="rejected",h.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),h}var ag=P.S;P.S=function(i,n){Hp=Qe(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&U0(i,n),ag!==null&&ag(i,n)};var ln=M(null);function au(){var i=ln.current;return i!==null?i:Gt.pooledCache}function zo(i,n){n===null?X(ln,ln.current):X(ln,n.pool)}function rg(){var i=au();return i===null?null:{parent:ce._currentValue,pool:i}}var Qn=Error(s(460)),ru=Error(s(474)),Fo=Error(s(542)),Ho={then:function(){}};function og(i){return i=i.status,i==="fulfilled"||i==="rejected"}function lg(i,n,o){switch(o=i[o],o===void 0?i.push(n):o!==n&&(n.then(Vi,Vi),n=o),n.status){case"fulfilled":return n.value;case"rejected":throw i=n.reason,ug(i),i;default:if(typeof n.status=="string")n.then(Vi,Vi);else{if(i=Gt,i!==null&&100<i.shellSuspendCounter)throw Error(s(482));i=n,i.status="pending",i.then(function(h){if(n.status==="pending"){var g=n;g.status="fulfilled",g.value=h}},function(h){if(n.status==="pending"){var g=n;g.status="rejected",g.reason=h}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw i=n.reason,ug(i),i}throw un=n,Qn}}function cn(i){try{var n=i._init;return n(i._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(un=o,Qn):o}}var un=null;function cg(){if(un===null)throw Error(s(459));var i=un;return un=null,i}function ug(i){if(i===Qn||i===Fo)throw Error(s(483))}var Jn=null,ar=0;function $o(i){var n=ar;return ar+=1,Jn===null&&(Jn=[]),lg(Jn,i,n)}function rr(i,n){n=n.props.ref,i.ref=n!==void 0?n:null}function Go(i,n){throw n.$$typeof===v?Error(s(525)):(i=Object.prototype.toString.call(n),Error(s(31,i==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":i)))}function hg(i){function n(B,N){if(i){var I=B.deletions;I===null?(B.deletions=[N],B.flags|=16):I.push(N)}}function o(B,N){if(!i)return null;for(;N!==null;)n(B,N),N=N.sibling;return null}function h(B){for(var N=new Map;B!==null;)B.key!==null?N.set(B.key,B):N.set(B.index,B),B=B.sibling;return N}function g(B,N){return B=Xi(B,N),B.index=0,B.sibling=null,B}function m(B,N,I){return B.index=I,i?(I=B.alternate,I!==null?(I=I.index,I<N?(B.flags|=67108866,N):I):(B.flags|=67108866,N)):(B.flags|=1048576,N)}function _(B){return i&&B.alternate===null&&(B.flags|=67108866),B}function T(B,N,I,q){return N===null||N.tag!==6?(N=Xc(I,B.mode,q),N.return=B,N):(N=g(N,I),N.return=B,N)}function O(B,N,I,q){var at=I.type;return at===w?$(B,N,I.props.children,q,I.key):N!==null&&(N.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===z&&cn(at)===N.type)?(N=g(N,I.props),rr(N,I),N.return=B,N):(N=Po(I.type,I.key,I.props,null,B.mode,q),rr(N,I),N.return=B,N)}function U(B,N,I,q){return N===null||N.tag!==4||N.stateNode.containerInfo!==I.containerInfo||N.stateNode.implementation!==I.implementation?(N=Kc(I,B.mode,q),N.return=B,N):(N=g(N,I.children||[]),N.return=B,N)}function $(B,N,I,q,at){return N===null||N.tag!==7?(N=nn(I,B.mode,q,at),N.return=B,N):(N=g(N,I),N.return=B,N)}function V(B,N,I){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return N=Xc(""+N,B.mode,I),N.return=B,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case b:return I=Po(N.type,N.key,N.props,null,B.mode,I),rr(I,N),I.return=B,I;case A:return N=Kc(N,B.mode,I),N.return=B,N;case z:return N=cn(N),V(B,N,I)}if(At(N)||dt(N))return N=nn(N,B.mode,I,null),N.return=B,N;if(typeof N.then=="function")return V(B,$o(N),I);if(N.$$typeof===C)return V(B,jo(B,N),I);Go(B,N)}return null}function j(B,N,I,q){var at=N!==null?N.key:null;if(typeof I=="string"&&I!==""||typeof I=="number"||typeof I=="bigint")return at!==null?null:T(B,N,""+I,q);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case b:return I.key===at?O(B,N,I,q):null;case A:return I.key===at?U(B,N,I,q):null;case z:return I=cn(I),j(B,N,I,q)}if(At(I)||dt(I))return at!==null?null:$(B,N,I,q,null);if(typeof I.then=="function")return j(B,N,$o(I),q);if(I.$$typeof===C)return j(B,N,jo(B,I),q);Go(B,I)}return null}function F(B,N,I,q,at){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return B=B.get(I)||null,T(N,B,""+q,at);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case b:return B=B.get(q.key===null?I:q.key)||null,O(N,B,q,at);case A:return B=B.get(q.key===null?I:q.key)||null,U(N,B,q,at);case z:return q=cn(q),F(B,N,I,q,at)}if(At(q)||dt(q))return B=B.get(I)||null,$(N,B,q,at,null);if(typeof q.then=="function")return F(B,N,I,$o(q),at);if(q.$$typeof===C)return F(B,N,I,jo(N,q),at);Go(N,q)}return null}function tt(B,N,I,q){for(var at=null,Mt=null,it=N,wt=N=0,Rt=null;it!==null&&wt<I.length;wt++){it.index>wt?(Rt=it,it=null):Rt=it.sibling;var Nt=j(B,it,I[wt],q);if(Nt===null){it===null&&(it=Rt);break}i&&it&&Nt.alternate===null&&n(B,it),N=m(Nt,N,wt),Mt===null?at=Nt:Mt.sibling=Nt,Mt=Nt,it=Rt}if(wt===I.length)return o(B,it),Ot&&Ki(B,wt),at;if(it===null){for(;wt<I.length;wt++)it=V(B,I[wt],q),it!==null&&(N=m(it,N,wt),Mt===null?at=it:Mt.sibling=it,Mt=it);return Ot&&Ki(B,wt),at}for(it=h(it);wt<I.length;wt++)Rt=F(it,B,wt,I[wt],q),Rt!==null&&(i&&Rt.alternate!==null&&it.delete(Rt.key===null?wt:Rt.key),N=m(Rt,N,wt),Mt===null?at=Rt:Mt.sibling=Rt,Mt=Rt);return i&&it.forEach(function(js){return n(B,js)}),Ot&&Ki(B,wt),at}function ct(B,N,I,q){if(I==null)throw Error(s(151));for(var at=null,Mt=null,it=N,wt=N=0,Rt=null,Nt=I.next();it!==null&&!Nt.done;wt++,Nt=I.next()){it.index>wt?(Rt=it,it=null):Rt=it.sibling;var js=j(B,it,Nt.value,q);if(js===null){it===null&&(it=Rt);break}i&&it&&js.alternate===null&&n(B,it),N=m(js,N,wt),Mt===null?at=js:Mt.sibling=js,Mt=js,it=Rt}if(Nt.done)return o(B,it),Ot&&Ki(B,wt),at;if(it===null){for(;!Nt.done;wt++,Nt=I.next())Nt=V(B,Nt.value,q),Nt!==null&&(N=m(Nt,N,wt),Mt===null?at=Nt:Mt.sibling=Nt,Mt=Nt);return Ot&&Ki(B,wt),at}for(it=h(it);!Nt.done;wt++,Nt=I.next())Nt=F(it,B,wt,Nt.value,q),Nt!==null&&(i&&Nt.alternate!==null&&it.delete(Nt.key===null?wt:Nt.key),N=m(Nt,N,wt),Mt===null?at=Nt:Mt.sibling=Nt,Mt=Nt);return i&&it.forEach(function(W_){return n(B,W_)}),Ot&&Ki(B,wt),at}function Ft(B,N,I,q){if(typeof I=="object"&&I!==null&&I.type===w&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case b:t:{for(var at=I.key;N!==null;){if(N.key===at){if(at=I.type,at===w){if(N.tag===7){o(B,N.sibling),q=g(N,I.props.children),q.return=B,B=q;break t}}else if(N.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===z&&cn(at)===N.type){o(B,N.sibling),q=g(N,I.props),rr(q,I),q.return=B,B=q;break t}o(B,N);break}else n(B,N);N=N.sibling}I.type===w?(q=nn(I.props.children,B.mode,q,I.key),q.return=B,B=q):(q=Po(I.type,I.key,I.props,null,B.mode,q),rr(q,I),q.return=B,B=q)}return _(B);case A:t:{for(at=I.key;N!==null;){if(N.key===at)if(N.tag===4&&N.stateNode.containerInfo===I.containerInfo&&N.stateNode.implementation===I.implementation){o(B,N.sibling),q=g(N,I.children||[]),q.return=B,B=q;break t}else{o(B,N);break}else n(B,N);N=N.sibling}q=Kc(I,B.mode,q),q.return=B,B=q}return _(B);case z:return I=cn(I),Ft(B,N,I,q)}if(At(I))return tt(B,N,I,q);if(dt(I)){if(at=dt(I),typeof at!="function")throw Error(s(150));return I=at.call(I),ct(B,N,I,q)}if(typeof I.then=="function")return Ft(B,N,$o(I),q);if(I.$$typeof===C)return Ft(B,N,jo(B,I),q);Go(B,I)}return typeof I=="string"&&I!==""||typeof I=="number"||typeof I=="bigint"?(I=""+I,N!==null&&N.tag===6?(o(B,N.sibling),q=g(N,I),q.return=B,B=q):(o(B,N),q=Xc(I,B.mode,q),q.return=B,B=q),_(B)):o(B,N)}return function(B,N,I,q){try{ar=0;var at=Ft(B,N,I,q);return Jn=null,at}catch(it){if(it===Qn||it===Fo)throw it;var Mt=ei(29,it,null,B.mode);return Mt.lanes=q,Mt.return=B,Mt}}}var hn=hg(!0),dg=hg(!1),As=!1;function ou(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lu(i,n){i=i.updateQueue,n.updateQueue===i&&(n.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Ss(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Es(i,n,o){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Lt&2)!==0){var g=h.pending;return g===null?n.next=n:(n.next=g.next,g.next=n),h.pending=n,n=Bo(i),Kf(i,null,o),n}return Lo(i,h,n,o),Bo(i)}function or(i,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194048)!==0)){var h=n.lanes;h&=i.pendingLanes,o|=h,n.lanes=o,sf(i,o)}}function cu(i,n){var o=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var g=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var _={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?g=m=_:m=m.next=_,o=o.next}while(o!==null);m===null?g=m=n:m=m.next=n}else g=m=n;o={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:m,shared:h.shared,callbacks:h.callbacks},i.updateQueue=o;return}i=o.lastBaseUpdate,i===null?o.firstBaseUpdate=n:i.next=n,o.lastBaseUpdate=n}var uu=!1;function lr(){if(uu){var i=Wn;if(i!==null)throw i}}function cr(i,n,o,h){uu=!1;var g=i.updateQueue;As=!1;var m=g.firstBaseUpdate,_=g.lastBaseUpdate,T=g.shared.pending;if(T!==null){g.shared.pending=null;var O=T,U=O.next;O.next=null,_===null?m=U:_.next=U,_=O;var $=i.alternate;$!==null&&($=$.updateQueue,T=$.lastBaseUpdate,T!==_&&(T===null?$.firstBaseUpdate=U:T.next=U,$.lastBaseUpdate=O))}if(m!==null){var V=g.baseState;_=0,$=U=O=null,T=m;do{var j=T.lane&-536870913,F=j!==T.lane;if(F?(xt&j)===j:(h&j)===j){j!==0&&j===Kn&&(uu=!0),$!==null&&($=$.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});t:{var tt=i,ct=T;j=n;var Ft=o;switch(ct.tag){case 1:if(tt=ct.payload,typeof tt=="function"){V=tt.call(Ft,V,j);break t}V=tt;break t;case 3:tt.flags=tt.flags&-65537|128;case 0:if(tt=ct.payload,j=typeof tt=="function"?tt.call(Ft,V,j):tt,j==null)break t;V=y({},V,j);break t;case 2:As=!0}}j=T.callback,j!==null&&(i.flags|=64,F&&(i.flags|=8192),F=g.callbacks,F===null?g.callbacks=[j]:F.push(j))}else F={lane:j,tag:T.tag,payload:T.payload,callback:T.callback,next:null},$===null?(U=$=F,O=V):$=$.next=F,_|=j;if(T=T.next,T===null){if(T=g.shared.pending,T===null)break;F=T,T=F.next,F.next=null,g.lastBaseUpdate=F,g.shared.pending=null}}while(!0);$===null&&(O=V),g.baseState=O,g.firstBaseUpdate=U,g.lastBaseUpdate=$,m===null&&(g.shared.lanes=0),Os|=_,i.lanes=_,i.memoizedState=V}}function fg(i,n){if(typeof i!="function")throw Error(s(191,i));i.call(n)}function gg(i,n){var o=i.callbacks;if(o!==null)for(i.callbacks=null,i=0;i<o.length;i++)fg(o[i],n)}var Zn=M(null),qo=M(0);function pg(i,n){i=rs,X(qo,i),X(Zn,n),rs=i|n.baseLanes}function hu(){X(qo,rs),X(Zn,Zn.current)}function du(){rs=qo.current,H(Zn),H(qo)}var ii=M(null),bi=null;function Ts(i){var n=i.alternate;X(re,re.current&1),X(ii,i),bi===null&&(n===null||Zn.current!==null||n.memoizedState!==null)&&(bi=i)}function fu(i){X(re,re.current),X(ii,i),bi===null&&(bi=i)}function mg(i){i.tag===22?(X(re,re.current),X(ii,i),bi===null&&(bi=i)):Cs()}function Cs(){X(re,re.current),X(ii,ii.current)}function si(i){H(ii),bi===i&&(bi=null),H(re)}var re=M(0);function Vo(i){for(var n=i;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||bh(o)||_h(o)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break;for(;n.sibling===null;){if(n.return===null||n.return===i)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Ji=0,_t=null,jt=null,ue=null,Yo=!1,ta=!1,dn=!1,Xo=0,ur=0,ea=null,z0=0;function ee(){throw Error(s(321))}function gu(i,n){if(n===null)return!1;for(var o=0;o<n.length&&o<i.length;o++)if(!ti(i[o],n[o]))return!1;return!0}function pu(i,n,o,h,g,m){return Ji=m,_t=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,P.H=i===null||i.memoizedState===null?Zg:ku,dn=!1,m=o(h,g),dn=!1,ta&&(m=vg(n,o,h,g)),yg(i),m}function yg(i){P.H=fr;var n=jt!==null&&jt.next!==null;if(Ji=0,ue=jt=_t=null,Yo=!1,ur=0,ea=null,n)throw Error(s(300));i===null||he||(i=i.dependencies,i!==null&&Uo(i)&&(he=!0))}function vg(i,n,o,h){_t=i;var g=0;do{if(ta&&(ea=null),ur=0,ta=!1,25<=g)throw Error(s(301));if(g+=1,ue=jt=null,i.updateQueue!=null){var m=i.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}P.H=tp,m=n(o,h)}while(ta);return m}function F0(){var i=P.H,n=i.useState()[0];return n=typeof n.then=="function"?hr(n):n,i=i.useState()[0],(jt!==null?jt.memoizedState:null)!==i&&(_t.flags|=1024),n}function mu(){var i=Xo!==0;return Xo=0,i}function yu(i,n,o){n.updateQueue=i.updateQueue,n.flags&=-2053,i.lanes&=~o}function vu(i){if(Yo){for(i=i.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}Yo=!1}Ji=0,ue=jt=_t=null,ta=!1,ur=Xo=0,ea=null}function Be(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ue===null?_t.memoizedState=ue=i:ue=ue.next=i,ue}function oe(){if(jt===null){var i=_t.alternate;i=i!==null?i.memoizedState:null}else i=jt.next;var n=ue===null?_t.memoizedState:ue.next;if(n!==null)ue=n,jt=i;else{if(i===null)throw _t.alternate===null?Error(s(467)):Error(s(310));jt=i,i={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},ue===null?_t.memoizedState=ue=i:ue=ue.next=i}return ue}function Ko(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function hr(i){var n=ur;return ur+=1,ea===null&&(ea=[]),i=lg(ea,i,n),n=_t,(ue===null?n.memoizedState:ue.next)===null&&(n=n.alternate,P.H=n===null||n.memoizedState===null?Zg:ku),i}function Wo(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return hr(i);if(i.$$typeof===C)return Ee(i)}throw Error(s(438,String(i)))}function bu(i){var n=null,o=_t.updateQueue;if(o!==null&&(n=o.memoCache),n==null){var h=_t.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(n={data:h.data.map(function(g){return g.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),o===null&&(o=Ko(),_t.updateQueue=o),o.memoCache=n,o=n.data[n.index],o===void 0)for(o=n.data[n.index]=Array(i),h=0;h<i;h++)o[h]=Q;return n.index++,o}function Zi(i,n){return typeof n=="function"?n(i):n}function Qo(i){var n=oe();return _u(n,jt,i)}function _u(i,n,o){var h=i.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=o;var g=i.baseQueue,m=h.pending;if(m!==null){if(g!==null){var _=g.next;g.next=m.next,m.next=_}n.baseQueue=g=m,h.pending=null}if(m=i.baseState,g===null)i.memoizedState=m;else{n=g.next;var T=_=null,O=null,U=n,$=!1;do{var V=U.lane&-536870913;if(V!==U.lane?(xt&V)===V:(Ji&V)===V){var j=U.revertLane;if(j===0)O!==null&&(O=O.next={lane:0,revertLane:0,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null}),V===Kn&&($=!0);else if((Ji&j)===j){U=U.next,j===Kn&&($=!0);continue}else V={lane:0,revertLane:U.revertLane,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},O===null?(T=O=V,_=m):O=O.next=V,_t.lanes|=j,Os|=j;V=U.action,dn&&o(m,V),m=U.hasEagerState?U.eagerState:o(m,V)}else j={lane:V,revertLane:U.revertLane,gesture:U.gesture,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},O===null?(T=O=j,_=m):O=O.next=j,_t.lanes|=V,Os|=V;U=U.next}while(U!==null&&U!==n);if(O===null?_=m:O.next=T,!ti(m,i.memoizedState)&&(he=!0,$&&(o=Wn,o!==null)))throw o;i.memoizedState=m,i.baseState=_,i.baseQueue=O,h.lastRenderedState=m}return g===null&&(h.lanes=0),[i.memoizedState,h.dispatch]}function wu(i){var n=oe(),o=n.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=i;var h=o.dispatch,g=o.pending,m=n.memoizedState;if(g!==null){o.pending=null;var _=g=g.next;do m=i(m,_.action),_=_.next;while(_!==g);ti(m,n.memoizedState)||(he=!0),n.memoizedState=m,n.baseQueue===null&&(n.baseState=m),o.lastRenderedState=m}return[m,h]}function bg(i,n,o){var h=_t,g=oe(),m=Ot;if(m){if(o===void 0)throw Error(s(407));o=o()}else o=n();var _=!ti((jt||g).memoizedState,o);if(_&&(g.memoizedState=o,he=!0),g=g.queue,Eu(Ag.bind(null,h,g,i),[i]),g.getSnapshot!==n||_||ue!==null&&ue.memoizedState.tag&1){if(h.flags|=2048,ia(9,{destroy:void 0},wg.bind(null,h,g,o,n),null),Gt===null)throw Error(s(349));m||(Ji&127)!==0||_g(h,n,o)}return o}function _g(i,n,o){i.flags|=16384,i={getSnapshot:n,value:o},n=_t.updateQueue,n===null?(n=Ko(),_t.updateQueue=n,n.stores=[i]):(o=n.stores,o===null?n.stores=[i]:o.push(i))}function wg(i,n,o,h){n.value=o,n.getSnapshot=h,Sg(n)&&Eg(i)}function Ag(i,n,o){return o(function(){Sg(n)&&Eg(i)})}function Sg(i){var n=i.getSnapshot;i=i.value;try{var o=n();return!ti(i,o)}catch{return!0}}function Eg(i){var n=sn(i,2);n!==null&&Ye(n,i,2)}function Au(i){var n=Be();if(typeof i=="function"){var o=i;if(i=o(),dn){ps(!0);try{o()}finally{ps(!1)}}}return n.memoizedState=n.baseState=i,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:i},n}function Tg(i,n,o,h){return i.baseState=o,_u(i,jt,typeof h=="function"?h:Zi)}function H0(i,n,o,h,g){if(tl(i))throw Error(s(485));if(i=n.action,i!==null){var m={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){m.listeners.push(_)}};P.T!==null?o(!0):m.isTransition=!1,h(m),o=n.pending,o===null?(m.next=n.pending=m,Cg(n,m)):(m.next=o.next,n.pending=o.next=m)}}function Cg(i,n){var o=n.action,h=n.payload,g=i.state;if(n.isTransition){var m=P.T,_={};P.T=_;try{var T=o(g,h),O=P.S;O!==null&&O(_,T),xg(i,n,T)}catch(U){Su(i,n,U)}finally{m!==null&&_.types!==null&&(m.types=_.types),P.T=m}}else try{m=o(g,h),xg(i,n,m)}catch(U){Su(i,n,U)}}function xg(i,n,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(h){Rg(i,n,h)},function(h){return Su(i,n,h)}):Rg(i,n,o)}function Rg(i,n,o){n.status="fulfilled",n.value=o,Og(n),i.state=o,n=i.pending,n!==null&&(o=n.next,o===n?i.pending=null:(o=o.next,n.next=o,Cg(i,o)))}function Su(i,n,o){var h=i.pending;if(i.pending=null,h!==null){h=h.next;do n.status="rejected",n.reason=o,Og(n),n=n.next;while(n!==h)}i.action=null}function Og(i){i=i.listeners;for(var n=0;n<i.length;n++)(0,i[n])()}function kg(i,n){return n}function Dg(i,n){if(Ot){var o=Gt.formState;if(o!==null){t:{var h=_t;if(Ot){if(Yt){e:{for(var g=Yt,m=vi;g.nodeType!==8;){if(!m){g=null;break e}if(g=_i(g.nextSibling),g===null){g=null;break e}}m=g.data,g=m==="F!"||m==="F"?g:null}if(g){Yt=_i(g.nextSibling),h=g.data==="F!";break t}}_s(h)}h=!1}h&&(n=o[0])}}return o=Be(),o.memoizedState=o.baseState=n,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kg,lastRenderedState:n},o.queue=h,o=Wg.bind(null,_t,h),h.dispatch=o,h=Au(!1),m=Ou.bind(null,_t,!1,h.queue),h=Be(),g={state:n,dispatch:null,action:i,pending:null},h.queue=g,o=H0.bind(null,_t,g,m,o),g.dispatch=o,h.memoizedState=i,[n,o,!1]}function Mg(i){var n=oe();return Ng(n,jt,i)}function Ng(i,n,o){if(n=_u(i,n,kg)[0],i=Qo(Zi)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var h=hr(n)}catch(_){throw _===Qn?Fo:_}else h=n;n=oe();var g=n.queue,m=g.dispatch;return o!==n.memoizedState&&(_t.flags|=2048,ia(9,{destroy:void 0},$0.bind(null,g,o),null)),[h,m,i]}function $0(i,n){i.action=n}function Lg(i){var n=oe(),o=jt;if(o!==null)return Ng(n,o,i);oe(),n=n.memoizedState,o=oe();var h=o.queue.dispatch;return o.memoizedState=i,[n,h,!1]}function ia(i,n,o,h){return i={tag:i,create:o,deps:h,inst:n,next:null},n=_t.updateQueue,n===null&&(n=Ko(),_t.updateQueue=n),o=n.lastEffect,o===null?n.lastEffect=i.next=i:(h=o.next,o.next=i,i.next=h,n.lastEffect=i),i}function Bg(){return oe().memoizedState}function Jo(i,n,o,h){var g=Be();_t.flags|=i,g.memoizedState=ia(1|n,{destroy:void 0},o,h===void 0?null:h)}function Zo(i,n,o,h){var g=oe();h=h===void 0?null:h;var m=g.memoizedState.inst;jt!==null&&h!==null&&gu(h,jt.memoizedState.deps)?g.memoizedState=ia(n,m,o,h):(_t.flags|=i,g.memoizedState=ia(1|n,m,o,h))}function Pg(i,n){Jo(8390656,8,i,n)}function Eu(i,n){Zo(2048,8,i,n)}function G0(i){_t.flags|=4;var n=_t.updateQueue;if(n===null)n=Ko(),_t.updateQueue=n,n.events=[i];else{var o=n.events;o===null?n.events=[i]:o.push(i)}}function Ig(i){var n=oe().memoizedState;return G0({ref:n,nextImpl:i}),function(){if((Lt&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function Ug(i,n){return Zo(4,2,i,n)}function jg(i,n){return Zo(4,4,i,n)}function zg(i,n){if(typeof n=="function"){i=i();var o=n(i);return function(){typeof o=="function"?o():n(null)}}if(n!=null)return i=i(),n.current=i,function(){n.current=null}}function Fg(i,n,o){o=o!=null?o.concat([i]):null,Zo(4,4,zg.bind(null,n,i),o)}function Tu(){}function Hg(i,n){var o=oe();n=n===void 0?null:n;var h=o.memoizedState;return n!==null&&gu(n,h[1])?h[0]:(o.memoizedState=[i,n],i)}function $g(i,n){var o=oe();n=n===void 0?null:n;var h=o.memoizedState;if(n!==null&&gu(n,h[1]))return h[0];if(h=i(),dn){ps(!0);try{i()}finally{ps(!1)}}return o.memoizedState=[h,n],h}function Cu(i,n,o){return o===void 0||(Ji&1073741824)!==0&&(xt&261930)===0?i.memoizedState=n:(i.memoizedState=o,i=Gp(),_t.lanes|=i,Os|=i,o)}function Gg(i,n,o,h){return ti(o,n)?o:Zn.current!==null?(i=Cu(i,o,h),ti(i,n)||(he=!0),i):(Ji&42)===0||(Ji&1073741824)!==0&&(xt&261930)===0?(he=!0,i.memoizedState=o):(i=Gp(),_t.lanes|=i,Os|=i,n)}function qg(i,n,o,h,g){var m=G.p;G.p=m!==0&&8>m?m:8;var _=P.T,T={};P.T=T,Ou(i,!1,n,o);try{var O=g(),U=P.S;if(U!==null&&U(T,O),O!==null&&typeof O=="object"&&typeof O.then=="function"){var $=j0(O,h);dr(i,n,$,ri(i))}else dr(i,n,h,ri(i))}catch(V){dr(i,n,{then:function(){},status:"rejected",reason:V},ri())}finally{G.p=m,_!==null&&T.types!==null&&(_.types=T.types),P.T=_}}function q0(){}function xu(i,n,o,h){if(i.tag!==5)throw Error(s(476));var g=Vg(i).queue;qg(i,g,n,W,o===null?q0:function(){return Yg(i),o(h)})}function Vg(i){var n=i.memoizedState;if(n!==null)return n;n={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:W},next:null};var o={};return n.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:o},next:null},i.memoizedState=n,i=i.alternate,i!==null&&(i.memoizedState=n),n}function Yg(i){var n=Vg(i);n.next===null&&(n=i.alternate.memoizedState),dr(i,n.next.queue,{},ri())}function Ru(){return Ee(Or)}function Xg(){return oe().memoizedState}function Kg(){return oe().memoizedState}function V0(i){for(var n=i.return;n!==null;){switch(n.tag){case 24:case 3:var o=ri();i=Ss(o);var h=Es(n,i,o);h!==null&&(Ye(h,n,o),or(h,n,o)),n={cache:su()},i.payload=n;return}n=n.return}}function Y0(i,n,o){var h=ri();o={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},tl(i)?Qg(n,o):(o=Vc(i,n,o,h),o!==null&&(Ye(o,i,h),Jg(o,n,h)))}function Wg(i,n,o){var h=ri();dr(i,n,o,h)}function dr(i,n,o,h){var g={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(tl(i))Qg(n,g);else{var m=i.alternate;if(i.lanes===0&&(m===null||m.lanes===0)&&(m=n.lastRenderedReducer,m!==null))try{var _=n.lastRenderedState,T=m(_,o);if(g.hasEagerState=!0,g.eagerState=T,ti(T,_))return Lo(i,n,g,0),Gt===null&&No(),!1}catch{}if(o=Vc(i,n,g,h),o!==null)return Ye(o,i,h),Jg(o,n,h),!0}return!1}function Ou(i,n,o,h){if(h={lane:2,revertLane:oh(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},tl(i)){if(n)throw Error(s(479))}else n=Vc(i,o,h,2),n!==null&&Ye(n,i,2)}function tl(i){var n=i.alternate;return i===_t||n!==null&&n===_t}function Qg(i,n){ta=Yo=!0;var o=i.pending;o===null?n.next=n:(n.next=o.next,o.next=n),i.pending=n}function Jg(i,n,o){if((o&4194048)!==0){var h=n.lanes;h&=i.pendingLanes,o|=h,n.lanes=o,sf(i,o)}}var fr={readContext:Ee,use:Wo,useCallback:ee,useContext:ee,useEffect:ee,useImperativeHandle:ee,useLayoutEffect:ee,useInsertionEffect:ee,useMemo:ee,useReducer:ee,useRef:ee,useState:ee,useDebugValue:ee,useDeferredValue:ee,useTransition:ee,useSyncExternalStore:ee,useId:ee,useHostTransitionStatus:ee,useFormState:ee,useActionState:ee,useOptimistic:ee,useMemoCache:ee,useCacheRefresh:ee};fr.useEffectEvent=ee;var Zg={readContext:Ee,use:Wo,useCallback:function(i,n){return Be().memoizedState=[i,n===void 0?null:n],i},useContext:Ee,useEffect:Pg,useImperativeHandle:function(i,n,o){o=o!=null?o.concat([i]):null,Jo(4194308,4,zg.bind(null,n,i),o)},useLayoutEffect:function(i,n){return Jo(4194308,4,i,n)},useInsertionEffect:function(i,n){Jo(4,2,i,n)},useMemo:function(i,n){var o=Be();n=n===void 0?null:n;var h=i();if(dn){ps(!0);try{i()}finally{ps(!1)}}return o.memoizedState=[h,n],h},useReducer:function(i,n,o){var h=Be();if(o!==void 0){var g=o(n);if(dn){ps(!0);try{o(n)}finally{ps(!1)}}}else g=n;return h.memoizedState=h.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},h.queue=i,i=i.dispatch=Y0.bind(null,_t,i),[h.memoizedState,i]},useRef:function(i){var n=Be();return i={current:i},n.memoizedState=i},useState:function(i){i=Au(i);var n=i.queue,o=Wg.bind(null,_t,n);return n.dispatch=o,[i.memoizedState,o]},useDebugValue:Tu,useDeferredValue:function(i,n){var o=Be();return Cu(o,i,n)},useTransition:function(){var i=Au(!1);return i=qg.bind(null,_t,i.queue,!0,!1),Be().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,n,o){var h=_t,g=Be();if(Ot){if(o===void 0)throw Error(s(407));o=o()}else{if(o=n(),Gt===null)throw Error(s(349));(xt&127)!==0||_g(h,n,o)}g.memoizedState=o;var m={value:o,getSnapshot:n};return g.queue=m,Pg(Ag.bind(null,h,m,i),[i]),h.flags|=2048,ia(9,{destroy:void 0},wg.bind(null,h,m,o,n),null),o},useId:function(){var i=Be(),n=Gt.identifierPrefix;if(Ot){var o=Li,h=Ni;o=(h&~(1<<32-Ze(h)-1)).toString(32)+o,n="_"+n+"R_"+o,o=Xo++,0<o&&(n+="H"+o.toString(32)),n+="_"}else o=z0++,n="_"+n+"r_"+o.toString(32)+"_";return i.memoizedState=n},useHostTransitionStatus:Ru,useFormState:Dg,useActionState:Dg,useOptimistic:function(i){var n=Be();n.memoizedState=n.baseState=i;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=o,n=Ou.bind(null,_t,!0,o),o.dispatch=n,[i,n]},useMemoCache:bu,useCacheRefresh:function(){return Be().memoizedState=V0.bind(null,_t)},useEffectEvent:function(i){var n=Be(),o={impl:i};return n.memoizedState=o,function(){if((Lt&2)!==0)throw Error(s(440));return o.impl.apply(void 0,arguments)}}},ku={readContext:Ee,use:Wo,useCallback:Hg,useContext:Ee,useEffect:Eu,useImperativeHandle:Fg,useInsertionEffect:Ug,useLayoutEffect:jg,useMemo:$g,useReducer:Qo,useRef:Bg,useState:function(){return Qo(Zi)},useDebugValue:Tu,useDeferredValue:function(i,n){var o=oe();return Gg(o,jt.memoizedState,i,n)},useTransition:function(){var i=Qo(Zi)[0],n=oe().memoizedState;return[typeof i=="boolean"?i:hr(i),n]},useSyncExternalStore:bg,useId:Xg,useHostTransitionStatus:Ru,useFormState:Mg,useActionState:Mg,useOptimistic:function(i,n){var o=oe();return Tg(o,jt,i,n)},useMemoCache:bu,useCacheRefresh:Kg};ku.useEffectEvent=Ig;var tp={readContext:Ee,use:Wo,useCallback:Hg,useContext:Ee,useEffect:Eu,useImperativeHandle:Fg,useInsertionEffect:Ug,useLayoutEffect:jg,useMemo:$g,useReducer:wu,useRef:Bg,useState:function(){return wu(Zi)},useDebugValue:Tu,useDeferredValue:function(i,n){var o=oe();return jt===null?Cu(o,i,n):Gg(o,jt.memoizedState,i,n)},useTransition:function(){var i=wu(Zi)[0],n=oe().memoizedState;return[typeof i=="boolean"?i:hr(i),n]},useSyncExternalStore:bg,useId:Xg,useHostTransitionStatus:Ru,useFormState:Lg,useActionState:Lg,useOptimistic:function(i,n){var o=oe();return jt!==null?Tg(o,jt,i,n):(o.baseState=i,[i,o.queue.dispatch])},useMemoCache:bu,useCacheRefresh:Kg};tp.useEffectEvent=Ig;function Du(i,n,o,h){n=i.memoizedState,o=o(h,n),o=o==null?n:y({},n,o),i.memoizedState=o,i.lanes===0&&(i.updateQueue.baseState=o)}var Mu={enqueueSetState:function(i,n,o){i=i._reactInternals;var h=ri(),g=Ss(h);g.payload=n,o!=null&&(g.callback=o),n=Es(i,g,h),n!==null&&(Ye(n,i,h),or(n,i,h))},enqueueReplaceState:function(i,n,o){i=i._reactInternals;var h=ri(),g=Ss(h);g.tag=1,g.payload=n,o!=null&&(g.callback=o),n=Es(i,g,h),n!==null&&(Ye(n,i,h),or(n,i,h))},enqueueForceUpdate:function(i,n){i=i._reactInternals;var o=ri(),h=Ss(o);h.tag=2,n!=null&&(h.callback=n),n=Es(i,h,o),n!==null&&(Ye(n,i,o),or(n,i,o))}};function ep(i,n,o,h,g,m,_){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,m,_):n.prototype&&n.prototype.isPureReactComponent?!Za(o,h)||!Za(g,m):!0}function ip(i,n,o,h){i=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,h),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,h),n.state!==i&&Mu.enqueueReplaceState(n,n.state,null)}function fn(i,n){var o=n;if("ref"in n){o={};for(var h in n)h!=="ref"&&(o[h]=n[h])}if(i=i.defaultProps){o===n&&(o=y({},o));for(var g in i)o[g]===void 0&&(o[g]=i[g])}return o}function sp(i){Mo(i)}function np(i){console.error(i)}function ap(i){Mo(i)}function el(i,n){try{var o=i.onUncaughtError;o(n.value,{componentStack:n.stack})}catch(h){setTimeout(function(){throw h})}}function rp(i,n,o){try{var h=i.onCaughtError;h(o.value,{componentStack:o.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Nu(i,n,o){return o=Ss(o),o.tag=3,o.payload={element:null},o.callback=function(){el(i,n)},o}function op(i){return i=Ss(i),i.tag=3,i}function lp(i,n,o,h){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var m=h.value;i.payload=function(){return g(m)},i.callback=function(){rp(n,o,h)}}var _=o.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(i.callback=function(){rp(n,o,h),typeof g!="function"&&(ks===null?ks=new Set([this]):ks.add(this));var T=h.stack;this.componentDidCatch(h.value,{componentStack:T!==null?T:""})})}function X0(i,n,o,h,g){if(o.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(n=o.alternate,n!==null&&Xn(n,o,g,!0),o=ii.current,o!==null){switch(o.tag){case 31:case 13:return bi===null?fl():o.alternate===null&&ie===0&&(ie=3),o.flags&=-257,o.flags|=65536,o.lanes=g,h===Ho?o.flags|=16384:(n=o.updateQueue,n===null?o.updateQueue=new Set([h]):n.add(h),nh(i,h,g)),!1;case 22:return o.flags|=65536,h===Ho?o.flags|=16384:(n=o.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([h])},o.updateQueue=n):(o=n.retryQueue,o===null?n.retryQueue=new Set([h]):o.add(h)),nh(i,h,g)),!1}throw Error(s(435,o.tag))}return nh(i,h,g),fl(),!1}if(Ot)return n=ii.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=g,h!==Jc&&(i=Error(s(422),{cause:h}),ir(pi(i,o)))):(h!==Jc&&(n=Error(s(423),{cause:h}),ir(pi(n,o))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,h=pi(h,o),g=Nu(i.stateNode,h,g),cu(i,g),ie!==4&&(ie=2)),!1;var m=Error(s(520),{cause:h});if(m=pi(m,o),wr===null?wr=[m]:wr.push(m),ie!==4&&(ie=2),n===null)return!0;h=pi(h,o),o=n;do{switch(o.tag){case 3:return o.flags|=65536,i=g&-g,o.lanes|=i,i=Nu(o.stateNode,h,i),cu(o,i),!1;case 1:if(n=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(ks===null||!ks.has(m))))return o.flags|=65536,g&=-g,o.lanes|=g,g=op(g),lp(g,i,o,h),cu(o,g),!1}o=o.return}while(o!==null);return!1}var Lu=Error(s(461)),he=!1;function Te(i,n,o,h){n.child=i===null?dg(n,null,o,h):hn(n,i.child,o,h)}function cp(i,n,o,h,g){o=o.render;var m=n.ref;if("ref"in h){var _={};for(var T in h)T!=="ref"&&(_[T]=h[T])}else _=h;return on(n),h=pu(i,n,o,_,m,g),T=mu(),i!==null&&!he?(yu(i,n,g),ts(i,n,g)):(Ot&&T&&Wc(n),n.flags|=1,Te(i,n,h,g),n.child)}function up(i,n,o,h,g){if(i===null){var m=o.type;return typeof m=="function"&&!Yc(m)&&m.defaultProps===void 0&&o.compare===null?(n.tag=15,n.type=m,hp(i,n,m,h,g)):(i=Po(o.type,null,h,n,n.mode,g),i.ref=n.ref,i.return=n,n.child=i)}if(m=i.child,!Hu(i,g)){var _=m.memoizedProps;if(o=o.compare,o=o!==null?o:Za,o(_,h)&&i.ref===n.ref)return ts(i,n,g)}return n.flags|=1,i=Xi(m,h),i.ref=n.ref,i.return=n,n.child=i}function hp(i,n,o,h,g){if(i!==null){var m=i.memoizedProps;if(Za(m,h)&&i.ref===n.ref)if(he=!1,n.pendingProps=h=m,Hu(i,g))(i.flags&131072)!==0&&(he=!0);else return n.lanes=i.lanes,ts(i,n,g)}return Bu(i,n,o,h,g)}function dp(i,n,o,h){var g=h.children,m=i!==null?i.memoizedState:null;if(i===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((n.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,i!==null){for(h=n.child=i.child,g=0;h!==null;)g=g|h.lanes|h.childLanes,h=h.sibling;h=g&~m}else h=0,n.child=null;return fp(i,n,m,o,h)}if((o&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},i!==null&&zo(n,m!==null?m.cachePool:null),m!==null?pg(n,m):hu(),mg(n);else return h=n.lanes=536870912,fp(i,n,m!==null?m.baseLanes|o:o,o,h)}else m!==null?(zo(n,m.cachePool),pg(n,m),Cs(),n.memoizedState=null):(i!==null&&zo(n,null),hu(),Cs());return Te(i,n,g,o),n.child}function gr(i,n){return i!==null&&i.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function fp(i,n,o,h,g){var m=au();return m=m===null?null:{parent:ce._currentValue,pool:m},n.memoizedState={baseLanes:o,cachePool:m},i!==null&&zo(n,null),hu(),mg(n),i!==null&&Xn(i,n,h,!0),n.childLanes=g,null}function il(i,n){return n=nl({mode:n.mode,children:n.children},i.mode),n.ref=i.ref,i.child=n,n.return=i,n}function gp(i,n,o){return hn(n,i.child,null,o),i=il(n,n.pendingProps),i.flags|=2,si(n),n.memoizedState=null,i}function K0(i,n,o){var h=n.pendingProps,g=(n.flags&128)!==0;if(n.flags&=-129,i===null){if(Ot){if(h.mode==="hidden")return i=il(n,h),n.lanes=536870912,gr(null,i);if(fu(n),(i=Yt)?(i=Cm(i,vi),i=i!==null&&i.data==="&"?i:null,i!==null&&(n.memoizedState={dehydrated:i,treeContext:vs!==null?{id:Ni,overflow:Li}:null,retryLane:536870912,hydrationErrors:null},o=Qf(i),o.return=n,n.child=o,Se=n,Yt=null)):i=null,i===null)throw _s(n);return n.lanes=536870912,null}return il(n,h)}var m=i.memoizedState;if(m!==null){var _=m.dehydrated;if(fu(n),g)if(n.flags&256)n.flags&=-257,n=gp(i,n,o);else if(n.memoizedState!==null)n.child=i.child,n.flags|=128,n=null;else throw Error(s(558));else if(he||Xn(i,n,o,!1),g=(o&i.childLanes)!==0,he||g){if(h=Gt,h!==null&&(_=nf(h,o),_!==0&&_!==m.retryLane))throw m.retryLane=_,sn(i,_),Ye(h,i,_),Lu;fl(),n=gp(i,n,o)}else i=m.treeContext,Yt=_i(_.nextSibling),Se=n,Ot=!0,bs=null,vi=!1,i!==null&&tg(n,i),n=il(n,h),n.flags|=4096;return n}return i=Xi(i.child,{mode:h.mode,children:h.children}),i.ref=n.ref,n.child=i,i.return=n,i}function sl(i,n){var o=n.ref;if(o===null)i!==null&&i.ref!==null&&(n.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(s(284));(i===null||i.ref!==o)&&(n.flags|=4194816)}}function Bu(i,n,o,h,g){return on(n),o=pu(i,n,o,h,void 0,g),h=mu(),i!==null&&!he?(yu(i,n,g),ts(i,n,g)):(Ot&&h&&Wc(n),n.flags|=1,Te(i,n,o,g),n.child)}function pp(i,n,o,h,g,m){return on(n),n.updateQueue=null,o=vg(n,h,o,g),yg(i),h=mu(),i!==null&&!he?(yu(i,n,m),ts(i,n,m)):(Ot&&h&&Wc(n),n.flags|=1,Te(i,n,o,m),n.child)}function mp(i,n,o,h,g){if(on(n),n.stateNode===null){var m=Gn,_=o.contextType;typeof _=="object"&&_!==null&&(m=Ee(_)),m=new o(h,m),n.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Mu,n.stateNode=m,m._reactInternals=n,m=n.stateNode,m.props=h,m.state=n.memoizedState,m.refs={},ou(n),_=o.contextType,m.context=typeof _=="object"&&_!==null?Ee(_):Gn,m.state=n.memoizedState,_=o.getDerivedStateFromProps,typeof _=="function"&&(Du(n,o,_,h),m.state=n.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(_=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),_!==m.state&&Mu.enqueueReplaceState(m,m.state,null),cr(n,h,m,g),lr(),m.state=n.memoizedState),typeof m.componentDidMount=="function"&&(n.flags|=4194308),h=!0}else if(i===null){m=n.stateNode;var T=n.memoizedProps,O=fn(o,T);m.props=O;var U=m.context,$=o.contextType;_=Gn,typeof $=="object"&&$!==null&&(_=Ee($));var V=o.getDerivedStateFromProps;$=typeof V=="function"||typeof m.getSnapshotBeforeUpdate=="function",T=n.pendingProps!==T,$||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(T||U!==_)&&ip(n,m,h,_),As=!1;var j=n.memoizedState;m.state=j,cr(n,h,m,g),lr(),U=n.memoizedState,T||j!==U||As?(typeof V=="function"&&(Du(n,o,V,h),U=n.memoizedState),(O=As||ep(n,o,O,h,j,U,_))?($||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(n.flags|=4194308)):(typeof m.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=h,n.memoizedState=U),m.props=h,m.state=U,m.context=_,h=O):(typeof m.componentDidMount=="function"&&(n.flags|=4194308),h=!1)}else{m=n.stateNode,lu(i,n),_=n.memoizedProps,$=fn(o,_),m.props=$,V=n.pendingProps,j=m.context,U=o.contextType,O=Gn,typeof U=="object"&&U!==null&&(O=Ee(U)),T=o.getDerivedStateFromProps,(U=typeof T=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==V||j!==O)&&ip(n,m,h,O),As=!1,j=n.memoizedState,m.state=j,cr(n,h,m,g),lr();var F=n.memoizedState;_!==V||j!==F||As||i!==null&&i.dependencies!==null&&Uo(i.dependencies)?(typeof T=="function"&&(Du(n,o,T,h),F=n.memoizedState),($=As||ep(n,o,$,h,j,F,O)||i!==null&&i.dependencies!==null&&Uo(i.dependencies))?(U||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(h,F,O),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(h,F,O)),typeof m.componentDidUpdate=="function"&&(n.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof m.componentDidUpdate!="function"||_===i.memoizedProps&&j===i.memoizedState||(n.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===i.memoizedProps&&j===i.memoizedState||(n.flags|=1024),n.memoizedProps=h,n.memoizedState=F),m.props=h,m.state=F,m.context=O,h=$):(typeof m.componentDidUpdate!="function"||_===i.memoizedProps&&j===i.memoizedState||(n.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===i.memoizedProps&&j===i.memoizedState||(n.flags|=1024),h=!1)}return m=h,sl(i,n),h=(n.flags&128)!==0,m||h?(m=n.stateNode,o=h&&typeof o.getDerivedStateFromError!="function"?null:m.render(),n.flags|=1,i!==null&&h?(n.child=hn(n,i.child,null,g),n.child=hn(n,null,o,g)):Te(i,n,o,g),n.memoizedState=m.state,i=n.child):i=ts(i,n,g),i}function yp(i,n,o,h){return an(),n.flags|=256,Te(i,n,o,h),n.child}var Pu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Iu(i){return{baseLanes:i,cachePool:rg()}}function Uu(i,n,o){return i=i!==null?i.childLanes&~o:0,n&&(i|=ai),i}function vp(i,n,o){var h=n.pendingProps,g=!1,m=(n.flags&128)!==0,_;if((_=m)||(_=i!==null&&i.memoizedState===null?!1:(re.current&2)!==0),_&&(g=!0,n.flags&=-129),_=(n.flags&32)!==0,n.flags&=-33,i===null){if(Ot){if(g?Ts(n):Cs(),(i=Yt)?(i=Cm(i,vi),i=i!==null&&i.data!=="&"?i:null,i!==null&&(n.memoizedState={dehydrated:i,treeContext:vs!==null?{id:Ni,overflow:Li}:null,retryLane:536870912,hydrationErrors:null},o=Qf(i),o.return=n,n.child=o,Se=n,Yt=null)):i=null,i===null)throw _s(n);return _h(i)?n.lanes=32:n.lanes=536870912,null}var T=h.children;return h=h.fallback,g?(Cs(),g=n.mode,T=nl({mode:"hidden",children:T},g),h=nn(h,g,o,null),T.return=n,h.return=n,T.sibling=h,n.child=T,h=n.child,h.memoizedState=Iu(o),h.childLanes=Uu(i,_,o),n.memoizedState=Pu,gr(null,h)):(Ts(n),ju(n,T))}var O=i.memoizedState;if(O!==null&&(T=O.dehydrated,T!==null)){if(m)n.flags&256?(Ts(n),n.flags&=-257,n=zu(i,n,o)):n.memoizedState!==null?(Cs(),n.child=i.child,n.flags|=128,n=null):(Cs(),T=h.fallback,g=n.mode,h=nl({mode:"visible",children:h.children},g),T=nn(T,g,o,null),T.flags|=2,h.return=n,T.return=n,h.sibling=T,n.child=h,hn(n,i.child,null,o),h=n.child,h.memoizedState=Iu(o),h.childLanes=Uu(i,_,o),n.memoizedState=Pu,n=gr(null,h));else if(Ts(n),_h(T)){if(_=T.nextSibling&&T.nextSibling.dataset,_)var U=_.dgst;_=U,h=Error(s(419)),h.stack="",h.digest=_,ir({value:h,source:null,stack:null}),n=zu(i,n,o)}else if(he||Xn(i,n,o,!1),_=(o&i.childLanes)!==0,he||_){if(_=Gt,_!==null&&(h=nf(_,o),h!==0&&h!==O.retryLane))throw O.retryLane=h,sn(i,h),Ye(_,i,h),Lu;bh(T)||fl(),n=zu(i,n,o)}else bh(T)?(n.flags|=192,n.child=i.child,n=null):(i=O.treeContext,Yt=_i(T.nextSibling),Se=n,Ot=!0,bs=null,vi=!1,i!==null&&tg(n,i),n=ju(n,h.children),n.flags|=4096);return n}return g?(Cs(),T=h.fallback,g=n.mode,O=i.child,U=O.sibling,h=Xi(O,{mode:"hidden",children:h.children}),h.subtreeFlags=O.subtreeFlags&65011712,U!==null?T=Xi(U,T):(T=nn(T,g,o,null),T.flags|=2),T.return=n,h.return=n,h.sibling=T,n.child=h,gr(null,h),h=n.child,T=i.child.memoizedState,T===null?T=Iu(o):(g=T.cachePool,g!==null?(O=ce._currentValue,g=g.parent!==O?{parent:O,pool:O}:g):g=rg(),T={baseLanes:T.baseLanes|o,cachePool:g}),h.memoizedState=T,h.childLanes=Uu(i,_,o),n.memoizedState=Pu,gr(i.child,h)):(Ts(n),o=i.child,i=o.sibling,o=Xi(o,{mode:"visible",children:h.children}),o.return=n,o.sibling=null,i!==null&&(_=n.deletions,_===null?(n.deletions=[i],n.flags|=16):_.push(i)),n.child=o,n.memoizedState=null,o)}function ju(i,n){return n=nl({mode:"visible",children:n},i.mode),n.return=i,i.child=n}function nl(i,n){return i=ei(22,i,null,n),i.lanes=0,i}function zu(i,n,o){return hn(n,i.child,null,o),i=ju(n,n.pendingProps.children),i.flags|=2,n.memoizedState=null,i}function bp(i,n,o){i.lanes|=n;var h=i.alternate;h!==null&&(h.lanes|=n),eu(i.return,n,o)}function Fu(i,n,o,h,g,m){var _=i.memoizedState;_===null?i.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:g,treeForkCount:m}:(_.isBackwards=n,_.rendering=null,_.renderingStartTime=0,_.last=h,_.tail=o,_.tailMode=g,_.treeForkCount=m)}function _p(i,n,o){var h=n.pendingProps,g=h.revealOrder,m=h.tail;h=h.children;var _=re.current,T=(_&2)!==0;if(T?(_=_&1|2,n.flags|=128):_&=1,X(re,_),Te(i,n,h,o),h=Ot?er:0,!T&&i!==null&&(i.flags&128)!==0)t:for(i=n.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&bp(i,o,n);else if(i.tag===19)bp(i,o,n);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break t;for(;i.sibling===null;){if(i.return===null||i.return===n)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(g){case"forwards":for(o=n.child,g=null;o!==null;)i=o.alternate,i!==null&&Vo(i)===null&&(g=o),o=o.sibling;o=g,o===null?(g=n.child,n.child=null):(g=o.sibling,o.sibling=null),Fu(n,!1,g,o,m,h);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=n.child,n.child=null;g!==null;){if(i=g.alternate,i!==null&&Vo(i)===null){n.child=g;break}i=g.sibling,g.sibling=o,o=g,g=i}Fu(n,!0,o,null,m,h);break;case"together":Fu(n,!1,null,null,void 0,h);break;default:n.memoizedState=null}return n.child}function ts(i,n,o){if(i!==null&&(n.dependencies=i.dependencies),Os|=n.lanes,(o&n.childLanes)===0)if(i!==null){if(Xn(i,n,o,!1),(o&n.childLanes)===0)return null}else return null;if(i!==null&&n.child!==i.child)throw Error(s(153));if(n.child!==null){for(i=n.child,o=Xi(i,i.pendingProps),n.child=o,o.return=n;i.sibling!==null;)i=i.sibling,o=o.sibling=Xi(i,i.pendingProps),o.return=n;o.sibling=null}return n.child}function Hu(i,n){return(i.lanes&n)!==0?!0:(i=i.dependencies,!!(i!==null&&Uo(i)))}function W0(i,n,o){switch(n.tag){case 3:ae(n,n.stateNode.containerInfo),ws(n,ce,i.memoizedState.cache),an();break;case 27:case 5:Ks(n);break;case 4:ae(n,n.stateNode.containerInfo);break;case 10:ws(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,fu(n),null;break;case 13:var h=n.memoizedState;if(h!==null)return h.dehydrated!==null?(Ts(n),n.flags|=128,null):(o&n.child.childLanes)!==0?vp(i,n,o):(Ts(n),i=ts(i,n,o),i!==null?i.sibling:null);Ts(n);break;case 19:var g=(i.flags&128)!==0;if(h=(o&n.childLanes)!==0,h||(Xn(i,n,o,!1),h=(o&n.childLanes)!==0),g){if(h)return _p(i,n,o);n.flags|=128}if(g=n.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),X(re,re.current),h)break;return null;case 22:return n.lanes=0,dp(i,n,o,n.pendingProps);case 24:ws(n,ce,i.memoizedState.cache)}return ts(i,n,o)}function wp(i,n,o){if(i!==null)if(i.memoizedProps!==n.pendingProps)he=!0;else{if(!Hu(i,o)&&(n.flags&128)===0)return he=!1,W0(i,n,o);he=(i.flags&131072)!==0}else he=!1,Ot&&(n.flags&1048576)!==0&&Zf(n,er,n.index);switch(n.lanes=0,n.tag){case 16:t:{var h=n.pendingProps;if(i=cn(n.elementType),n.type=i,typeof i=="function")Yc(i)?(h=fn(i,h),n.tag=1,n=mp(null,n,i,h,o)):(n.tag=0,n=Bu(null,n,i,h,o));else{if(i!=null){var g=i.$$typeof;if(g===k){n.tag=11,n=cp(null,n,i,h,o);break t}else if(g===D){n.tag=14,n=up(null,n,i,h,o);break t}}throw n=vt(i)||i,Error(s(306,n,""))}}return n;case 0:return Bu(i,n,n.type,n.pendingProps,o);case 1:return h=n.type,g=fn(h,n.pendingProps),mp(i,n,h,g,o);case 3:t:{if(ae(n,n.stateNode.containerInfo),i===null)throw Error(s(387));h=n.pendingProps;var m=n.memoizedState;g=m.element,lu(i,n),cr(n,h,null,o);var _=n.memoizedState;if(h=_.cache,ws(n,ce,h),h!==m.cache&&iu(n,[ce],o,!0),lr(),h=_.element,m.isDehydrated)if(m={element:h,isDehydrated:!1,cache:_.cache},n.updateQueue.baseState=m,n.memoizedState=m,n.flags&256){n=yp(i,n,h,o);break t}else if(h!==g){g=pi(Error(s(424)),n),ir(g),n=yp(i,n,h,o);break t}else for(i=n.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,Yt=_i(i.firstChild),Se=n,Ot=!0,bs=null,vi=!0,o=dg(n,null,h,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(an(),h===g){n=ts(i,n,o);break t}Te(i,n,h,o)}n=n.child}return n;case 26:return sl(i,n),i===null?(o=Mm(n.type,null,n.pendingProps,null))?n.memoizedState=o:Ot||(o=n.type,i=n.pendingProps,h=_l(ft.current).createElement(o),h[Ae]=n,h[Fe]=i,Ce(h,o,i),ve(h),n.stateNode=h):n.memoizedState=Mm(n.type,i.memoizedProps,n.pendingProps,i.memoizedState),null;case 27:return Ks(n),i===null&&Ot&&(h=n.stateNode=Om(n.type,n.pendingProps,ft.current),Se=n,vi=!0,g=Yt,Ls(n.type)?(wh=g,Yt=_i(h.firstChild)):Yt=g),Te(i,n,n.pendingProps.children,o),sl(i,n),i===null&&(n.flags|=4194304),n.child;case 5:return i===null&&Ot&&((g=h=Yt)&&(h=C_(h,n.type,n.pendingProps,vi),h!==null?(n.stateNode=h,Se=n,Yt=_i(h.firstChild),vi=!1,g=!0):g=!1),g||_s(n)),Ks(n),g=n.type,m=n.pendingProps,_=i!==null?i.memoizedProps:null,h=m.children,mh(g,m)?h=null:_!==null&&mh(g,_)&&(n.flags|=32),n.memoizedState!==null&&(g=pu(i,n,F0,null,null,o),Or._currentValue=g),sl(i,n),Te(i,n,h,o),n.child;case 6:return i===null&&Ot&&((i=o=Yt)&&(o=x_(o,n.pendingProps,vi),o!==null?(n.stateNode=o,Se=n,Yt=null,i=!0):i=!1),i||_s(n)),null;case 13:return vp(i,n,o);case 4:return ae(n,n.stateNode.containerInfo),h=n.pendingProps,i===null?n.child=hn(n,null,h,o):Te(i,n,h,o),n.child;case 11:return cp(i,n,n.type,n.pendingProps,o);case 7:return Te(i,n,n.pendingProps,o),n.child;case 8:return Te(i,n,n.pendingProps.children,o),n.child;case 12:return Te(i,n,n.pendingProps.children,o),n.child;case 10:return h=n.pendingProps,ws(n,n.type,h.value),Te(i,n,h.children,o),n.child;case 9:return g=n.type._context,h=n.pendingProps.children,on(n),g=Ee(g),h=h(g),n.flags|=1,Te(i,n,h,o),n.child;case 14:return up(i,n,n.type,n.pendingProps,o);case 15:return hp(i,n,n.type,n.pendingProps,o);case 19:return _p(i,n,o);case 31:return K0(i,n,o);case 22:return dp(i,n,o,n.pendingProps);case 24:return on(n),h=Ee(ce),i===null?(g=au(),g===null&&(g=Gt,m=su(),g.pooledCache=m,m.refCount++,m!==null&&(g.pooledCacheLanes|=o),g=m),n.memoizedState={parent:h,cache:g},ou(n),ws(n,ce,g)):((i.lanes&o)!==0&&(lu(i,n),cr(n,null,null,o),lr()),g=i.memoizedState,m=n.memoizedState,g.parent!==h?(g={parent:h,cache:h},n.memoizedState=g,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=g),ws(n,ce,h)):(h=m.cache,ws(n,ce,h),h!==g.cache&&iu(n,[ce],o,!0))),Te(i,n,n.pendingProps.children,o),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function es(i){i.flags|=4}function $u(i,n,o,h,g){if((n=(i.mode&32)!==0)&&(n=!1),n){if(i.flags|=16777216,(g&335544128)===g)if(i.stateNode.complete)i.flags|=8192;else if(Xp())i.flags|=8192;else throw un=Ho,ru}else i.flags&=-16777217}function Ap(i,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Im(n))if(Xp())i.flags|=8192;else throw un=Ho,ru}function al(i,n){n!==null&&(i.flags|=4),i.flags&16384&&(n=i.tag!==22?tf():536870912,i.lanes|=n,ra|=n)}function pr(i,n){if(!Ot)switch(i.tailMode){case"hidden":n=i.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?i.tail=null:o.sibling=null;break;case"collapsed":o=i.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?n||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function Xt(i){var n=i.alternate!==null&&i.alternate.child===i.child,o=0,h=0;if(n)for(var g=i.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=h,i.childLanes=o,n}function Q0(i,n,o){var h=n.pendingProps;switch(Qc(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(n),null;case 1:return Xt(n),null;case 3:return o=n.stateNode,h=null,i!==null&&(h=i.memoizedState.cache),n.memoizedState.cache!==h&&(n.flags|=2048),Qi(ce),$t(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(i===null||i.child===null)&&(Yn(n)?es(n):i===null||i.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Zc())),Xt(n),null;case 26:var g=n.type,m=n.memoizedState;return i===null?(es(n),m!==null?(Xt(n),Ap(n,m)):(Xt(n),$u(n,g,null,h,o))):m?m!==i.memoizedState?(es(n),Xt(n),Ap(n,m)):(Xt(n),n.flags&=-16777217):(i=i.memoizedProps,i!==h&&es(n),Xt(n),$u(n,g,i,h,o)),null;case 27:if(gs(n),o=ft.current,g=n.type,i!==null&&n.stateNode!=null)i.memoizedProps!==h&&es(n);else{if(!h){if(n.stateNode===null)throw Error(s(166));return Xt(n),null}i=J.current,Yn(n)?eg(n):(i=Om(g,h,o),n.stateNode=i,es(n))}return Xt(n),null;case 5:if(gs(n),g=n.type,i!==null&&n.stateNode!=null)i.memoizedProps!==h&&es(n);else{if(!h){if(n.stateNode===null)throw Error(s(166));return Xt(n),null}if(m=J.current,Yn(n))eg(n);else{var _=_l(ft.current);switch(m){case 1:m=_.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:m=_.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":m=_.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":m=_.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":m=_.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof h.is=="string"?_.createElement("select",{is:h.is}):_.createElement("select"),h.multiple?m.multiple=!0:h.size&&(m.size=h.size);break;default:m=typeof h.is=="string"?_.createElement(g,{is:h.is}):_.createElement(g)}}m[Ae]=n,m[Fe]=h;t:for(_=n.child;_!==null;){if(_.tag===5||_.tag===6)m.appendChild(_.stateNode);else if(_.tag!==4&&_.tag!==27&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===n)break t;for(;_.sibling===null;){if(_.return===null||_.return===n)break t;_=_.return}_.sibling.return=_.return,_=_.sibling}n.stateNode=m;t:switch(Ce(m,g,h),g){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&es(n)}}return Xt(n),$u(n,n.type,i===null?null:i.memoizedProps,n.pendingProps,o),null;case 6:if(i&&n.stateNode!=null)i.memoizedProps!==h&&es(n);else{if(typeof h!="string"&&n.stateNode===null)throw Error(s(166));if(i=ft.current,Yn(n)){if(i=n.stateNode,o=n.memoizedProps,h=null,g=Se,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}i[Ae]=n,i=!!(i.nodeValue===o||h!==null&&h.suppressHydrationWarning===!0||vm(i.nodeValue,o)),i||_s(n,!0)}else i=_l(i).createTextNode(h),i[Ae]=n,n.stateNode=i}return Xt(n),null;case 31:if(o=n.memoizedState,i===null||i.memoizedState!==null){if(h=Yn(n),o!==null){if(i===null){if(!h)throw Error(s(318));if(i=n.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(557));i[Ae]=n}else an(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Xt(n),i=!1}else o=Zc(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=o),i=!0;if(!i)return n.flags&256?(si(n),n):(si(n),null);if((n.flags&128)!==0)throw Error(s(558))}return Xt(n),null;case 13:if(h=n.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=Yn(n),h!==null&&h.dehydrated!==null){if(i===null){if(!g)throw Error(s(318));if(g=n.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(s(317));g[Ae]=n}else an(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Xt(n),g=!1}else g=Zc(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return n.flags&256?(si(n),n):(si(n),null)}return si(n),(n.flags&128)!==0?(n.lanes=o,n):(o=h!==null,i=i!==null&&i.memoizedState!==null,o&&(h=n.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool),m=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(m=h.memoizedState.cachePool.pool),m!==g&&(h.flags|=2048)),o!==i&&o&&(n.child.flags|=8192),al(n,n.updateQueue),Xt(n),null);case 4:return $t(),i===null&&hh(n.stateNode.containerInfo),Xt(n),null;case 10:return Qi(n.type),Xt(n),null;case 19:if(H(re),h=n.memoizedState,h===null)return Xt(n),null;if(g=(n.flags&128)!==0,m=h.rendering,m===null)if(g)pr(h,!1);else{if(ie!==0||i!==null&&(i.flags&128)!==0)for(i=n.child;i!==null;){if(m=Vo(i),m!==null){for(n.flags|=128,pr(h,!1),i=m.updateQueue,n.updateQueue=i,al(n,i),n.subtreeFlags=0,i=o,o=n.child;o!==null;)Wf(o,i),o=o.sibling;return X(re,re.current&1|2),Ot&&Ki(n,h.treeForkCount),n.child}i=i.sibling}h.tail!==null&&Qe()>ul&&(n.flags|=128,g=!0,pr(h,!1),n.lanes=4194304)}else{if(!g)if(i=Vo(m),i!==null){if(n.flags|=128,g=!0,i=i.updateQueue,n.updateQueue=i,al(n,i),pr(h,!0),h.tail===null&&h.tailMode==="hidden"&&!m.alternate&&!Ot)return Xt(n),null}else 2*Qe()-h.renderingStartTime>ul&&o!==536870912&&(n.flags|=128,g=!0,pr(h,!1),n.lanes=4194304);h.isBackwards?(m.sibling=n.child,n.child=m):(i=h.last,i!==null?i.sibling=m:n.child=m,h.last=m)}return h.tail!==null?(i=h.tail,h.rendering=i,h.tail=i.sibling,h.renderingStartTime=Qe(),i.sibling=null,o=re.current,X(re,g?o&1|2:o&1),Ot&&Ki(n,h.treeForkCount),i):(Xt(n),null);case 22:case 23:return si(n),du(),h=n.memoizedState!==null,i!==null?i.memoizedState!==null!==h&&(n.flags|=8192):h&&(n.flags|=8192),h?(o&536870912)!==0&&(n.flags&128)===0&&(Xt(n),n.subtreeFlags&6&&(n.flags|=8192)):Xt(n),o=n.updateQueue,o!==null&&al(n,o.retryQueue),o=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),h=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(h=n.memoizedState.cachePool.pool),h!==o&&(n.flags|=2048),i!==null&&H(ln),null;case 24:return o=null,i!==null&&(o=i.memoizedState.cache),n.memoizedState.cache!==o&&(n.flags|=2048),Qi(ce),Xt(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function J0(i,n){switch(Qc(n),n.tag){case 1:return i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 3:return Qi(ce),$t(),i=n.flags,(i&65536)!==0&&(i&128)===0?(n.flags=i&-65537|128,n):null;case 26:case 27:case 5:return gs(n),null;case 31:if(n.memoizedState!==null){if(si(n),n.alternate===null)throw Error(s(340));an()}return i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 13:if(si(n),i=n.memoizedState,i!==null&&i.dehydrated!==null){if(n.alternate===null)throw Error(s(340));an()}return i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 19:return H(re),null;case 4:return $t(),null;case 10:return Qi(n.type),null;case 22:case 23:return si(n),du(),i!==null&&H(ln),i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 24:return Qi(ce),null;case 25:return null;default:return null}}function Sp(i,n){switch(Qc(n),n.tag){case 3:Qi(ce),$t();break;case 26:case 27:case 5:gs(n);break;case 4:$t();break;case 31:n.memoizedState!==null&&si(n);break;case 13:si(n);break;case 19:H(re);break;case 10:Qi(n.type);break;case 22:case 23:si(n),du(),i!==null&&H(ln);break;case 24:Qi(ce)}}function mr(i,n){try{var o=n.updateQueue,h=o!==null?o.lastEffect:null;if(h!==null){var g=h.next;o=g;do{if((o.tag&i)===i){h=void 0;var m=o.create,_=o.inst;h=m(),_.destroy=h}o=o.next}while(o!==g)}}catch(T){Ut(n,n.return,T)}}function xs(i,n,o){try{var h=n.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var m=g.next;h=m;do{if((h.tag&i)===i){var _=h.inst,T=_.destroy;if(T!==void 0){_.destroy=void 0,g=n;var O=o,U=T;try{U()}catch($){Ut(g,O,$)}}}h=h.next}while(h!==m)}}catch($){Ut(n,n.return,$)}}function Ep(i){var n=i.updateQueue;if(n!==null){var o=i.stateNode;try{gg(n,o)}catch(h){Ut(i,i.return,h)}}}function Tp(i,n,o){o.props=fn(i.type,i.memoizedProps),o.state=i.memoizedState;try{o.componentWillUnmount()}catch(h){Ut(i,n,h)}}function yr(i,n){try{var o=i.ref;if(o!==null){switch(i.tag){case 26:case 27:case 5:var h=i.stateNode;break;case 30:h=i.stateNode;break;default:h=i.stateNode}typeof o=="function"?i.refCleanup=o(h):o.current=h}}catch(g){Ut(i,n,g)}}function Bi(i,n){var o=i.ref,h=i.refCleanup;if(o!==null)if(typeof h=="function")try{h()}catch(g){Ut(i,n,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){Ut(i,n,g)}else o.current=null}function Cp(i){var n=i.type,o=i.memoizedProps,h=i.stateNode;try{t:switch(n){case"button":case"input":case"select":case"textarea":o.autoFocus&&h.focus();break t;case"img":o.src?h.src=o.src:o.srcSet&&(h.srcset=o.srcSet)}}catch(g){Ut(i,i.return,g)}}function Gu(i,n,o){try{var h=i.stateNode;__(h,i.type,o,n),h[Fe]=n}catch(g){Ut(i,i.return,g)}}function xp(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ls(i.type)||i.tag===4}function qu(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||xp(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ls(i.type)||i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Vu(i,n,o){var h=i.tag;if(h===5||h===6)i=i.stateNode,n?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(i,n):(n=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,n.appendChild(i),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=Vi));else if(h!==4&&(h===27&&Ls(i.type)&&(o=i.stateNode,n=null),i=i.child,i!==null))for(Vu(i,n,o),i=i.sibling;i!==null;)Vu(i,n,o),i=i.sibling}function rl(i,n,o){var h=i.tag;if(h===5||h===6)i=i.stateNode,n?o.insertBefore(i,n):o.appendChild(i);else if(h!==4&&(h===27&&Ls(i.type)&&(o=i.stateNode),i=i.child,i!==null))for(rl(i,n,o),i=i.sibling;i!==null;)rl(i,n,o),i=i.sibling}function Rp(i){var n=i.stateNode,o=i.memoizedProps;try{for(var h=i.type,g=n.attributes;g.length;)n.removeAttributeNode(g[0]);Ce(n,h,o),n[Ae]=i,n[Fe]=o}catch(m){Ut(i,i.return,m)}}var is=!1,de=!1,Yu=!1,Op=typeof WeakSet=="function"?WeakSet:Set,be=null;function Z0(i,n){if(i=i.containerInfo,gh=xl,i=Ff(i),zc(i)){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else t:{o=(o=i.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var g=h.anchorOffset,m=h.focusNode;h=h.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break t}var _=0,T=-1,O=-1,U=0,$=0,V=i,j=null;e:for(;;){for(var F;V!==o||g!==0&&V.nodeType!==3||(T=_+g),V!==m||h!==0&&V.nodeType!==3||(O=_+h),V.nodeType===3&&(_+=V.nodeValue.length),(F=V.firstChild)!==null;)j=V,V=F;for(;;){if(V===i)break e;if(j===o&&++U===g&&(T=_),j===m&&++$===h&&(O=_),(F=V.nextSibling)!==null)break;V=j,j=V.parentNode}V=F}o=T===-1||O===-1?null:{start:T,end:O}}else o=null}o=o||{start:0,end:0}}else o=null;for(ph={focusedElem:i,selectionRange:o},xl=!1,be=n;be!==null;)if(n=be,i=n.child,(n.subtreeFlags&1028)!==0&&i!==null)i.return=n,be=i;else for(;be!==null;){switch(n=be,m=n.alternate,i=n.flags,n.tag){case 0:if((i&4)!==0&&(i=n.updateQueue,i=i!==null?i.events:null,i!==null))for(o=0;o<i.length;o++)g=i[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&m!==null){i=void 0,o=n,g=m.memoizedProps,m=m.memoizedState,h=o.stateNode;try{var tt=fn(o.type,g);i=h.getSnapshotBeforeUpdate(tt,m),h.__reactInternalSnapshotBeforeUpdate=i}catch(ct){Ut(o,o.return,ct)}}break;case 3:if((i&1024)!==0){if(i=n.stateNode.containerInfo,o=i.nodeType,o===9)vh(i);else if(o===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":vh(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(s(163))}if(i=n.sibling,i!==null){i.return=n.return,be=i;break}be=n.return}}function kp(i,n,o){var h=o.flags;switch(o.tag){case 0:case 11:case 15:ns(i,o),h&4&&mr(5,o);break;case 1:if(ns(i,o),h&4)if(i=o.stateNode,n===null)try{i.componentDidMount()}catch(_){Ut(o,o.return,_)}else{var g=fn(o.type,n.memoizedProps);n=n.memoizedState;try{i.componentDidUpdate(g,n,i.__reactInternalSnapshotBeforeUpdate)}catch(_){Ut(o,o.return,_)}}h&64&&Ep(o),h&512&&yr(o,o.return);break;case 3:if(ns(i,o),h&64&&(i=o.updateQueue,i!==null)){if(n=null,o.child!==null)switch(o.child.tag){case 27:case 5:n=o.child.stateNode;break;case 1:n=o.child.stateNode}try{gg(i,n)}catch(_){Ut(o,o.return,_)}}break;case 27:n===null&&h&4&&Rp(o);case 26:case 5:ns(i,o),n===null&&h&4&&Cp(o),h&512&&yr(o,o.return);break;case 12:ns(i,o);break;case 31:ns(i,o),h&4&&Np(i,o);break;case 13:ns(i,o),h&4&&Lp(i,o),h&64&&(i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(o=l_.bind(null,o),R_(i,o))));break;case 22:if(h=o.memoizedState!==null||is,!h){n=n!==null&&n.memoizedState!==null||de,g=is;var m=de;is=h,(de=n)&&!m?as(i,o,(o.subtreeFlags&8772)!==0):ns(i,o),is=g,de=m}break;case 30:break;default:ns(i,o)}}function Dp(i){var n=i.alternate;n!==null&&(i.alternate=null,Dp(n)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(n=i.stateNode,n!==null&&Sc(n)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Kt=null,$e=!1;function ss(i,n,o){for(o=o.child;o!==null;)Mp(i,n,o),o=o.sibling}function Mp(i,n,o){if(Je&&typeof Je.onCommitFiberUnmount=="function")try{Je.onCommitFiberUnmount(Fa,o)}catch{}switch(o.tag){case 26:de||Bi(o,n),ss(i,n,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:de||Bi(o,n);var h=Kt,g=$e;Ls(o.type)&&(Kt=o.stateNode,$e=!1),ss(i,n,o),Cr(o.stateNode),Kt=h,$e=g;break;case 5:de||Bi(o,n);case 6:if(h=Kt,g=$e,Kt=null,ss(i,n,o),Kt=h,$e=g,Kt!==null)if($e)try{(Kt.nodeType===9?Kt.body:Kt.nodeName==="HTML"?Kt.ownerDocument.body:Kt).removeChild(o.stateNode)}catch(m){Ut(o,n,m)}else try{Kt.removeChild(o.stateNode)}catch(m){Ut(o,n,m)}break;case 18:Kt!==null&&($e?(i=Kt,Em(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,o.stateNode),ga(i)):Em(Kt,o.stateNode));break;case 4:h=Kt,g=$e,Kt=o.stateNode.containerInfo,$e=!0,ss(i,n,o),Kt=h,$e=g;break;case 0:case 11:case 14:case 15:xs(2,o,n),de||xs(4,o,n),ss(i,n,o);break;case 1:de||(Bi(o,n),h=o.stateNode,typeof h.componentWillUnmount=="function"&&Tp(o,n,h)),ss(i,n,o);break;case 21:ss(i,n,o);break;case 22:de=(h=de)||o.memoizedState!==null,ss(i,n,o),de=h;break;default:ss(i,n,o)}}function Np(i,n){if(n.memoizedState===null&&(i=n.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{ga(i)}catch(o){Ut(n,n.return,o)}}}function Lp(i,n){if(n.memoizedState===null&&(i=n.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{ga(i)}catch(o){Ut(n,n.return,o)}}function t_(i){switch(i.tag){case 31:case 13:case 19:var n=i.stateNode;return n===null&&(n=i.stateNode=new Op),n;case 22:return i=i.stateNode,n=i._retryCache,n===null&&(n=i._retryCache=new Op),n;default:throw Error(s(435,i.tag))}}function ol(i,n){var o=t_(i);n.forEach(function(h){if(!o.has(h)){o.add(h);var g=c_.bind(null,i,h);h.then(g,g)}})}function Ge(i,n){var o=n.deletions;if(o!==null)for(var h=0;h<o.length;h++){var g=o[h],m=i,_=n,T=_;t:for(;T!==null;){switch(T.tag){case 27:if(Ls(T.type)){Kt=T.stateNode,$e=!1;break t}break;case 5:Kt=T.stateNode,$e=!1;break t;case 3:case 4:Kt=T.stateNode.containerInfo,$e=!0;break t}T=T.return}if(Kt===null)throw Error(s(160));Mp(m,_,g),Kt=null,$e=!1,m=g.alternate,m!==null&&(m.return=null),g.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)Bp(n,i),n=n.sibling}var xi=null;function Bp(i,n){var o=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Ge(n,i),qe(i),h&4&&(xs(3,i,i.return),mr(3,i),xs(5,i,i.return));break;case 1:Ge(n,i),qe(i),h&512&&(de||o===null||Bi(o,o.return)),h&64&&is&&(i=i.updateQueue,i!==null&&(h=i.callbacks,h!==null&&(o=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=o===null?h:o.concat(h))));break;case 26:var g=xi;if(Ge(n,i),qe(i),h&512&&(de||o===null||Bi(o,o.return)),h&4){var m=o!==null?o.memoizedState:null;if(h=i.memoizedState,o===null)if(h===null)if(i.stateNode===null){t:{h=i.type,o=i.memoizedProps,g=g.ownerDocument||g;e:switch(h){case"title":m=g.getElementsByTagName("title")[0],(!m||m[Ga]||m[Ae]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=g.createElement(h),g.head.insertBefore(m,g.querySelector("head > title"))),Ce(m,h,o),m[Ae]=i,ve(m),h=m;break t;case"link":var _=Bm("link","href",g).get(h+(o.href||""));if(_){for(var T=0;T<_.length;T++)if(m=_[T],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){_.splice(T,1);break e}}m=g.createElement(h),Ce(m,h,o),g.head.appendChild(m);break;case"meta":if(_=Bm("meta","content",g).get(h+(o.content||""))){for(T=0;T<_.length;T++)if(m=_[T],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){_.splice(T,1);break e}}m=g.createElement(h),Ce(m,h,o),g.head.appendChild(m);break;default:throw Error(s(468,h))}m[Ae]=i,ve(m),h=m}i.stateNode=h}else Pm(g,i.type,i.stateNode);else i.stateNode=Lm(g,h,i.memoizedProps);else m!==h?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,h===null?Pm(g,i.type,i.stateNode):Lm(g,h,i.memoizedProps)):h===null&&i.stateNode!==null&&Gu(i,i.memoizedProps,o.memoizedProps)}break;case 27:Ge(n,i),qe(i),h&512&&(de||o===null||Bi(o,o.return)),o!==null&&h&4&&Gu(i,i.memoizedProps,o.memoizedProps);break;case 5:if(Ge(n,i),qe(i),h&512&&(de||o===null||Bi(o,o.return)),i.flags&32){g=i.stateNode;try{In(g,"")}catch(tt){Ut(i,i.return,tt)}}h&4&&i.stateNode!=null&&(g=i.memoizedProps,Gu(i,g,o!==null?o.memoizedProps:g)),h&1024&&(Yu=!0);break;case 6:if(Ge(n,i),qe(i),h&4){if(i.stateNode===null)throw Error(s(162));h=i.memoizedProps,o=i.stateNode;try{o.nodeValue=h}catch(tt){Ut(i,i.return,tt)}}break;case 3:if(Sl=null,g=xi,xi=wl(n.containerInfo),Ge(n,i),xi=g,qe(i),h&4&&o!==null&&o.memoizedState.isDehydrated)try{ga(n.containerInfo)}catch(tt){Ut(i,i.return,tt)}Yu&&(Yu=!1,Pp(i));break;case 4:h=xi,xi=wl(i.stateNode.containerInfo),Ge(n,i),qe(i),xi=h;break;case 12:Ge(n,i),qe(i);break;case 31:Ge(n,i),qe(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,ol(i,h)));break;case 13:Ge(n,i),qe(i),i.child.flags&8192&&i.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(cl=Qe()),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,ol(i,h)));break;case 22:g=i.memoizedState!==null;var O=o!==null&&o.memoizedState!==null,U=is,$=de;if(is=U||g,de=$||O,Ge(n,i),de=$,is=U,qe(i),h&8192)t:for(n=i.stateNode,n._visibility=g?n._visibility&-2:n._visibility|1,g&&(o===null||O||is||de||gn(i)),o=null,n=i;;){if(n.tag===5||n.tag===26){if(o===null){O=o=n;try{if(m=O.stateNode,g)_=m.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{T=O.stateNode;var V=O.memoizedProps.style,j=V!=null&&V.hasOwnProperty("display")?V.display:null;T.style.display=j==null||typeof j=="boolean"?"":(""+j).trim()}}catch(tt){Ut(O,O.return,tt)}}}else if(n.tag===6){if(o===null){O=n;try{O.stateNode.nodeValue=g?"":O.memoizedProps}catch(tt){Ut(O,O.return,tt)}}}else if(n.tag===18){if(o===null){O=n;try{var F=O.stateNode;g?Tm(F,!0):Tm(O.stateNode,!1)}catch(tt){Ut(O,O.return,tt)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===i)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break t;for(;n.sibling===null;){if(n.return===null||n.return===i)break t;o===n&&(o=null),n=n.return}o===n&&(o=null),n.sibling.return=n.return,n=n.sibling}h&4&&(h=i.updateQueue,h!==null&&(o=h.retryQueue,o!==null&&(h.retryQueue=null,ol(i,o))));break;case 19:Ge(n,i),qe(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,ol(i,h)));break;case 30:break;case 21:break;default:Ge(n,i),qe(i)}}function qe(i){var n=i.flags;if(n&2){try{for(var o,h=i.return;h!==null;){if(xp(h)){o=h;break}h=h.return}if(o==null)throw Error(s(160));switch(o.tag){case 27:var g=o.stateNode,m=qu(i);rl(i,m,g);break;case 5:var _=o.stateNode;o.flags&32&&(In(_,""),o.flags&=-33);var T=qu(i);rl(i,T,_);break;case 3:case 4:var O=o.stateNode.containerInfo,U=qu(i);Vu(i,U,O);break;default:throw Error(s(161))}}catch($){Ut(i,i.return,$)}i.flags&=-3}n&4096&&(i.flags&=-4097)}function Pp(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var n=i;Pp(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),i=i.sibling}}function ns(i,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)kp(i,n.alternate,n),n=n.sibling}function gn(i){for(i=i.child;i!==null;){var n=i;switch(n.tag){case 0:case 11:case 14:case 15:xs(4,n,n.return),gn(n);break;case 1:Bi(n,n.return);var o=n.stateNode;typeof o.componentWillUnmount=="function"&&Tp(n,n.return,o),gn(n);break;case 27:Cr(n.stateNode);case 26:case 5:Bi(n,n.return),gn(n);break;case 22:n.memoizedState===null&&gn(n);break;case 30:gn(n);break;default:gn(n)}i=i.sibling}}function as(i,n,o){for(o=o&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var h=n.alternate,g=i,m=n,_=m.flags;switch(m.tag){case 0:case 11:case 15:as(g,m,o),mr(4,m);break;case 1:if(as(g,m,o),h=m,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(U){Ut(h,h.return,U)}if(h=m,g=h.updateQueue,g!==null){var T=h.stateNode;try{var O=g.shared.hiddenCallbacks;if(O!==null)for(g.shared.hiddenCallbacks=null,g=0;g<O.length;g++)fg(O[g],T)}catch(U){Ut(h,h.return,U)}}o&&_&64&&Ep(m),yr(m,m.return);break;case 27:Rp(m);case 26:case 5:as(g,m,o),o&&h===null&&_&4&&Cp(m),yr(m,m.return);break;case 12:as(g,m,o);break;case 31:as(g,m,o),o&&_&4&&Np(g,m);break;case 13:as(g,m,o),o&&_&4&&Lp(g,m);break;case 22:m.memoizedState===null&&as(g,m,o),yr(m,m.return);break;case 30:break;default:as(g,m,o)}n=n.sibling}}function Xu(i,n){var o=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),i=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(i=n.memoizedState.cachePool.pool),i!==o&&(i!=null&&i.refCount++,o!=null&&sr(o))}function Ku(i,n){i=null,n.alternate!==null&&(i=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==i&&(n.refCount++,i!=null&&sr(i))}function Ri(i,n,o,h){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Ip(i,n,o,h),n=n.sibling}function Ip(i,n,o,h){var g=n.flags;switch(n.tag){case 0:case 11:case 15:Ri(i,n,o,h),g&2048&&mr(9,n);break;case 1:Ri(i,n,o,h);break;case 3:Ri(i,n,o,h),g&2048&&(i=null,n.alternate!==null&&(i=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==i&&(n.refCount++,i!=null&&sr(i)));break;case 12:if(g&2048){Ri(i,n,o,h),i=n.stateNode;try{var m=n.memoizedProps,_=m.id,T=m.onPostCommit;typeof T=="function"&&T(_,n.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(O){Ut(n,n.return,O)}}else Ri(i,n,o,h);break;case 31:Ri(i,n,o,h);break;case 13:Ri(i,n,o,h);break;case 23:break;case 22:m=n.stateNode,_=n.alternate,n.memoizedState!==null?m._visibility&2?Ri(i,n,o,h):vr(i,n):m._visibility&2?Ri(i,n,o,h):(m._visibility|=2,sa(i,n,o,h,(n.subtreeFlags&10256)!==0||!1)),g&2048&&Xu(_,n);break;case 24:Ri(i,n,o,h),g&2048&&Ku(n.alternate,n);break;default:Ri(i,n,o,h)}}function sa(i,n,o,h,g){for(g=g&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var m=i,_=n,T=o,O=h,U=_.flags;switch(_.tag){case 0:case 11:case 15:sa(m,_,T,O,g),mr(8,_);break;case 23:break;case 22:var $=_.stateNode;_.memoizedState!==null?$._visibility&2?sa(m,_,T,O,g):vr(m,_):($._visibility|=2,sa(m,_,T,O,g)),g&&U&2048&&Xu(_.alternate,_);break;case 24:sa(m,_,T,O,g),g&&U&2048&&Ku(_.alternate,_);break;default:sa(m,_,T,O,g)}n=n.sibling}}function vr(i,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var o=i,h=n,g=h.flags;switch(h.tag){case 22:vr(o,h),g&2048&&Xu(h.alternate,h);break;case 24:vr(o,h),g&2048&&Ku(h.alternate,h);break;default:vr(o,h)}n=n.sibling}}var br=8192;function na(i,n,o){if(i.subtreeFlags&br)for(i=i.child;i!==null;)Up(i,n,o),i=i.sibling}function Up(i,n,o){switch(i.tag){case 26:na(i,n,o),i.flags&br&&i.memoizedState!==null&&z_(o,xi,i.memoizedState,i.memoizedProps);break;case 5:na(i,n,o);break;case 3:case 4:var h=xi;xi=wl(i.stateNode.containerInfo),na(i,n,o),xi=h;break;case 22:i.memoizedState===null&&(h=i.alternate,h!==null&&h.memoizedState!==null?(h=br,br=16777216,na(i,n,o),br=h):na(i,n,o));break;default:na(i,n,o)}}function jp(i){var n=i.alternate;if(n!==null&&(i=n.child,i!==null)){n.child=null;do n=i.sibling,i.sibling=null,i=n;while(i!==null)}}function _r(i){var n=i.deletions;if((i.flags&16)!==0){if(n!==null)for(var o=0;o<n.length;o++){var h=n[o];be=h,Fp(h,i)}jp(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)zp(i),i=i.sibling}function zp(i){switch(i.tag){case 0:case 11:case 15:_r(i),i.flags&2048&&xs(9,i,i.return);break;case 3:_r(i);break;case 12:_r(i);break;case 22:var n=i.stateNode;i.memoizedState!==null&&n._visibility&2&&(i.return===null||i.return.tag!==13)?(n._visibility&=-3,ll(i)):_r(i);break;default:_r(i)}}function ll(i){var n=i.deletions;if((i.flags&16)!==0){if(n!==null)for(var o=0;o<n.length;o++){var h=n[o];be=h,Fp(h,i)}jp(i)}for(i=i.child;i!==null;){switch(n=i,n.tag){case 0:case 11:case 15:xs(8,n,n.return),ll(n);break;case 22:o=n.stateNode,o._visibility&2&&(o._visibility&=-3,ll(n));break;default:ll(n)}i=i.sibling}}function Fp(i,n){for(;be!==null;){var o=be;switch(o.tag){case 0:case 11:case 15:xs(8,o,n);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var h=o.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:sr(o.memoizedState.cache)}if(h=o.child,h!==null)h.return=o,be=h;else t:for(o=i;be!==null;){h=be;var g=h.sibling,m=h.return;if(Dp(h),h===o){be=null;break t}if(g!==null){g.return=m,be=g;break t}be=m}}}var e_={getCacheForType:function(i){var n=Ee(ce),o=n.data.get(i);return o===void 0&&(o=i(),n.data.set(i,o)),o},cacheSignal:function(){return Ee(ce).controller.signal}},i_=typeof WeakMap=="function"?WeakMap:Map,Lt=0,Gt=null,Tt=null,xt=0,It=0,ni=null,Rs=!1,aa=!1,Wu=!1,rs=0,ie=0,Os=0,pn=0,Qu=0,ai=0,ra=0,wr=null,Ve=null,Ju=!1,cl=0,Hp=0,ul=1/0,hl=null,ks=null,me=0,Ds=null,oa=null,os=0,Zu=0,th=null,$p=null,Ar=0,eh=null;function ri(){return(Lt&2)!==0&&xt!==0?xt&-xt:P.T!==null?oh():af()}function Gp(){if(ai===0)if((xt&536870912)===0||Ot){var i=bo;bo<<=1,(bo&3932160)===0&&(bo=262144),ai=i}else ai=536870912;return i=ii.current,i!==null&&(i.flags|=32),ai}function Ye(i,n,o){(i===Gt&&(It===2||It===9)||i.cancelPendingCommit!==null)&&(la(i,0),Ms(i,xt,ai,!1)),$a(i,o),((Lt&2)===0||i!==Gt)&&(i===Gt&&((Lt&2)===0&&(pn|=o),ie===4&&Ms(i,xt,ai,!1)),Pi(i))}function qp(i,n,o){if((Lt&6)!==0)throw Error(s(327));var h=!o&&(n&127)===0&&(n&i.expiredLanes)===0||Ha(i,n),g=h?a_(i,n):sh(i,n,!0),m=h;do{if(g===0){aa&&!h&&Ms(i,n,0,!1);break}else{if(o=i.current.alternate,m&&!s_(o)){g=sh(i,n,!1),m=!1;continue}if(g===2){if(m=n,i.errorRecoveryDisabledLanes&m)var _=0;else _=i.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){n=_;t:{var T=i;g=wr;var O=T.current.memoizedState.isDehydrated;if(O&&(la(T,_).flags|=256),_=sh(T,_,!1),_!==2){if(Wu&&!O){T.errorRecoveryDisabledLanes|=m,pn|=m,g=4;break t}m=Ve,Ve=g,m!==null&&(Ve===null?Ve=m:Ve.push.apply(Ve,m))}g=_}if(m=!1,g!==2)continue}}if(g===1){la(i,0),Ms(i,n,0,!0);break}t:{switch(h=i,m=g,m){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:Ms(h,n,ai,!Rs);break t;case 2:Ve=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(g=cl+300-Qe(),10<g)){if(Ms(h,n,ai,!Rs),wo(h,0,!0)!==0)break t;os=n,h.timeoutHandle=Am(Vp.bind(null,h,o,Ve,hl,Ju,n,ai,pn,ra,Rs,m,"Throttled",-0,0),g);break t}Vp(h,o,Ve,hl,Ju,n,ai,pn,ra,Rs,m,null,-0,0)}}break}while(!0);Pi(i)}function Vp(i,n,o,h,g,m,_,T,O,U,$,V,j,F){if(i.timeoutHandle=-1,V=n.subtreeFlags,V&8192||(V&16785408)===16785408){V={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Vi},Up(n,m,V);var tt=(m&62914560)===m?cl-Qe():(m&4194048)===m?Hp-Qe():0;if(tt=F_(V,tt),tt!==null){os=m,i.cancelPendingCommit=tt(tm.bind(null,i,n,m,o,h,g,_,T,O,$,V,null,j,F)),Ms(i,m,_,!U);return}}tm(i,n,m,o,h,g,_,T,O)}function s_(i){for(var n=i;;){var o=n.tag;if((o===0||o===11||o===15)&&n.flags&16384&&(o=n.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var h=0;h<o.length;h++){var g=o[h],m=g.getSnapshot;g=g.value;try{if(!ti(m(),g))return!1}catch{return!1}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===i)break;for(;n.sibling===null;){if(n.return===null||n.return===i)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ms(i,n,o,h){n&=~Qu,n&=~pn,i.suspendedLanes|=n,i.pingedLanes&=~n,h&&(i.warmLanes|=n),h=i.expirationTimes;for(var g=n;0<g;){var m=31-Ze(g),_=1<<m;h[m]=-1,g&=~_}o!==0&&ef(i,o,n)}function dl(){return(Lt&6)===0?(Sr(0),!1):!0}function ih(){if(Tt!==null){if(It===0)var i=Tt.return;else i=Tt,Wi=rn=null,vu(i),Jn=null,ar=0,i=Tt;for(;i!==null;)Sp(i.alternate,i),i=i.return;Tt=null}}function la(i,n){var o=i.timeoutHandle;o!==-1&&(i.timeoutHandle=-1,S_(o)),o=i.cancelPendingCommit,o!==null&&(i.cancelPendingCommit=null,o()),os=0,ih(),Gt=i,Tt=o=Xi(i.current,null),xt=n,It=0,ni=null,Rs=!1,aa=Ha(i,n),Wu=!1,ra=ai=Qu=pn=Os=ie=0,Ve=wr=null,Ju=!1,(n&8)!==0&&(n|=n&32);var h=i.entangledLanes;if(h!==0)for(i=i.entanglements,h&=n;0<h;){var g=31-Ze(h),m=1<<g;n|=i[g],h&=~m}return rs=n,No(),o}function Yp(i,n){_t=null,P.H=fr,n===Qn||n===Fo?(n=cg(),It=3):n===ru?(n=cg(),It=4):It=n===Lu?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,ni=n,Tt===null&&(ie=1,el(i,pi(n,i.current)))}function Xp(){var i=ii.current;return i===null?!0:(xt&4194048)===xt?bi===null:(xt&62914560)===xt||(xt&536870912)!==0?i===bi:!1}function Kp(){var i=P.H;return P.H=fr,i===null?fr:i}function Wp(){var i=P.A;return P.A=e_,i}function fl(){ie=4,Rs||(xt&4194048)!==xt&&ii.current!==null||(aa=!0),(Os&134217727)===0&&(pn&134217727)===0||Gt===null||Ms(Gt,xt,ai,!1)}function sh(i,n,o){var h=Lt;Lt|=2;var g=Kp(),m=Wp();(Gt!==i||xt!==n)&&(hl=null,la(i,n)),n=!1;var _=ie;t:do try{if(It!==0&&Tt!==null){var T=Tt,O=ni;switch(It){case 8:ih(),_=6;break t;case 3:case 2:case 9:case 6:ii.current===null&&(n=!0);var U=It;if(It=0,ni=null,ca(i,T,O,U),o&&aa){_=0;break t}break;default:U=It,It=0,ni=null,ca(i,T,O,U)}}n_(),_=ie;break}catch($){Yp(i,$)}while(!0);return n&&i.shellSuspendCounter++,Wi=rn=null,Lt=h,P.H=g,P.A=m,Tt===null&&(Gt=null,xt=0,No()),_}function n_(){for(;Tt!==null;)Qp(Tt)}function a_(i,n){var o=Lt;Lt|=2;var h=Kp(),g=Wp();Gt!==i||xt!==n?(hl=null,ul=Qe()+500,la(i,n)):aa=Ha(i,n);t:do try{if(It!==0&&Tt!==null){n=Tt;var m=ni;e:switch(It){case 1:It=0,ni=null,ca(i,n,m,1);break;case 2:case 9:if(og(m)){It=0,ni=null,Jp(n);break}n=function(){It!==2&&It!==9||Gt!==i||(It=7),Pi(i)},m.then(n,n);break t;case 3:It=7;break t;case 4:It=5;break t;case 7:og(m)?(It=0,ni=null,Jp(n)):(It=0,ni=null,ca(i,n,m,7));break;case 5:var _=null;switch(Tt.tag){case 26:_=Tt.memoizedState;case 5:case 27:var T=Tt;if(_?Im(_):T.stateNode.complete){It=0,ni=null;var O=T.sibling;if(O!==null)Tt=O;else{var U=T.return;U!==null?(Tt=U,gl(U)):Tt=null}break e}}It=0,ni=null,ca(i,n,m,5);break;case 6:It=0,ni=null,ca(i,n,m,6);break;case 8:ih(),ie=6;break t;default:throw Error(s(462))}}r_();break}catch($){Yp(i,$)}while(!0);return Wi=rn=null,P.H=h,P.A=g,Lt=o,Tt!==null?0:(Gt=null,xt=0,No(),ie)}function r_(){for(;Tt!==null&&!Ob();)Qp(Tt)}function Qp(i){var n=wp(i.alternate,i,rs);i.memoizedProps=i.pendingProps,n===null?gl(i):Tt=n}function Jp(i){var n=i,o=n.alternate;switch(n.tag){case 15:case 0:n=pp(o,n,n.pendingProps,n.type,void 0,xt);break;case 11:n=pp(o,n,n.pendingProps,n.type.render,n.ref,xt);break;case 5:vu(n);default:Sp(o,n),n=Tt=Wf(n,rs),n=wp(o,n,rs)}i.memoizedProps=i.pendingProps,n===null?gl(i):Tt=n}function ca(i,n,o,h){Wi=rn=null,vu(n),Jn=null,ar=0;var g=n.return;try{if(X0(i,g,n,o,xt)){ie=1,el(i,pi(o,i.current)),Tt=null;return}}catch(m){if(g!==null)throw Tt=g,m;ie=1,el(i,pi(o,i.current)),Tt=null;return}n.flags&32768?(Ot||h===1?i=!0:aa||(xt&536870912)!==0?i=!1:(Rs=i=!0,(h===2||h===9||h===3||h===6)&&(h=ii.current,h!==null&&h.tag===13&&(h.flags|=16384))),Zp(n,i)):gl(n)}function gl(i){var n=i;do{if((n.flags&32768)!==0){Zp(n,Rs);return}i=n.return;var o=Q0(n.alternate,n,rs);if(o!==null){Tt=o;return}if(n=n.sibling,n!==null){Tt=n;return}Tt=n=i}while(n!==null);ie===0&&(ie=5)}function Zp(i,n){do{var o=J0(i.alternate,i);if(o!==null){o.flags&=32767,Tt=o;return}if(o=i.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!n&&(i=i.sibling,i!==null)){Tt=i;return}Tt=i=o}while(i!==null);ie=6,Tt=null}function tm(i,n,o,h,g,m,_,T,O){i.cancelPendingCommit=null;do pl();while(me!==0);if((Lt&6)!==0)throw Error(s(327));if(n!==null){if(n===i.current)throw Error(s(177));if(m=n.lanes|n.childLanes,m|=qc,jb(i,o,m,_,T,O),i===Gt&&(Tt=Gt=null,xt=0),oa=n,Ds=i,os=o,Zu=m,th=g,$p=h,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,u_(yo,function(){return am(),null})):(i.callbackNode=null,i.callbackPriority=0),h=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||h){h=P.T,P.T=null,g=G.p,G.p=2,_=Lt,Lt|=4;try{Z0(i,n,o)}finally{Lt=_,G.p=g,P.T=h}}me=1,em(),im(),sm()}}function em(){if(me===1){me=0;var i=Ds,n=oa,o=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||o){o=P.T,P.T=null;var h=G.p;G.p=2;var g=Lt;Lt|=4;try{Bp(n,i);var m=ph,_=Ff(i.containerInfo),T=m.focusedElem,O=m.selectionRange;if(_!==T&&T&&T.ownerDocument&&zf(T.ownerDocument.documentElement,T)){if(O!==null&&zc(T)){var U=O.start,$=O.end;if($===void 0&&($=U),"selectionStart"in T)T.selectionStart=U,T.selectionEnd=Math.min($,T.value.length);else{var V=T.ownerDocument||document,j=V&&V.defaultView||window;if(j.getSelection){var F=j.getSelection(),tt=T.textContent.length,ct=Math.min(O.start,tt),Ft=O.end===void 0?ct:Math.min(O.end,tt);!F.extend&&ct>Ft&&(_=Ft,Ft=ct,ct=_);var B=jf(T,ct),N=jf(T,Ft);if(B&&N&&(F.rangeCount!==1||F.anchorNode!==B.node||F.anchorOffset!==B.offset||F.focusNode!==N.node||F.focusOffset!==N.offset)){var I=V.createRange();I.setStart(B.node,B.offset),F.removeAllRanges(),ct>Ft?(F.addRange(I),F.extend(N.node,N.offset)):(I.setEnd(N.node,N.offset),F.addRange(I))}}}}for(V=[],F=T;F=F.parentNode;)F.nodeType===1&&V.push({element:F,left:F.scrollLeft,top:F.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<V.length;T++){var q=V[T];q.element.scrollLeft=q.left,q.element.scrollTop=q.top}}xl=!!gh,ph=gh=null}finally{Lt=g,G.p=h,P.T=o}}i.current=n,me=2}}function im(){if(me===2){me=0;var i=Ds,n=oa,o=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||o){o=P.T,P.T=null;var h=G.p;G.p=2;var g=Lt;Lt|=4;try{kp(i,n.alternate,n)}finally{Lt=g,G.p=h,P.T=o}}me=3}}function sm(){if(me===4||me===3){me=0,kb();var i=Ds,n=oa,o=os,h=$p;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?me=5:(me=0,oa=Ds=null,nm(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(ks=null),wc(o),n=n.stateNode,Je&&typeof Je.onCommitFiberRoot=="function")try{Je.onCommitFiberRoot(Fa,n,void 0,(n.current.flags&128)===128)}catch{}if(h!==null){n=P.T,g=G.p,G.p=2,P.T=null;try{for(var m=i.onRecoverableError,_=0;_<h.length;_++){var T=h[_];m(T.value,{componentStack:T.stack})}}finally{P.T=n,G.p=g}}(os&3)!==0&&pl(),Pi(i),g=i.pendingLanes,(o&261930)!==0&&(g&42)!==0?i===eh?Ar++:(Ar=0,eh=i):Ar=0,Sr(0)}}function nm(i,n){(i.pooledCacheLanes&=n)===0&&(n=i.pooledCache,n!=null&&(i.pooledCache=null,sr(n)))}function pl(){return em(),im(),sm(),am()}function am(){if(me!==5)return!1;var i=Ds,n=Zu;Zu=0;var o=wc(os),h=P.T,g=G.p;try{G.p=32>o?32:o,P.T=null,o=th,th=null;var m=Ds,_=os;if(me=0,oa=Ds=null,os=0,(Lt&6)!==0)throw Error(s(331));var T=Lt;if(Lt|=4,zp(m.current),Ip(m,m.current,_,o),Lt=T,Sr(0,!1),Je&&typeof Je.onPostCommitFiberRoot=="function")try{Je.onPostCommitFiberRoot(Fa,m)}catch{}return!0}finally{G.p=g,P.T=h,nm(i,n)}}function rm(i,n,o){n=pi(o,n),n=Nu(i.stateNode,n,2),i=Es(i,n,2),i!==null&&($a(i,2),Pi(i))}function Ut(i,n,o){if(i.tag===3)rm(i,i,o);else for(;n!==null;){if(n.tag===3){rm(n,i,o);break}else if(n.tag===1){var h=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ks===null||!ks.has(h))){i=pi(o,i),o=op(2),h=Es(n,o,2),h!==null&&(lp(o,h,n,i),$a(h,2),Pi(h));break}}n=n.return}}function nh(i,n,o){var h=i.pingCache;if(h===null){h=i.pingCache=new i_;var g=new Set;h.set(n,g)}else g=h.get(n),g===void 0&&(g=new Set,h.set(n,g));g.has(o)||(Wu=!0,g.add(o),i=o_.bind(null,i,n,o),n.then(i,i))}function o_(i,n,o){var h=i.pingCache;h!==null&&h.delete(n),i.pingedLanes|=i.suspendedLanes&o,i.warmLanes&=~o,Gt===i&&(xt&o)===o&&(ie===4||ie===3&&(xt&62914560)===xt&&300>Qe()-cl?(Lt&2)===0&&la(i,0):Qu|=o,ra===xt&&(ra=0)),Pi(i)}function om(i,n){n===0&&(n=tf()),i=sn(i,n),i!==null&&($a(i,n),Pi(i))}function l_(i){var n=i.memoizedState,o=0;n!==null&&(o=n.retryLane),om(i,o)}function c_(i,n){var o=0;switch(i.tag){case 31:case 13:var h=i.stateNode,g=i.memoizedState;g!==null&&(o=g.retryLane);break;case 19:h=i.stateNode;break;case 22:h=i.stateNode._retryCache;break;default:throw Error(s(314))}h!==null&&h.delete(n),om(i,o)}function u_(i,n){return yc(i,n)}var ml=null,ua=null,ah=!1,yl=!1,rh=!1,Ns=0;function Pi(i){i!==ua&&i.next===null&&(ua===null?ml=ua=i:ua=ua.next=i),yl=!0,ah||(ah=!0,d_())}function Sr(i,n){if(!rh&&yl){rh=!0;do for(var o=!1,h=ml;h!==null;){if(i!==0){var g=h.pendingLanes;if(g===0)var m=0;else{var _=h.suspendedLanes,T=h.pingedLanes;m=(1<<31-Ze(42|i)+1)-1,m&=g&~(_&~T),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,hm(h,m))}else m=xt,m=wo(h,h===Gt?m:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(m&3)===0||Ha(h,m)||(o=!0,hm(h,m));h=h.next}while(o);rh=!1}}function h_(){lm()}function lm(){yl=ah=!1;var i=0;Ns!==0&&A_()&&(i=Ns);for(var n=Qe(),o=null,h=ml;h!==null;){var g=h.next,m=cm(h,n);m===0?(h.next=null,o===null?ml=g:o.next=g,g===null&&(ua=o)):(o=h,(i!==0||(m&3)!==0)&&(yl=!0)),h=g}me!==0&&me!==5||Sr(i),Ns!==0&&(Ns=0)}function cm(i,n){for(var o=i.suspendedLanes,h=i.pingedLanes,g=i.expirationTimes,m=i.pendingLanes&-62914561;0<m;){var _=31-Ze(m),T=1<<_,O=g[_];O===-1?((T&o)===0||(T&h)!==0)&&(g[_]=Ub(T,n)):O<=n&&(i.expiredLanes|=T),m&=~T}if(n=Gt,o=xt,o=wo(i,i===n?o:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h=i.callbackNode,o===0||i===n&&(It===2||It===9)||i.cancelPendingCommit!==null)return h!==null&&h!==null&&vc(h),i.callbackNode=null,i.callbackPriority=0;if((o&3)===0||Ha(i,o)){if(n=o&-o,n===i.callbackPriority)return n;switch(h!==null&&vc(h),wc(o)){case 2:case 8:o=Jd;break;case 32:o=yo;break;case 268435456:o=Zd;break;default:o=yo}return h=um.bind(null,i),o=yc(o,h),i.callbackPriority=n,i.callbackNode=o,n}return h!==null&&h!==null&&vc(h),i.callbackPriority=2,i.callbackNode=null,2}function um(i,n){if(me!==0&&me!==5)return i.callbackNode=null,i.callbackPriority=0,null;var o=i.callbackNode;if(pl()&&i.callbackNode!==o)return null;var h=xt;return h=wo(i,i===Gt?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h===0?null:(qp(i,h,n),cm(i,Qe()),i.callbackNode!=null&&i.callbackNode===o?um.bind(null,i):null)}function hm(i,n){if(pl())return null;qp(i,n,!0)}function d_(){E_(function(){(Lt&6)!==0?yc(Qd,h_):lm()})}function oh(){if(Ns===0){var i=Kn;i===0&&(i=vo,vo<<=1,(vo&261888)===0&&(vo=256)),Ns=i}return Ns}function dm(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:To(""+i)}function fm(i,n){var o=n.ownerDocument.createElement("input");return o.name=n.name,o.value=n.value,i.id&&o.setAttribute("form",i.id),n.parentNode.insertBefore(o,n),i=new FormData(i),o.parentNode.removeChild(o),i}function f_(i,n,o,h,g){if(n==="submit"&&o&&o.stateNode===g){var m=dm((g[Fe]||null).action),_=h.submitter;_&&(n=(n=_[Fe]||null)?dm(n.formAction):_.getAttribute("formAction"),n!==null&&(m=n,_=null));var T=new Oo("action","action",null,h,g);i.push({event:T,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Ns!==0){var O=_?fm(g,_):new FormData(g);xu(o,{pending:!0,data:O,method:g.method,action:m},null,O)}}else typeof m=="function"&&(T.preventDefault(),O=_?fm(g,_):new FormData(g),xu(o,{pending:!0,data:O,method:g.method,action:m},m,O))},currentTarget:g}]})}}for(var lh=0;lh<Gc.length;lh++){var ch=Gc[lh],g_=ch.toLowerCase(),p_=ch[0].toUpperCase()+ch.slice(1);Ci(g_,"on"+p_)}Ci(Gf,"onAnimationEnd"),Ci(qf,"onAnimationIteration"),Ci(Vf,"onAnimationStart"),Ci("dblclick","onDoubleClick"),Ci("focusin","onFocus"),Ci("focusout","onBlur"),Ci(D0,"onTransitionRun"),Ci(M0,"onTransitionStart"),Ci(N0,"onTransitionCancel"),Ci(Yf,"onTransitionEnd"),Bn("onMouseEnter",["mouseout","mouseover"]),Bn("onMouseLeave",["mouseout","mouseover"]),Bn("onPointerEnter",["pointerout","pointerover"]),Bn("onPointerLeave",["pointerout","pointerover"]),Js("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Js("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Js("onBeforeInput",["compositionend","keypress","textInput","paste"]),Js("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Js("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Js("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Er="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),m_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Er));function gm(i,n){n=(n&4)!==0;for(var o=0;o<i.length;o++){var h=i[o],g=h.event;h=h.listeners;t:{var m=void 0;if(n)for(var _=h.length-1;0<=_;_--){var T=h[_],O=T.instance,U=T.currentTarget;if(T=T.listener,O!==m&&g.isPropagationStopped())break t;m=T,g.currentTarget=U;try{m(g)}catch($){Mo($)}g.currentTarget=null,m=O}else for(_=0;_<h.length;_++){if(T=h[_],O=T.instance,U=T.currentTarget,T=T.listener,O!==m&&g.isPropagationStopped())break t;m=T,g.currentTarget=U;try{m(g)}catch($){Mo($)}g.currentTarget=null,m=O}}}}function Ct(i,n){var o=n[Ac];o===void 0&&(o=n[Ac]=new Set);var h=i+"__bubble";o.has(h)||(pm(n,i,2,!1),o.add(h))}function uh(i,n,o){var h=0;n&&(h|=4),pm(o,i,h,n)}var vl="_reactListening"+Math.random().toString(36).slice(2);function hh(i){if(!i[vl]){i[vl]=!0,lf.forEach(function(o){o!=="selectionchange"&&(m_.has(o)||uh(o,!1,i),uh(o,!0,i))});var n=i.nodeType===9?i:i.ownerDocument;n===null||n[vl]||(n[vl]=!0,uh("selectionchange",!1,n))}}function pm(i,n,o,h){switch(Gm(n)){case 2:var g=G_;break;case 8:g=q_;break;default:g=Ch}o=g.bind(null,n,o,i),g=void 0,!Dc||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(g=!0),h?g!==void 0?i.addEventListener(n,o,{capture:!0,passive:g}):i.addEventListener(n,o,!0):g!==void 0?i.addEventListener(n,o,{passive:g}):i.addEventListener(n,o,!1)}function dh(i,n,o,h,g){var m=h;if((n&1)===0&&(n&2)===0&&h!==null)t:for(;;){if(h===null)return;var _=h.tag;if(_===3||_===4){var T=h.stateNode.containerInfo;if(T===g)break;if(_===4)for(_=h.return;_!==null;){var O=_.tag;if((O===3||O===4)&&_.stateNode.containerInfo===g)return;_=_.return}for(;T!==null;){if(_=Mn(T),_===null)return;if(O=_.tag,O===5||O===6||O===26||O===27){h=m=_;continue t}T=T.parentNode}}h=h.return}_f(function(){var U=m,$=Oc(o),V=[];t:{var j=Xf.get(i);if(j!==void 0){var F=Oo,tt=i;switch(i){case"keypress":if(xo(o)===0)break t;case"keydown":case"keyup":F=c0;break;case"focusin":tt="focus",F=Bc;break;case"focusout":tt="blur",F=Bc;break;case"beforeblur":case"afterblur":F=Bc;break;case"click":if(o.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":F=Sf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":F=Qb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":F=d0;break;case Gf:case qf:case Vf:F=t0;break;case Yf:F=g0;break;case"scroll":case"scrollend":F=Kb;break;case"wheel":F=m0;break;case"copy":case"cut":case"paste":F=i0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":F=Tf;break;case"toggle":case"beforetoggle":F=v0}var ct=(n&4)!==0,Ft=!ct&&(i==="scroll"||i==="scrollend"),B=ct?j!==null?j+"Capture":null:j;ct=[];for(var N=U,I;N!==null;){var q=N;if(I=q.stateNode,q=q.tag,q!==5&&q!==26&&q!==27||I===null||B===null||(q=Va(N,B),q!=null&&ct.push(Tr(N,q,I))),Ft)break;N=N.return}0<ct.length&&(j=new F(j,tt,null,o,$),V.push({event:j,listeners:ct}))}}if((n&7)===0){t:{if(j=i==="mouseover"||i==="pointerover",F=i==="mouseout"||i==="pointerout",j&&o!==Rc&&(tt=o.relatedTarget||o.fromElement)&&(Mn(tt)||tt[Dn]))break t;if((F||j)&&(j=$.window===$?$:(j=$.ownerDocument)?j.defaultView||j.parentWindow:window,F?(tt=o.relatedTarget||o.toElement,F=U,tt=tt?Mn(tt):null,tt!==null&&(Ft=r(tt),ct=tt.tag,tt!==Ft||ct!==5&&ct!==27&&ct!==6)&&(tt=null)):(F=null,tt=U),F!==tt)){if(ct=Sf,q="onMouseLeave",B="onMouseEnter",N="mouse",(i==="pointerout"||i==="pointerover")&&(ct=Tf,q="onPointerLeave",B="onPointerEnter",N="pointer"),Ft=F==null?j:qa(F),I=tt==null?j:qa(tt),j=new ct(q,N+"leave",F,o,$),j.target=Ft,j.relatedTarget=I,q=null,Mn($)===U&&(ct=new ct(B,N+"enter",tt,o,$),ct.target=I,ct.relatedTarget=Ft,q=ct),Ft=q,F&&tt)e:{for(ct=y_,B=F,N=tt,I=0,q=B;q;q=ct(q))I++;q=0;for(var at=N;at;at=ct(at))q++;for(;0<I-q;)B=ct(B),I--;for(;0<q-I;)N=ct(N),q--;for(;I--;){if(B===N||N!==null&&B===N.alternate){ct=B;break e}B=ct(B),N=ct(N)}ct=null}else ct=null;F!==null&&mm(V,j,F,ct,!1),tt!==null&&Ft!==null&&mm(V,Ft,tt,ct,!0)}}t:{if(j=U?qa(U):window,F=j.nodeName&&j.nodeName.toLowerCase(),F==="select"||F==="input"&&j.type==="file")var Mt=Nf;else if(Df(j))if(Lf)Mt=R0;else{Mt=C0;var it=T0}else F=j.nodeName,!F||F.toLowerCase()!=="input"||j.type!=="checkbox"&&j.type!=="radio"?U&&xc(U.elementType)&&(Mt=Nf):Mt=x0;if(Mt&&(Mt=Mt(i,U))){Mf(V,Mt,o,$);break t}it&&it(i,j,U),i==="focusout"&&U&&j.type==="number"&&U.memoizedProps.value!=null&&Cc(j,"number",j.value)}switch(it=U?qa(U):window,i){case"focusin":(Df(it)||it.contentEditable==="true")&&(Fn=it,Fc=U,tr=null);break;case"focusout":tr=Fc=Fn=null;break;case"mousedown":Hc=!0;break;case"contextmenu":case"mouseup":case"dragend":Hc=!1,Hf(V,o,$);break;case"selectionchange":if(k0)break;case"keydown":case"keyup":Hf(V,o,$)}var wt;if(Ic)t:{switch(i){case"compositionstart":var Rt="onCompositionStart";break t;case"compositionend":Rt="onCompositionEnd";break t;case"compositionupdate":Rt="onCompositionUpdate";break t}Rt=void 0}else zn?Of(i,o)&&(Rt="onCompositionEnd"):i==="keydown"&&o.keyCode===229&&(Rt="onCompositionStart");Rt&&(Cf&&o.locale!=="ko"&&(zn||Rt!=="onCompositionStart"?Rt==="onCompositionEnd"&&zn&&(wt=wf()):(ys=$,Mc="value"in ys?ys.value:ys.textContent,zn=!0)),it=bl(U,Rt),0<it.length&&(Rt=new Ef(Rt,i,null,o,$),V.push({event:Rt,listeners:it}),wt?Rt.data=wt:(wt=kf(o),wt!==null&&(Rt.data=wt)))),(wt=_0?w0(i,o):A0(i,o))&&(Rt=bl(U,"onBeforeInput"),0<Rt.length&&(it=new Ef("onBeforeInput","beforeinput",null,o,$),V.push({event:it,listeners:Rt}),it.data=wt)),f_(V,i,U,o,$)}gm(V,n)})}function Tr(i,n,o){return{instance:i,listener:n,currentTarget:o}}function bl(i,n){for(var o=n+"Capture",h=[];i!==null;){var g=i,m=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||m===null||(g=Va(i,o),g!=null&&h.unshift(Tr(i,g,m)),g=Va(i,n),g!=null&&h.push(Tr(i,g,m))),i.tag===3)return h;i=i.return}return[]}function y_(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function mm(i,n,o,h,g){for(var m=n._reactName,_=[];o!==null&&o!==h;){var T=o,O=T.alternate,U=T.stateNode;if(T=T.tag,O!==null&&O===h)break;T!==5&&T!==26&&T!==27||U===null||(O=U,g?(U=Va(o,m),U!=null&&_.unshift(Tr(o,U,O))):g||(U=Va(o,m),U!=null&&_.push(Tr(o,U,O)))),o=o.return}_.length!==0&&i.push({event:n,listeners:_})}var v_=/\r\n?/g,b_=/\u0000|\uFFFD/g;function ym(i){return(typeof i=="string"?i:""+i).replace(v_,`
`).replace(b_,"")}function vm(i,n){return n=ym(n),ym(i)===n}function zt(i,n,o,h,g,m){switch(o){case"children":typeof h=="string"?n==="body"||n==="textarea"&&h===""||In(i,h):(typeof h=="number"||typeof h=="bigint")&&n!=="body"&&In(i,""+h);break;case"className":So(i,"class",h);break;case"tabIndex":So(i,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":So(i,o,h);break;case"style":vf(i,h,m);break;case"data":if(n!=="object"){So(i,"data",h);break}case"src":case"href":if(h===""&&(n!=="a"||o!=="href")){i.removeAttribute(o);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(o);break}h=To(""+h),i.setAttribute(o,h);break;case"action":case"formAction":if(typeof h=="function"){i.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(n!=="input"&&zt(i,n,"name",g.name,g,null),zt(i,n,"formEncType",g.formEncType,g,null),zt(i,n,"formMethod",g.formMethod,g,null),zt(i,n,"formTarget",g.formTarget,g,null)):(zt(i,n,"encType",g.encType,g,null),zt(i,n,"method",g.method,g,null),zt(i,n,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(o);break}h=To(""+h),i.setAttribute(o,h);break;case"onClick":h!=null&&(i.onclick=Vi);break;case"onScroll":h!=null&&Ct("scroll",i);break;case"onScrollEnd":h!=null&&Ct("scrollend",i);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(s(61));if(o=h.__html,o!=null){if(g.children!=null)throw Error(s(60));i.innerHTML=o}}break;case"multiple":i.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":i.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){i.removeAttribute("xlink:href");break}o=To(""+h),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(o,""+h):i.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(o,""):i.removeAttribute(o);break;case"capture":case"download":h===!0?i.setAttribute(o,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(o,h):i.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?i.setAttribute(o,h):i.removeAttribute(o);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?i.removeAttribute(o):i.setAttribute(o,h);break;case"popover":Ct("beforetoggle",i),Ct("toggle",i),Ao(i,"popover",h);break;case"xlinkActuate":qi(i,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":qi(i,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":qi(i,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":qi(i,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":qi(i,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":qi(i,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":qi(i,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":qi(i,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":qi(i,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Ao(i,"is",h);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Yb.get(o)||o,Ao(i,o,h))}}function fh(i,n,o,h,g,m){switch(o){case"style":vf(i,h,m);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(s(61));if(o=h.__html,o!=null){if(g.children!=null)throw Error(s(60));i.innerHTML=o}}break;case"children":typeof h=="string"?In(i,h):(typeof h=="number"||typeof h=="bigint")&&In(i,""+h);break;case"onScroll":h!=null&&Ct("scroll",i);break;case"onScrollEnd":h!=null&&Ct("scrollend",i);break;case"onClick":h!=null&&(i.onclick=Vi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!cf.hasOwnProperty(o))t:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),n=o.slice(2,g?o.length-7:void 0),m=i[Fe]||null,m=m!=null?m[o]:null,typeof m=="function"&&i.removeEventListener(n,m,g),typeof h=="function")){typeof m!="function"&&m!==null&&(o in i?i[o]=null:i.hasAttribute(o)&&i.removeAttribute(o)),i.addEventListener(n,h,g);break t}o in i?i[o]=h:h===!0?i.setAttribute(o,""):Ao(i,o,h)}}}function Ce(i,n,o){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ct("error",i),Ct("load",i);var h=!1,g=!1,m;for(m in o)if(o.hasOwnProperty(m)){var _=o[m];if(_!=null)switch(m){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:zt(i,n,m,_,o,null)}}g&&zt(i,n,"srcSet",o.srcSet,o,null),h&&zt(i,n,"src",o.src,o,null);return;case"input":Ct("invalid",i);var T=m=_=g=null,O=null,U=null;for(h in o)if(o.hasOwnProperty(h)){var $=o[h];if($!=null)switch(h){case"name":g=$;break;case"type":_=$;break;case"checked":O=$;break;case"defaultChecked":U=$;break;case"value":m=$;break;case"defaultValue":T=$;break;case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(s(137,n));break;default:zt(i,n,h,$,o,null)}}gf(i,m,T,O,U,_,g,!1);return;case"select":Ct("invalid",i),h=_=m=null;for(g in o)if(o.hasOwnProperty(g)&&(T=o[g],T!=null))switch(g){case"value":m=T;break;case"defaultValue":_=T;break;case"multiple":h=T;default:zt(i,n,g,T,o,null)}n=m,o=_,i.multiple=!!h,n!=null?Pn(i,!!h,n,!1):o!=null&&Pn(i,!!h,o,!0);return;case"textarea":Ct("invalid",i),m=g=h=null;for(_ in o)if(o.hasOwnProperty(_)&&(T=o[_],T!=null))switch(_){case"value":h=T;break;case"defaultValue":g=T;break;case"children":m=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(s(91));break;default:zt(i,n,_,T,o,null)}mf(i,h,g,m);return;case"option":for(O in o)o.hasOwnProperty(O)&&(h=o[O],h!=null)&&(O==="selected"?i.selected=h&&typeof h!="function"&&typeof h!="symbol":zt(i,n,O,h,o,null));return;case"dialog":Ct("beforetoggle",i),Ct("toggle",i),Ct("cancel",i),Ct("close",i);break;case"iframe":case"object":Ct("load",i);break;case"video":case"audio":for(h=0;h<Er.length;h++)Ct(Er[h],i);break;case"image":Ct("error",i),Ct("load",i);break;case"details":Ct("toggle",i);break;case"embed":case"source":case"link":Ct("error",i),Ct("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(U in o)if(o.hasOwnProperty(U)&&(h=o[U],h!=null))switch(U){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:zt(i,n,U,h,o,null)}return;default:if(xc(n)){for($ in o)o.hasOwnProperty($)&&(h=o[$],h!==void 0&&fh(i,n,$,h,o,void 0));return}}for(T in o)o.hasOwnProperty(T)&&(h=o[T],h!=null&&zt(i,n,T,h,o,null))}function __(i,n,o,h){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,m=null,_=null,T=null,O=null,U=null,$=null;for(F in o){var V=o[F];if(o.hasOwnProperty(F)&&V!=null)switch(F){case"checked":break;case"value":break;case"defaultValue":O=V;default:h.hasOwnProperty(F)||zt(i,n,F,null,h,V)}}for(var j in h){var F=h[j];if(V=o[j],h.hasOwnProperty(j)&&(F!=null||V!=null))switch(j){case"type":m=F;break;case"name":g=F;break;case"checked":U=F;break;case"defaultChecked":$=F;break;case"value":_=F;break;case"defaultValue":T=F;break;case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(s(137,n));break;default:F!==V&&zt(i,n,j,F,h,V)}}Tc(i,_,T,O,U,$,m,g);return;case"select":F=_=T=j=null;for(m in o)if(O=o[m],o.hasOwnProperty(m)&&O!=null)switch(m){case"value":break;case"multiple":F=O;default:h.hasOwnProperty(m)||zt(i,n,m,null,h,O)}for(g in h)if(m=h[g],O=o[g],h.hasOwnProperty(g)&&(m!=null||O!=null))switch(g){case"value":j=m;break;case"defaultValue":T=m;break;case"multiple":_=m;default:m!==O&&zt(i,n,g,m,h,O)}n=T,o=_,h=F,j!=null?Pn(i,!!o,j,!1):!!h!=!!o&&(n!=null?Pn(i,!!o,n,!0):Pn(i,!!o,o?[]:"",!1));return;case"textarea":F=j=null;for(T in o)if(g=o[T],o.hasOwnProperty(T)&&g!=null&&!h.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:zt(i,n,T,null,h,g)}for(_ in h)if(g=h[_],m=o[_],h.hasOwnProperty(_)&&(g!=null||m!=null))switch(_){case"value":j=g;break;case"defaultValue":F=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(s(91));break;default:g!==m&&zt(i,n,_,g,h,m)}pf(i,j,F);return;case"option":for(var tt in o)j=o[tt],o.hasOwnProperty(tt)&&j!=null&&!h.hasOwnProperty(tt)&&(tt==="selected"?i.selected=!1:zt(i,n,tt,null,h,j));for(O in h)j=h[O],F=o[O],h.hasOwnProperty(O)&&j!==F&&(j!=null||F!=null)&&(O==="selected"?i.selected=j&&typeof j!="function"&&typeof j!="symbol":zt(i,n,O,j,h,F));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ct in o)j=o[ct],o.hasOwnProperty(ct)&&j!=null&&!h.hasOwnProperty(ct)&&zt(i,n,ct,null,h,j);for(U in h)if(j=h[U],F=o[U],h.hasOwnProperty(U)&&j!==F&&(j!=null||F!=null))switch(U){case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(137,n));break;default:zt(i,n,U,j,h,F)}return;default:if(xc(n)){for(var Ft in o)j=o[Ft],o.hasOwnProperty(Ft)&&j!==void 0&&!h.hasOwnProperty(Ft)&&fh(i,n,Ft,void 0,h,j);for($ in h)j=h[$],F=o[$],!h.hasOwnProperty($)||j===F||j===void 0&&F===void 0||fh(i,n,$,j,h,F);return}}for(var B in o)j=o[B],o.hasOwnProperty(B)&&j!=null&&!h.hasOwnProperty(B)&&zt(i,n,B,null,h,j);for(V in h)j=h[V],F=o[V],!h.hasOwnProperty(V)||j===F||j==null&&F==null||zt(i,n,V,j,h,F)}function bm(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function w_(){if(typeof performance.getEntriesByType=="function"){for(var i=0,n=0,o=performance.getEntriesByType("resource"),h=0;h<o.length;h++){var g=o[h],m=g.transferSize,_=g.initiatorType,T=g.duration;if(m&&T&&bm(_)){for(_=0,T=g.responseEnd,h+=1;h<o.length;h++){var O=o[h],U=O.startTime;if(U>T)break;var $=O.transferSize,V=O.initiatorType;$&&bm(V)&&(O=O.responseEnd,_+=$*(O<T?1:(T-U)/(O-U)))}if(--h,n+=8*(m+_)/(g.duration/1e3),i++,10<i)break}}if(0<i)return n/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var gh=null,ph=null;function _l(i){return i.nodeType===9?i:i.ownerDocument}function _m(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wm(i,n){if(i===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&n==="foreignObject"?0:i}function mh(i,n){return i==="textarea"||i==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var yh=null;function A_(){var i=window.event;return i&&i.type==="popstate"?i===yh?!1:(yh=i,!0):(yh=null,!1)}var Am=typeof setTimeout=="function"?setTimeout:void 0,S_=typeof clearTimeout=="function"?clearTimeout:void 0,Sm=typeof Promise=="function"?Promise:void 0,E_=typeof queueMicrotask=="function"?queueMicrotask:typeof Sm<"u"?function(i){return Sm.resolve(null).then(i).catch(T_)}:Am;function T_(i){setTimeout(function(){throw i})}function Ls(i){return i==="head"}function Em(i,n){var o=n,h=0;do{var g=o.nextSibling;if(i.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(h===0){i.removeChild(g),ga(n);return}h--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")h++;else if(o==="html")Cr(i.ownerDocument.documentElement);else if(o==="head"){o=i.ownerDocument.head,Cr(o);for(var m=o.firstChild;m;){var _=m.nextSibling,T=m.nodeName;m[Ga]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=_}}else o==="body"&&Cr(i.ownerDocument.body);o=g}while(o);ga(n)}function Tm(i,n){var o=i;i=0;do{var h=o.nextSibling;if(o.nodeType===1?n?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(n?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),h&&h.nodeType===8)if(o=h.data,o==="/$"){if(i===0)break;i--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||i++;o=h}while(o)}function vh(i){var n=i.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var o=n;switch(n=n.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":vh(o),Sc(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}i.removeChild(o)}}function C_(i,n,o,h){for(;i.nodeType===1;){var g=o;if(i.nodeName.toLowerCase()!==n.toLowerCase()){if(!h&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(h){if(!i[Ga])switch(n){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(m=i.getAttribute("rel"),m==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(m!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(m=i.getAttribute("src"),(m!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&m&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(n==="input"&&i.type==="hidden"){var m=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===m)return i}else return i;if(i=_i(i.nextSibling),i===null)break}return null}function x_(i,n,o){if(n==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=_i(i.nextSibling),i===null))return null;return i}function Cm(i,n){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!n||(i=_i(i.nextSibling),i===null))return null;return i}function bh(i){return i.data==="$?"||i.data==="$~"}function _h(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function R_(i,n){var o=i.ownerDocument;if(i.data==="$~")i._reactRetry=n;else if(i.data!=="$?"||o.readyState!=="loading")n();else{var h=function(){n(),o.removeEventListener("DOMContentLoaded",h)};o.addEventListener("DOMContentLoaded",h),i._reactRetry=h}}function _i(i){for(;i!=null;i=i.nextSibling){var n=i.nodeType;if(n===1||n===3)break;if(n===8){if(n=i.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return i}var wh=null;function xm(i){i=i.nextSibling;for(var n=0;i;){if(i.nodeType===8){var o=i.data;if(o==="/$"||o==="/&"){if(n===0)return _i(i.nextSibling);n--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||n++}i=i.nextSibling}return null}function Rm(i){i=i.previousSibling;for(var n=0;i;){if(i.nodeType===8){var o=i.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(n===0)return i;n--}else o!=="/$"&&o!=="/&"||n++}i=i.previousSibling}return null}function Om(i,n,o){switch(n=_l(o),i){case"html":if(i=n.documentElement,!i)throw Error(s(452));return i;case"head":if(i=n.head,!i)throw Error(s(453));return i;case"body":if(i=n.body,!i)throw Error(s(454));return i;default:throw Error(s(451))}}function Cr(i){for(var n=i.attributes;n.length;)i.removeAttributeNode(n[0]);Sc(i)}var wi=new Map,km=new Set;function wl(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var ls=G.d;G.d={f:O_,r:k_,D:D_,C:M_,L:N_,m:L_,X:P_,S:B_,M:I_};function O_(){var i=ls.f(),n=dl();return i||n}function k_(i){var n=Nn(i);n!==null&&n.tag===5&&n.type==="form"?Yg(n):ls.r(i)}var ha=typeof document>"u"?null:document;function Dm(i,n,o){var h=ha;if(h&&typeof n=="string"&&n){var g=fi(n);g='link[rel="'+i+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),km.has(g)||(km.add(g),i={rel:i,crossOrigin:o,href:n},h.querySelector(g)===null&&(n=h.createElement("link"),Ce(n,"link",i),ve(n),h.head.appendChild(n)))}}function D_(i){ls.D(i),Dm("dns-prefetch",i,null)}function M_(i,n){ls.C(i,n),Dm("preconnect",i,n)}function N_(i,n,o){ls.L(i,n,o);var h=ha;if(h&&i&&n){var g='link[rel="preload"][as="'+fi(n)+'"]';n==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+fi(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+fi(o.imageSizes)+'"]')):g+='[href="'+fi(i)+'"]';var m=g;switch(n){case"style":m=da(i);break;case"script":m=fa(i)}wi.has(m)||(i=y({rel:"preload",href:n==="image"&&o&&o.imageSrcSet?void 0:i,as:n},o),wi.set(m,i),h.querySelector(g)!==null||n==="style"&&h.querySelector(xr(m))||n==="script"&&h.querySelector(Rr(m))||(n=h.createElement("link"),Ce(n,"link",i),ve(n),h.head.appendChild(n)))}}function L_(i,n){ls.m(i,n);var o=ha;if(o&&i){var h=n&&typeof n.as=="string"?n.as:"script",g='link[rel="modulepreload"][as="'+fi(h)+'"][href="'+fi(i)+'"]',m=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=fa(i)}if(!wi.has(m)&&(i=y({rel:"modulepreload",href:i},n),wi.set(m,i),o.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Rr(m)))return}h=o.createElement("link"),Ce(h,"link",i),ve(h),o.head.appendChild(h)}}}function B_(i,n,o){ls.S(i,n,o);var h=ha;if(h&&i){var g=Ln(h).hoistableStyles,m=da(i);n=n||"default";var _=g.get(m);if(!_){var T={loading:0,preload:null};if(_=h.querySelector(xr(m)))T.loading=5;else{i=y({rel:"stylesheet",href:i,"data-precedence":n},o),(o=wi.get(m))&&Ah(i,o);var O=_=h.createElement("link");ve(O),Ce(O,"link",i),O._p=new Promise(function(U,$){O.onload=U,O.onerror=$}),O.addEventListener("load",function(){T.loading|=1}),O.addEventListener("error",function(){T.loading|=2}),T.loading|=4,Al(_,n,h)}_={type:"stylesheet",instance:_,count:1,state:T},g.set(m,_)}}}function P_(i,n){ls.X(i,n);var o=ha;if(o&&i){var h=Ln(o).hoistableScripts,g=fa(i),m=h.get(g);m||(m=o.querySelector(Rr(g)),m||(i=y({src:i,async:!0},n),(n=wi.get(g))&&Sh(i,n),m=o.createElement("script"),ve(m),Ce(m,"link",i),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},h.set(g,m))}}function I_(i,n){ls.M(i,n);var o=ha;if(o&&i){var h=Ln(o).hoistableScripts,g=fa(i),m=h.get(g);m||(m=o.querySelector(Rr(g)),m||(i=y({src:i,async:!0,type:"module"},n),(n=wi.get(g))&&Sh(i,n),m=o.createElement("script"),ve(m),Ce(m,"link",i),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},h.set(g,m))}}function Mm(i,n,o,h){var g=(g=ft.current)?wl(g):null;if(!g)throw Error(s(446));switch(i){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(n=da(o.href),o=Ln(g).hoistableStyles,h=o.get(n),h||(h={type:"style",instance:null,count:0,state:null},o.set(n,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){i=da(o.href);var m=Ln(g).hoistableStyles,_=m.get(i);if(_||(g=g.ownerDocument||g,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(i,_),(m=g.querySelector(xr(i)))&&!m._p&&(_.instance=m,_.state.loading=5),wi.has(i)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},wi.set(i,o),m||U_(g,i,o,_.state))),n&&h===null)throw Error(s(528,""));return _}if(n&&h!==null)throw Error(s(529,""));return null;case"script":return n=o.async,o=o.src,typeof o=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=fa(o),o=Ln(g).hoistableScripts,h=o.get(n),h||(h={type:"script",instance:null,count:0,state:null},o.set(n,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,i))}}function da(i){return'href="'+fi(i)+'"'}function xr(i){return'link[rel="stylesheet"]['+i+"]"}function Nm(i){return y({},i,{"data-precedence":i.precedence,precedence:null})}function U_(i,n,o,h){i.querySelector('link[rel="preload"][as="style"]['+n+"]")?h.loading=1:(n=i.createElement("link"),h.preload=n,n.addEventListener("load",function(){return h.loading|=1}),n.addEventListener("error",function(){return h.loading|=2}),Ce(n,"link",o),ve(n),i.head.appendChild(n))}function fa(i){return'[src="'+fi(i)+'"]'}function Rr(i){return"script[async]"+i}function Lm(i,n,o){if(n.count++,n.instance===null)switch(n.type){case"style":var h=i.querySelector('style[data-href~="'+fi(o.href)+'"]');if(h)return n.instance=h,ve(h),h;var g=y({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return h=(i.ownerDocument||i).createElement("style"),ve(h),Ce(h,"style",g),Al(h,o.precedence,i),n.instance=h;case"stylesheet":g=da(o.href);var m=i.querySelector(xr(g));if(m)return n.state.loading|=4,n.instance=m,ve(m),m;h=Nm(o),(g=wi.get(g))&&Ah(h,g),m=(i.ownerDocument||i).createElement("link"),ve(m);var _=m;return _._p=new Promise(function(T,O){_.onload=T,_.onerror=O}),Ce(m,"link",h),n.state.loading|=4,Al(m,o.precedence,i),n.instance=m;case"script":return m=fa(o.src),(g=i.querySelector(Rr(m)))?(n.instance=g,ve(g),g):(h=o,(g=wi.get(m))&&(h=y({},o),Sh(h,g)),i=i.ownerDocument||i,g=i.createElement("script"),ve(g),Ce(g,"link",h),i.head.appendChild(g),n.instance=g);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(h=n.instance,n.state.loading|=4,Al(h,o.precedence,i));return n.instance}function Al(i,n,o){for(var h=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,m=g,_=0;_<h.length;_++){var T=h[_];if(T.dataset.precedence===n)m=T;else if(m!==g)break}m?m.parentNode.insertBefore(i,m.nextSibling):(n=o.nodeType===9?o.head:o,n.insertBefore(i,n.firstChild))}function Ah(i,n){i.crossOrigin==null&&(i.crossOrigin=n.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=n.referrerPolicy),i.title==null&&(i.title=n.title)}function Sh(i,n){i.crossOrigin==null&&(i.crossOrigin=n.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=n.referrerPolicy),i.integrity==null&&(i.integrity=n.integrity)}var Sl=null;function Bm(i,n,o){if(Sl===null){var h=new Map,g=Sl=new Map;g.set(o,h)}else g=Sl,h=g.get(o),h||(h=new Map,g.set(o,h));if(h.has(i))return h;for(h.set(i,null),o=o.getElementsByTagName(i),g=0;g<o.length;g++){var m=o[g];if(!(m[Ga]||m[Ae]||i==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var _=m.getAttribute(n)||"";_=i+_;var T=h.get(_);T?T.push(m):h.set(_,[m])}}return h}function Pm(i,n,o){i=i.ownerDocument||i,i.head.insertBefore(o,n==="title"?i.querySelector("head > title"):null)}function j_(i,n,o){if(o===1||n.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(i=n.disabled,typeof n.precedence=="string"&&i==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Im(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function z_(i,n,o,h){if(o.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=da(h.href),m=n.querySelector(xr(g));if(m){n=m._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(i.count++,i=El.bind(i),n.then(i,i)),o.state.loading|=4,o.instance=m,ve(m);return}m=n.ownerDocument||n,h=Nm(h),(g=wi.get(g))&&Ah(h,g),m=m.createElement("link"),ve(m);var _=m;_._p=new Promise(function(T,O){_.onload=T,_.onerror=O}),Ce(m,"link",h),o.instance=m}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(o,n),(n=o.state.preload)&&(o.state.loading&3)===0&&(i.count++,o=El.bind(i),n.addEventListener("load",o),n.addEventListener("error",o))}}var Eh=0;function F_(i,n){return i.stylesheets&&i.count===0&&Cl(i,i.stylesheets),0<i.count||0<i.imgCount?function(o){var h=setTimeout(function(){if(i.stylesheets&&Cl(i,i.stylesheets),i.unsuspend){var m=i.unsuspend;i.unsuspend=null,m()}},6e4+n);0<i.imgBytes&&Eh===0&&(Eh=62500*w_());var g=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Cl(i,i.stylesheets),i.unsuspend)){var m=i.unsuspend;i.unsuspend=null,m()}},(i.imgBytes>Eh?50:800)+n);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(h),clearTimeout(g)}}:null}function El(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Cl(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Tl=null;function Cl(i,n){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Tl=new Map,n.forEach(H_,i),Tl=null,El.call(i))}function H_(i,n){if(!(n.state.loading&4)){var o=Tl.get(i);if(o)var h=o.get(null);else{o=new Map,Tl.set(i,o);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<g.length;m++){var _=g[m];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(o.set(_.dataset.precedence,_),h=_)}h&&o.set(null,h)}g=n.instance,_=g.getAttribute("data-precedence"),m=o.get(_)||h,m===h&&o.set(null,g),o.set(_,g),this.count++,h=El.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),m?m.parentNode.insertBefore(g,m.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),n.state.loading|=4}}var Or={$$typeof:C,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function $_(i,n,o,h,g,m,_,T,O){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=bc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bc(0),this.hiddenUpdates=bc(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=m,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function Um(i,n,o,h,g,m,_,T,O,U,$,V){return i=new $_(i,n,o,_,O,U,$,V,T),n=1,m===!0&&(n|=24),m=ei(3,null,null,n),i.current=m,m.stateNode=i,n=su(),n.refCount++,i.pooledCache=n,n.refCount++,m.memoizedState={element:h,isDehydrated:o,cache:n},ou(m),i}function jm(i){return i?(i=Gn,i):Gn}function zm(i,n,o,h,g,m){g=jm(g),h.context===null?h.context=g:h.pendingContext=g,h=Ss(n),h.payload={element:o},m=m===void 0?null:m,m!==null&&(h.callback=m),o=Es(i,h,n),o!==null&&(Ye(o,i,n),or(o,i,n))}function Fm(i,n){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var o=i.retryLane;i.retryLane=o!==0&&o<n?o:n}}function Th(i,n){Fm(i,n),(i=i.alternate)&&Fm(i,n)}function Hm(i){if(i.tag===13||i.tag===31){var n=sn(i,67108864);n!==null&&Ye(n,i,67108864),Th(i,67108864)}}function $m(i){if(i.tag===13||i.tag===31){var n=ri();n=_c(n);var o=sn(i,n);o!==null&&Ye(o,i,n),Th(i,n)}}var xl=!0;function G_(i,n,o,h){var g=P.T;P.T=null;var m=G.p;try{G.p=2,Ch(i,n,o,h)}finally{G.p=m,P.T=g}}function q_(i,n,o,h){var g=P.T;P.T=null;var m=G.p;try{G.p=8,Ch(i,n,o,h)}finally{G.p=m,P.T=g}}function Ch(i,n,o,h){if(xl){var g=xh(h);if(g===null)dh(i,n,h,Rl,o),qm(i,h);else if(Y_(g,i,n,o,h))h.stopPropagation();else if(qm(i,h),n&4&&-1<V_.indexOf(i)){for(;g!==null;){var m=Nn(g);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var _=Qs(m.pendingLanes);if(_!==0){var T=m;for(T.pendingLanes|=2,T.entangledLanes|=2;_;){var O=1<<31-Ze(_);T.entanglements[1]|=O,_&=~O}Pi(m),(Lt&6)===0&&(ul=Qe()+500,Sr(0))}}break;case 31:case 13:T=sn(m,2),T!==null&&Ye(T,m,2),dl(),Th(m,2)}if(m=xh(h),m===null&&dh(i,n,h,Rl,o),m===g)break;g=m}g!==null&&h.stopPropagation()}else dh(i,n,h,null,o)}}function xh(i){return i=Oc(i),Rh(i)}var Rl=null;function Rh(i){if(Rl=null,i=Mn(i),i!==null){var n=r(i);if(n===null)i=null;else{var o=n.tag;if(o===13){if(i=c(n),i!==null)return i;i=null}else if(o===31){if(i=u(n),i!==null)return i;i=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;i=null}else n!==i&&(i=null)}}return Rl=i,null}function Gm(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Db()){case Qd:return 2;case Jd:return 8;case yo:case Mb:return 32;case Zd:return 268435456;default:return 32}default:return 32}}var Oh=!1,Bs=null,Ps=null,Is=null,kr=new Map,Dr=new Map,Us=[],V_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function qm(i,n){switch(i){case"focusin":case"focusout":Bs=null;break;case"dragenter":case"dragleave":Ps=null;break;case"mouseover":case"mouseout":Is=null;break;case"pointerover":case"pointerout":kr.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dr.delete(n.pointerId)}}function Mr(i,n,o,h,g,m){return i===null||i.nativeEvent!==m?(i={blockedOn:n,domEventName:o,eventSystemFlags:h,nativeEvent:m,targetContainers:[g]},n!==null&&(n=Nn(n),n!==null&&Hm(n)),i):(i.eventSystemFlags|=h,n=i.targetContainers,g!==null&&n.indexOf(g)===-1&&n.push(g),i)}function Y_(i,n,o,h,g){switch(n){case"focusin":return Bs=Mr(Bs,i,n,o,h,g),!0;case"dragenter":return Ps=Mr(Ps,i,n,o,h,g),!0;case"mouseover":return Is=Mr(Is,i,n,o,h,g),!0;case"pointerover":var m=g.pointerId;return kr.set(m,Mr(kr.get(m)||null,i,n,o,h,g)),!0;case"gotpointercapture":return m=g.pointerId,Dr.set(m,Mr(Dr.get(m)||null,i,n,o,h,g)),!0}return!1}function Vm(i){var n=Mn(i.target);if(n!==null){var o=r(n);if(o!==null){if(n=o.tag,n===13){if(n=c(o),n!==null){i.blockedOn=n,rf(i.priority,function(){$m(o)});return}}else if(n===31){if(n=u(o),n!==null){i.blockedOn=n,rf(i.priority,function(){$m(o)});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){i.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Ol(i){if(i.blockedOn!==null)return!1;for(var n=i.targetContainers;0<n.length;){var o=xh(i.nativeEvent);if(o===null){o=i.nativeEvent;var h=new o.constructor(o.type,o);Rc=h,o.target.dispatchEvent(h),Rc=null}else return n=Nn(o),n!==null&&Hm(n),i.blockedOn=o,!1;n.shift()}return!0}function Ym(i,n,o){Ol(i)&&o.delete(n)}function X_(){Oh=!1,Bs!==null&&Ol(Bs)&&(Bs=null),Ps!==null&&Ol(Ps)&&(Ps=null),Is!==null&&Ol(Is)&&(Is=null),kr.forEach(Ym),Dr.forEach(Ym)}function kl(i,n){i.blockedOn===n&&(i.blockedOn=null,Oh||(Oh=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,X_)))}var Dl=null;function Xm(i){Dl!==i&&(Dl=i,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){Dl===i&&(Dl=null);for(var n=0;n<i.length;n+=3){var o=i[n],h=i[n+1],g=i[n+2];if(typeof h!="function"){if(Rh(h||o)===null)continue;break}var m=Nn(o);m!==null&&(i.splice(n,3),n-=3,xu(m,{pending:!0,data:g,method:o.method,action:h},h,g))}}))}function ga(i){function n(O){return kl(O,i)}Bs!==null&&kl(Bs,i),Ps!==null&&kl(Ps,i),Is!==null&&kl(Is,i),kr.forEach(n),Dr.forEach(n);for(var o=0;o<Us.length;o++){var h=Us[o];h.blockedOn===i&&(h.blockedOn=null)}for(;0<Us.length&&(o=Us[0],o.blockedOn===null);)Vm(o),o.blockedOn===null&&Us.shift();if(o=(i.ownerDocument||i).$$reactFormReplay,o!=null)for(h=0;h<o.length;h+=3){var g=o[h],m=o[h+1],_=g[Fe]||null;if(typeof m=="function")_||Xm(o);else if(_){var T=null;if(m&&m.hasAttribute("formAction")){if(g=m,_=m[Fe]||null)T=_.formAction;else if(Rh(g)!==null)continue}else T=_.action;typeof T=="function"?o[h+1]=T:(o.splice(h,3),h-=3),Xm(o)}}}function Km(){function i(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(_){return g=_})},focusReset:"manual",scroll:"manual"})}function n(){g!==null&&(g(),g=null),h||setTimeout(o,20)}function o(){if(!h&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,g=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(o,100),function(){h=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),g!==null&&(g(),g=null)}}}function kh(i){this._internalRoot=i}Ml.prototype.render=kh.prototype.render=function(i){var n=this._internalRoot;if(n===null)throw Error(s(409));var o=n.current,h=ri();zm(o,h,i,n,null,null)},Ml.prototype.unmount=kh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var n=i.containerInfo;zm(i.current,2,null,i,null,null),dl(),n[Dn]=null}};function Ml(i){this._internalRoot=i}Ml.prototype.unstable_scheduleHydration=function(i){if(i){var n=af();i={blockedOn:null,target:i,priority:n};for(var o=0;o<Us.length&&n!==0&&n<Us[o].priority;o++);Us.splice(o,0,i),o===0&&Vm(i)}};var Wm=t.version;if(Wm!=="19.2.3")throw Error(s(527,Wm,"19.2.3"));G.findDOMNode=function(i){var n=i._reactInternals;if(n===void 0)throw typeof i.render=="function"?Error(s(188)):(i=Object.keys(i).join(","),Error(s(268,i)));return i=f(n),i=i!==null?p(i):null,i=i===null?null:i.stateNode,i};var K_={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nl.isDisabled&&Nl.supportsFiber)try{Fa=Nl.inject(K_),Je=Nl}catch{}}return Lr.createRoot=function(i,n){if(!a(i))throw Error(s(299));var o=!1,h="",g=sp,m=np,_=ap;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(h=n.identifierPrefix),n.onUncaughtError!==void 0&&(g=n.onUncaughtError),n.onCaughtError!==void 0&&(m=n.onCaughtError),n.onRecoverableError!==void 0&&(_=n.onRecoverableError)),n=Um(i,1,!1,null,null,o,h,null,g,m,_,Km),i[Dn]=n.current,hh(i),new kh(n)},Lr.hydrateRoot=function(i,n,o){if(!a(i))throw Error(s(299));var h=!1,g="",m=sp,_=np,T=ap,O=null;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(_=o.onCaughtError),o.onRecoverableError!==void 0&&(T=o.onRecoverableError),o.formState!==void 0&&(O=o.formState)),n=Um(i,1,!0,n,o??null,h,g,O,m,_,T,Km),n.context=jm(null),o=n.current,h=ri(),h=_c(h),g=Ss(h),g.callback=null,Es(o,g,h),o=h,n.current.lanes=o,$a(n,o),Pi(n),i[Dn]=n.current,hh(i),new Ml(n)},Lr.version="19.2.3",Lr}var ly;function aw(){if(ly)return Lh.exports;ly=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(t){console.error(t)}}return l(),Lh.exports=nw(),Lh.exports}var rw=aw();function nc(l,t){var e={};for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&t.indexOf(s)<0&&(e[s]=l[s]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(l);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(l,s[a])&&(e[s[a]]=l[s[a]]);return e}function ow(l,t,e,s){function a(r){return r instanceof e?r:new e(function(c){c(r)})}return new(e||(e=Promise))(function(r,c){function u(p){try{f(s.next(p))}catch(y){c(y)}}function d(p){try{f(s.throw(p))}catch(y){c(y)}}function f(p){p.done?r(p.value):a(p.value).then(u,d)}f((s=s.apply(l,t||[])).next())})}const lw=l=>l?(...t)=>l(...t):(...t)=>fetch(...t);class Od extends Error{constructor(t,e="FunctionsError",s){super(t),this.name=e,this.context=s}}class cw extends Od{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class cy extends Od{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class uy extends Od{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var sd;(function(l){l.Any="any",l.ApNortheast1="ap-northeast-1",l.ApNortheast2="ap-northeast-2",l.ApSouth1="ap-south-1",l.ApSoutheast1="ap-southeast-1",l.ApSoutheast2="ap-southeast-2",l.CaCentral1="ca-central-1",l.EuCentral1="eu-central-1",l.EuWest1="eu-west-1",l.EuWest2="eu-west-2",l.EuWest3="eu-west-3",l.SaEast1="sa-east-1",l.UsEast1="us-east-1",l.UsWest1="us-west-1",l.UsWest2="us-west-2"})(sd||(sd={}));class uw{constructor(t,{headers:e={},customFetch:s,region:a=sd.Any}={}){this.url=t,this.headers=e,this.region=a,this.fetch=lw(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return ow(this,arguments,void 0,function*(e,s={}){var a;let r,c;try{const{headers:u,method:d,body:f,signal:p,timeout:y}=s;let v={},{region:b}=s;b||(b=this.region);const A=new URL(`${this.url}/${e}`);b&&b!=="any"&&(v["x-region"]=b,A.searchParams.set("forceFunctionRegion",b));let w;f&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(v["Content-Type"]="application/octet-stream",w=f):typeof f=="string"?(v["Content-Type"]="text/plain",w=f):typeof FormData<"u"&&f instanceof FormData?w=f:(v["Content-Type"]="application/json",w=JSON.stringify(f)):w=f;let E=p;y&&(c=new AbortController,r=setTimeout(()=>c.abort(),y),p?(E=c.signal,p.addEventListener("abort",()=>c.abort())):E=c.signal);const S=yield this.fetch(A.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},v),this.headers),u),body:w,signal:E}).catch(L=>{throw new cw(L)}),x=S.headers.get("x-relay-error");if(x&&x==="true")throw new cy(S);if(!S.ok)throw new uy(S);let C=((a=S.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),k;return C==="application/json"?k=yield S.json():C==="application/octet-stream"||C==="application/pdf"?k=yield S.blob():C==="text/event-stream"?k=S:C==="multipart/form-data"?k=yield S.formData():k=yield S.text(),{data:k,error:null,response:S}}catch(u){return{data:null,error:u,response:u instanceof uy||u instanceof cy?u.context:void 0}}finally{r&&clearTimeout(r)}})}}var hw=class extends Error{constructor(l){super(l.message),this.name="PostgrestError",this.details=l.details,this.hint=l.hint,this.code=l.code}},dw=class{constructor(l){var t,e;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(t=l.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=l.signal,this.isMaybeSingle=(e=l.isMaybeSingle)!==null&&e!==void 0?e:!1,l.fetch?this.fetch=l.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,t){return this.headers=new Headers(this.headers),this.headers.set(l,t),this}then(l,t){var e=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let a=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async r=>{let c=null,u=null,d=null,f=r.status,p=r.statusText;if(r.ok){var y,v;if(e.method!=="HEAD"){var b;const S=await r.text();S===""||(e.headers.get("Accept")==="text/csv"||e.headers.get("Accept")&&(!((b=e.headers.get("Accept"))===null||b===void 0)&&b.includes("application/vnd.pgrst.plan+text"))?u=S:u=JSON.parse(S))}const w=(y=e.headers.get("Prefer"))===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),E=(v=r.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");w&&E&&E.length>1&&(d=parseInt(E[1])),e.isMaybeSingle&&e.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,f=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var A;const w=await r.text();try{c=JSON.parse(w),Array.isArray(c)&&r.status===404&&(u=[],c=null,f=200,p="OK")}catch{r.status===404&&w===""?(f=204,p="No Content"):c={message:w}}if(c&&e.isMaybeSingle&&(!(c==null||(A=c.details)===null||A===void 0)&&A.includes("0 rows"))&&(c=null,f=200,p="OK"),c&&e.shouldThrowOnError)throw new hw(c)}return{error:c,data:u,count:d,status:f,statusText:p}});return this.shouldThrowOnError||(a=a.catch(r=>{var c;let u="";const d=r?.cause;if(d){var f,p,y,v;const A=(f=d?.message)!==null&&f!==void 0?f:"",w=(p=d?.code)!==null&&p!==void 0?p:"";u=`${(y=r?.name)!==null&&y!==void 0?y:"FetchError"}: ${r?.message}`,u+=`

Caused by: ${(v=d?.name)!==null&&v!==void 0?v:"Error"}: ${A}`,w&&(u+=` (${w})`),d?.stack&&(u+=`
${d.stack}`)}else{var b;u=(b=r?.stack)!==null&&b!==void 0?b:""}return{error:{message:`${(c=r?.name)!==null&&c!==void 0?c:"FetchError"}: ${r?.message}`,details:u,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(l,t)}returns(){return this}overrideTypes(){return this}},fw=class extends dw{select(l){let t=!1;const e=(l??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",e),this.headers.append("Prefer","return=representation"),this}order(l,{ascending:t=!0,nullsFirst:e,foreignTable:s,referencedTable:a=s}={}){const r=a?`${a}.order`:"order",c=this.url.searchParams.get(r);return this.url.searchParams.set(r,`${c?`${c},`:""}${l}.${t?"asc":"desc"}${e===void 0?"":e?".nullsfirst":".nullslast"}`),this}limit(l,{foreignTable:t,referencedTable:e=t}={}){const s=typeof e>"u"?"limit":`${e}.limit`;return this.url.searchParams.set(s,`${l}`),this}range(l,t,{foreignTable:e,referencedTable:s=e}={}){const a=typeof s>"u"?"offset":`${s}.offset`,r=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${l}`),this.url.searchParams.set(r,`${t-l+1}`),this}abortSignal(l){return this.signal=l,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:l=!1,verbose:t=!1,settings:e=!1,buffers:s=!1,wal:a=!1,format:r="text"}={}){var c;const u=[l?"analyze":null,t?"verbose":null,e?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),d=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${r}; for="${d}"; options=${u};`),r==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(l){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${l}`),this}};const hy=new RegExp("[,()]");var Sa=class extends fw{eq(l,t){return this.url.searchParams.append(l,`eq.${t}`),this}neq(l,t){return this.url.searchParams.append(l,`neq.${t}`),this}gt(l,t){return this.url.searchParams.append(l,`gt.${t}`),this}gte(l,t){return this.url.searchParams.append(l,`gte.${t}`),this}lt(l,t){return this.url.searchParams.append(l,`lt.${t}`),this}lte(l,t){return this.url.searchParams.append(l,`lte.${t}`),this}like(l,t){return this.url.searchParams.append(l,`like.${t}`),this}likeAllOf(l,t){return this.url.searchParams.append(l,`like(all).{${t.join(",")}}`),this}likeAnyOf(l,t){return this.url.searchParams.append(l,`like(any).{${t.join(",")}}`),this}ilike(l,t){return this.url.searchParams.append(l,`ilike.${t}`),this}ilikeAllOf(l,t){return this.url.searchParams.append(l,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(l,t){return this.url.searchParams.append(l,`ilike(any).{${t.join(",")}}`),this}regexMatch(l,t){return this.url.searchParams.append(l,`match.${t}`),this}regexIMatch(l,t){return this.url.searchParams.append(l,`imatch.${t}`),this}is(l,t){return this.url.searchParams.append(l,`is.${t}`),this}isDistinct(l,t){return this.url.searchParams.append(l,`isdistinct.${t}`),this}in(l,t){const e=Array.from(new Set(t)).map(s=>typeof s=="string"&&hy.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(l,`in.(${e})`),this}notIn(l,t){const e=Array.from(new Set(t)).map(s=>typeof s=="string"&&hy.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(l,`not.in.(${e})`),this}contains(l,t){return typeof t=="string"?this.url.searchParams.append(l,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(l,`cs.{${t.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(t)}`),this}containedBy(l,t){return typeof t=="string"?this.url.searchParams.append(l,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(l,`cd.{${t.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(t)}`),this}rangeGt(l,t){return this.url.searchParams.append(l,`sr.${t}`),this}rangeGte(l,t){return this.url.searchParams.append(l,`nxl.${t}`),this}rangeLt(l,t){return this.url.searchParams.append(l,`sl.${t}`),this}rangeLte(l,t){return this.url.searchParams.append(l,`nxr.${t}`),this}rangeAdjacent(l,t){return this.url.searchParams.append(l,`adj.${t}`),this}overlaps(l,t){return typeof t=="string"?this.url.searchParams.append(l,`ov.${t}`):this.url.searchParams.append(l,`ov.{${t.join(",")}}`),this}textSearch(l,t,{config:e,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const r=e===void 0?"":`(${e})`;return this.url.searchParams.append(l,`${a}fts${r}.${t}`),this}match(l){return Object.entries(l).forEach(([t,e])=>{this.url.searchParams.append(t,`eq.${e}`)}),this}not(l,t,e){return this.url.searchParams.append(l,`not.${t}.${e}`),this}or(l,{foreignTable:t,referencedTable:e=t}={}){const s=e?`${e}.or`:"or";return this.url.searchParams.append(s,`(${l})`),this}filter(l,t,e){return this.url.searchParams.append(l,`${t}.${e}`),this}},gw=class{constructor(l,{headers:t={},schema:e,fetch:s}){this.url=l,this.headers=new Headers(t),this.schema=e,this.fetch=s}select(l,t){const{head:e=!1,count:s}=t??{},a=e?"HEAD":"GET";let r=!1;const c=(l??"*").split("").map(u=>/\s/.test(u)&&!r?"":(u==='"'&&(r=!r),u)).join("");return this.url.searchParams.set("select",c),s&&this.headers.append("Prefer",`count=${s}`),new Sa({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(l,{count:t,defaultToNull:e=!0}={}){var s;const a="POST";if(t&&this.headers.append("Prefer",`count=${t}`),e||this.headers.append("Prefer","missing=default"),Array.isArray(l)){const r=l.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(r.length>0){const c=[...new Set(r)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Sa({method:a,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(l,{onConflict:t,ignoreDuplicates:e=!1,count:s,defaultToNull:a=!0}={}){var r;const c="POST";if(this.headers.append("Prefer",`resolution=${e?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(l)){const u=l.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(u.length>0){const d=[...new Set(u)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new Sa({method:c,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}update(l,{count:t}={}){var e;const s="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Sa({method:s,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}delete({count:l}={}){var t;const e="DELETE";return l&&this.headers.append("Prefer",`count=${l}`),new Sa({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},pw=class Ev{constructor(t,{headers:e={},schema:s,fetch:a}={}){this.url=t,this.headers=new Headers(e),this.schemaName=s,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new gw(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Ev(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,e={},{head:s=!1,get:a=!1,count:r}={}){var c;let u;const d=new URL(`${this.url}/rpc/${t}`);let f;s||a?(u=s?"HEAD":"GET",Object.entries(e).filter(([y,v])=>v!==void 0).map(([y,v])=>[y,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([y,v])=>{d.searchParams.append(y,v)})):(u="POST",f=e);const p=new Headers(this.headers);return r&&p.set("Prefer",`count=${r}`),new Sa({method:u,url:d,headers:p,schema:this.schemaName,body:f,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}};class mw{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const e=process.versions;if(e&&e.node){const s=e.node,a=parseInt(s.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let e=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(e+=`

Suggested solution: ${t.workaround}`),new Error(e)}static createWebSocket(t,e){const s=this.getWebSocketConstructor();return new s(t,e)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const yw="2.89.0",vw=`realtime-js/${yw}`,Tv="1.0.0",bw="2.0.0",dy=Tv,nd=1e4,_w=1e3,ww=100;var zs;(function(l){l[l.connecting=0]="connecting",l[l.open=1]="open",l[l.closing=2]="closing",l[l.closed=3]="closed"})(zs||(zs={}));var ye;(function(l){l.closed="closed",l.errored="errored",l.joined="joined",l.joining="joining",l.leaving="leaving"})(ye||(ye={}));var Mi;(function(l){l.close="phx_close",l.error="phx_error",l.join="phx_join",l.reply="phx_reply",l.leave="phx_leave",l.access_token="access_token"})(Mi||(Mi={}));var ad;(function(l){l.websocket="websocket"})(ad||(ad={}));var bn;(function(l){l.Connecting="connecting",l.Open="open",l.Closing="closing",l.Closed="closed"})(bn||(bn={}));class Aw{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,e){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return e(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return e(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(t){var e;return this._isArrayBuffer((e=t.payload)===null||e===void 0?void 0:e.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var e,s;const a=(s=(e=t.payload)===null||e===void 0?void 0:e.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var e,s;const a=(s=(e=t.payload)===null||e===void 0?void 0:e.payload)!==null&&s!==void 0?s:{},c=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(t,e,s){var a,r;const c=t.topic,u=(a=t.ref)!==null&&a!==void 0?a:"",d=(r=t.join_ref)!==null&&r!==void 0?r:"",f=t.payload.event,p=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},y=Object.keys(p).length===0?"":JSON.stringify(p);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`userEvent length ${f.length} exceeds maximum of 255`);if(y.length>255)throw new Error(`metadata length ${y.length} exceeds maximum of 255`);const v=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+u.length+c.length+f.length+y.length,b=new ArrayBuffer(this.HEADER_LENGTH+v);let A=new DataView(b),w=0;A.setUint8(w++,this.KINDS.userBroadcastPush),A.setUint8(w++,d.length),A.setUint8(w++,u.length),A.setUint8(w++,c.length),A.setUint8(w++,f.length),A.setUint8(w++,y.length),A.setUint8(w++,e),Array.from(d,S=>A.setUint8(w++,S.charCodeAt(0))),Array.from(u,S=>A.setUint8(w++,S.charCodeAt(0))),Array.from(c,S=>A.setUint8(w++,S.charCodeAt(0))),Array.from(f,S=>A.setUint8(w++,S.charCodeAt(0))),Array.from(y,S=>A.setUint8(w++,S.charCodeAt(0)));var E=new Uint8Array(b.byteLength+s.byteLength);return E.set(new Uint8Array(b),0),E.set(new Uint8Array(s),b.byteLength),E.buffer}decode(t,e){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return e(s)}if(typeof t=="string"){const s=JSON.parse(t),[a,r,c,u,d]=s;return e({join_ref:a,ref:r,topic:c,event:u,payload:d})}return e({})}_binaryDecode(t){const e=new DataView(t),s=e.getUint8(0),a=new TextDecoder;if(s===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,e,a)}_decodeUserBroadcast(t,e,s){const a=e.getUint8(1),r=e.getUint8(2),c=e.getUint8(3),u=e.getUint8(4);let d=this.HEADER_LENGTH+4;const f=s.decode(t.slice(d,d+a));d=d+a;const p=s.decode(t.slice(d,d+r));d=d+r;const y=s.decode(t.slice(d,d+c));d=d+c;const v=t.slice(d,t.byteLength),b=u===this.JSON_ENCODING?JSON.parse(s.decode(v)):v,A={type:this.BROADCAST_EVENT,event:p,payload:b};return c>0&&(A.meta=JSON.parse(y)),{join_ref:null,ref:null,topic:f,event:this.BROADCAST_EVENT,payload:A}}_isArrayBuffer(t){var e;return t instanceof ArrayBuffer||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="ArrayBuffer"}_pick(t,e){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([s])=>e.includes(s)))}}class Cv{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Vt;(function(l){l.abstime="abstime",l.bool="bool",l.date="date",l.daterange="daterange",l.float4="float4",l.float8="float8",l.int2="int2",l.int4="int4",l.int4range="int4range",l.int8="int8",l.int8range="int8range",l.json="json",l.jsonb="jsonb",l.money="money",l.numeric="numeric",l.oid="oid",l.reltime="reltime",l.text="text",l.time="time",l.timestamp="timestamp",l.timestamptz="timestamptz",l.timetz="timetz",l.tsrange="tsrange",l.tstzrange="tstzrange"})(Vt||(Vt={}));const fy=(l,t,e={})=>{var s;const a=(s=e.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((r,c)=>(r[c]=Sw(c,l,t,a),r),{}):{}},Sw=(l,t,e,s)=>{const a=t.find(u=>u.name===l),r=a?.type,c=e[l];return r&&!s.includes(r)?xv(r,c):rd(c)},xv=(l,t)=>{if(l.charAt(0)==="_"){const e=l.slice(1,l.length);return xw(t,e)}switch(l){case Vt.bool:return Ew(t);case Vt.float4:case Vt.float8:case Vt.int2:case Vt.int4:case Vt.int8:case Vt.numeric:case Vt.oid:return Tw(t);case Vt.json:case Vt.jsonb:return Cw(t);case Vt.timestamp:return Rw(t);case Vt.abstime:case Vt.date:case Vt.daterange:case Vt.int4range:case Vt.int8range:case Vt.money:case Vt.reltime:case Vt.text:case Vt.time:case Vt.timestamptz:case Vt.timetz:case Vt.tsrange:case Vt.tstzrange:return rd(t);default:return rd(t)}},rd=l=>l,Ew=l=>{switch(l){case"t":return!0;case"f":return!1;default:return l}},Tw=l=>{if(typeof l=="string"){const t=parseFloat(l);if(!Number.isNaN(t))return t}return l},Cw=l=>{if(typeof l=="string")try{return JSON.parse(l)}catch{return l}return l},xw=(l,t)=>{if(typeof l!="string")return l;const e=l.length-1,s=l[e];if(l[0]==="{"&&s==="}"){let r;const c=l.slice(1,e);try{r=JSON.parse("["+c+"]")}catch{r=c?c.split(","):[]}return r.map(u=>xv(t,u))}return l},Rw=l=>typeof l=="string"?l.replace(" ","T"):l,Rv=l=>{const t=new URL(l);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Uh{constructor(t,e,s={},a=nd){this.channel=t,this.event=e,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var s;return this._hasReceived(t)&&e((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var gy;(function(l){l.SYNC="sync",l.JOIN="join",l.LEAVE="leave"})(gy||(gy={}));class Gr{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:r,onLeave:c,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Gr.syncState(this.state,a,r,c),this.pendingDiffs.forEach(d=>{this.state=Gr.syncDiff(this.state,d,r,c)}),this.pendingDiffs=[],u()}),this.channel._on(s.diff,{},a=>{const{onJoin:r,onLeave:c,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Gr.syncDiff(this.state,a,r,c),u())}),this.onJoin((a,r,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:r,newPresences:c})}),this.onLeave((a,r,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:r,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,s,a){const r=this.cloneDeep(t),c=this.transformState(e),u={},d={};return this.map(r,(f,p)=>{c[f]||(d[f]=p)}),this.map(c,(f,p)=>{const y=r[f];if(y){const v=p.map(E=>E.presence_ref),b=y.map(E=>E.presence_ref),A=p.filter(E=>b.indexOf(E.presence_ref)<0),w=y.filter(E=>v.indexOf(E.presence_ref)<0);A.length>0&&(u[f]=A),w.length>0&&(d[f]=w)}else u[f]=p}),this.syncDiff(r,{joins:u,leaves:d},s,a)}static syncDiff(t,e,s,a){const{joins:r,leaves:c}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(r,(u,d)=>{var f;const p=(f=t[u])!==null&&f!==void 0?f:[];if(t[u]=this.cloneDeep(d),p.length>0){const y=t[u].map(b=>b.presence_ref),v=p.filter(b=>y.indexOf(b.presence_ref)<0);t[u].unshift(...v)}s(u,p,d)}),this.map(c,(u,d)=>{let f=t[u];if(!f)return;const p=d.map(y=>y.presence_ref);f=f.filter(y=>p.indexOf(y.presence_ref)<0),t[u]=f,a(u,f,d),f.length===0&&delete t[u]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(s=>e(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,s)=>{const a=t[s];return"metas"in a?e[s]=a.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):e[s]=a,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var py;(function(l){l.ALL="*",l.INSERT="INSERT",l.UPDATE="UPDATE",l.DELETE="DELETE"})(py||(py={}));var qr;(function(l){l.BROADCAST="broadcast",l.PRESENCE="presence",l.POSTGRES_CHANGES="postgres_changes",l.SYSTEM="system"})(qr||(qr={}));var us;(function(l){l.SUBSCRIBED="SUBSCRIBED",l.TIMED_OUT="TIMED_OUT",l.CLOSED="CLOSED",l.CHANNEL_ERROR="CHANNEL_ERROR"})(us||(us={}));class Oa{constructor(t,e={config:{}},s){var a,r;if(this.topic=t,this.params=e,this.socket=s,this.bindings={},this.state=ye.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new Uh(this,Mi.join,this.params,this.timeout),this.rejoinTimer=new Cv(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ye.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ye.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=ye.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ye.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=ye.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Mi.reply,{},(c,u)=>{this._trigger(this._replyEventName(u),c)}),this.presence=new Gr(this),this.broadcastEndpointURL=Rv(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((r=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||r===void 0)&&r.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,e=this.timeout){var s,a,r;if(this.socket.isConnected()||this.socket.connect(),this.state==ye.closed){const{config:{broadcast:c,presence:u,private:d}}=this.params,f=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(b=>b.filter))!==null&&a!==void 0?a:[],p=!!this.bindings[qr.PRESENCE]&&this.bindings[qr.PRESENCE].length>0||((r=this.params.config.presence)===null||r===void 0?void 0:r.enabled)===!0,y={},v={broadcast:c,presence:Object.assign(Object.assign({},u),{enabled:p}),postgres_changes:f,private:d};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this._onError(b=>t?.(us.CHANNEL_ERROR,b)),this._onClose(()=>t?.(us.CLOSED)),this.updateJoinPayload(Object.assign({config:v},y)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:b})=>{var A;if(this.socket._isManualToken()||this.socket.setAuth(),b===void 0){t?.(us.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,E=(A=w?.length)!==null&&A!==void 0?A:0,S=[];for(let x=0;x<E;x++){const C=w[x],{filter:{event:k,schema:L,table:R,filter:D}}=C,z=b&&b[x];if(z&&z.event===k&&Oa.isFilterValueEqual(z.schema,L)&&Oa.isFilterValueEqual(z.table,R)&&Oa.isFilterValueEqual(z.filter,D))S.push(Object.assign(Object.assign({},C),{id:z.id}));else{this.unsubscribe(),this.state=ye.errored,t?.(us.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,t&&t(us.SUBSCRIBED);return}}).receive("error",b=>{this.state=ye.errored,t?.(us.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{t?.(us.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,e={}){return await this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,e,s){return this.state===ye.joined&&t===qr.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,e,s)}async httpSend(t,e,s={}){var a;if(e==null)return Promise.reject("Payload is required for httpSend()");const r={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(r.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:r,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:e,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=s.timeout)!==null&&a!==void 0?a:this.timeout);if(u.status===202)return{success:!0};let d=u.statusText;try{const f=await u.json();d=f.error||f.message||d}catch{}return Promise.reject(new Error(d))}async send(t,e={}){var s,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:r,payload:c}=t,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:c,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(s=e.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(r=>{var c,u,d;const f=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(u=(c=this.params)===null||c===void 0?void 0:c.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.ack)&&r("ok"),f.receive("ok",()=>r("ok")),f.receive("error",()=>r("error")),f.receive("timeout",()=>r("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ye.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Mi.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new Uh(this,Mi.leave,{},t),s.receive("ok",()=>{e(),a("ok")}).receive("timeout",()=>{e(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ye.closed,this.bindings={}}async _fetchWithTimeout(t,e,s){const a=new AbortController,r=setTimeout(()=>a.abort(),s),c=await this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:a.signal}));return clearTimeout(r),c}_push(t,e,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Uh(this,t,e,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>ww){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(t,e,s){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,s){var a,r;const c=t.toLocaleLowerCase(),{close:u,error:d,leave:f,join:p}=Mi;if(s&&[u,d,f,p].indexOf(c)>=0&&s!==this._joinRef())return;let v=this._onMessage(c,e,s);if(e&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(b=>{var A,w,E;return((A=b.filter)===null||A===void 0?void 0:A.event)==="*"||((E=(w=b.filter)===null||w===void 0?void 0:w.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===c}).map(b=>b.callback(v,s)):(r=this.bindings[c])===null||r===void 0||r.filter(b=>{var A,w,E,S,x,C;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in b){const k=b.id,L=(A=b.filter)===null||A===void 0?void 0:A.event;return k&&((w=e.ids)===null||w===void 0?void 0:w.includes(k))&&(L==="*"||L?.toLocaleLowerCase()===((E=e.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const k=(x=(S=b?.filter)===null||S===void 0?void 0:S.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return k==="*"||k===((C=e?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===c}).map(b=>{if(typeof v=="object"&&"ids"in v){const A=v.data,{schema:w,table:E,commit_timestamp:S,type:x,errors:C}=A;v=Object.assign(Object.assign({},{schema:w,table:E,commit_timestamp:S,eventType:x,new:{},old:{},errors:C}),this._getPayloadRecords(A))}b.callback(v,s)})}_isClosed(){return this.state===ye.closed}_isJoined(){return this.state===ye.joined}_isJoining(){return this.state===ye.joining}_isLeaving(){return this.state===ye.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,s){const a=t.toLocaleLowerCase(),r={type:a,filter:e,callback:s};return this.bindings[a]?this.bindings[a].push(r):this.bindings[a]=[r],this}_off(t,e){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var r;return!(((r=a.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===s&&Oa.isEqual(a.filter,e))})),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const s in t)if(t[s]!==e[s])return!1;return!0}static isFilterValueEqual(t,e){return(t??void 0)===(e??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Mi.close,{},t)}_onError(t){this._on(Mi.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ye.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=fy(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=fy(t.columns,t.old_record)),e}}const jh=()=>{},Ll={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ow=[1e3,2e3,5e3,1e4],kw=1e4,Dw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Mw{constructor(t,e){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=nd,this.transport=null,this.heartbeatIntervalMs=Ll.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=jh,this.ref=0,this.reconnectTimer=null,this.vsn=dy,this.logger=jh,this.conn=null,this.sendBuffer=[],this.serializer=new Aw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...r)=>a(...r):(...r)=>fetch(...r),!(!((s=e?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${t}/${ad.websocket}`,this.httpEndpoint=Rv(t),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(e?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=mw.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const e=t.message;throw e.includes("Node.js")?new Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,e??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const e=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const t=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,e,s){this.logger(t,e,s)}connectionState(){switch(this.conn&&this.conn.readyState){case zs.connecting:return bn.Connecting;case zs.open:return bn.Open;case zs.closing:return bn.Closing;default:return bn.Closed}}isConnected(){return this.connectionState()===bn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,e={config:{}}){const s=`realtime:${t}`,a=this.getChannels().find(r=>r.topic===s);if(a)return a;{const r=new Oa(`realtime:${t}`,e,this);return this.channels.push(r),r}}push(t){const{topic:e,event:s,payload:a,ref:r}=t,c=()=>{this.encode(t,u=>{var d;(d=this.conn)===null||d===void 0||d.send(u)})};this.log("push",`${e} ${s} (${r})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(_w,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout()},Ll.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,e=>{if(e.topic==="phoenix"&&e.event==="phx_reply")try{this.heartbeatCallback(e.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:a,payload:r,ref:c}=e,u=c?`(${c})`:"",d=r.status||"";this.log("receive",`${d} ${s} ${a} ${u}`.trim(),r),this.channels.filter(f=>f._isMember(s)).forEach(f=>f._trigger(a,r,c)),this._triggerStateCallbacks("message",e)})}_clearTimer(t){var e;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((e=this.reconnectTimer)===null||e===void 0||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===zs.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===zs.open||this.conn.readyState===zs.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var e;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Mi.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;const s=t.match(/\?/)?"&":"?",a=new URLSearchParams(e);return`${t}${s}${a}`}_workerObjectUrl(t){let e;if(t)e=t;else{const s=new Blob([Dw],{type:"application/javascript"});e=URL.createObjectURL(s)}return e}_setConnectionState(t,e=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=e)}async _performAuth(t=null){let e,s=!1;if(t)e=t,s=!0;else if(this.accessToken)try{e=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),e=this.accessTokenValue}else e=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(a=>{const r={access_token:e,version:vw};e&&a.updateJoinPayload(r),a.joinedOnce&&a._isJoined()&&a._push(Mi.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(e=>{this.log("error",`Error setting auth in ${t}`,e)})}_triggerStateCallbacks(t,e){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(e)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Cv(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ll.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var e,s,a,r,c,u,d,f,p,y,v,b;switch(this.transport=(e=t?.transport)!==null&&e!==void 0?e:null,this.timeout=(s=t?.timeout)!==null&&s!==void 0?s:nd,this.heartbeatIntervalMs=(a=t?.heartbeatIntervalMs)!==null&&a!==void 0?a:Ll.HEARTBEAT_INTERVAL,this.worker=(r=t?.worker)!==null&&r!==void 0?r:!1,this.accessToken=(c=t?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:jh,this.vsn=(d=t?.vsn)!==null&&d!==void 0?d:dy,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=t?.reconnectAfterMs)!==null&&f!==void 0?f:(A=>Ow[A-1]||kw),this.vsn){case Tv:this.encode=(p=t?.encode)!==null&&p!==void 0?p:((A,w)=>w(JSON.stringify(A))),this.decode=(y=t?.decode)!==null&&y!==void 0?y:((A,w)=>w(JSON.parse(A)));break;case bw:this.encode=(v=t?.encode)!==null&&v!==void 0?v:this.serializer.encode.bind(this.serializer),this.decode=(b=t?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var Xr=class extends Error{constructor(l,t){super(l),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Nw(l,t,e){const s=new URL(t,l);if(e)for(const[a,r]of Object.entries(e))r!==void 0&&s.searchParams.set(a,r);return s.toString()}async function Lw(l){return!l||l.type==="none"?{}:l.type==="bearer"?{Authorization:`Bearer ${l.token}`}:l.type==="header"?{[l.name]:l.value}:l.type==="custom"?await l.getHeaders():{}}function Bw(l){const t=l.fetchImpl??globalThis.fetch;return{async request({method:e,path:s,query:a,body:r,headers:c}){const u=Nw(l.baseUrl,s,a),d=await Lw(l.auth),f=await t(u,{method:e,headers:{...r?{"Content-Type":"application/json"}:{},...d,...c},body:r?JSON.stringify(r):void 0}),p=await f.text(),y=(f.headers.get("content-type")||"").includes("application/json"),v=y&&p?JSON.parse(p):p;if(!f.ok){const b=y?v:void 0,A=b?.error;throw new Xr(A?.message??`Request failed with status ${f.status}`,{status:f.status,icebergType:A?.type,icebergCode:A?.code,details:b})}return{status:f.status,headers:f.headers,data:v}}}}function Bl(l){return l.join("")}var Pw=class{constructor(l,t=""){this.client=l,this.prefix=t}async listNamespaces(l){const t=l?{parent:Bl(l.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(l,t){const e={namespace:l.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:e})).data}async dropNamespace(l){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Bl(l.namespace)}`})}async loadNamespaceMetadata(l){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Bl(l.namespace)}`})).data.properties}}async namespaceExists(l){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Bl(l.namespace)}`}),!0}catch(t){if(t instanceof Xr&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(l,t){try{return await this.createNamespace(l,t)}catch(e){if(e instanceof Xr&&e.status===409)return;throw e}}};function pa(l){return l.join("")}var Iw=class{constructor(l,t="",e){this.client=l,this.prefix=t,this.accessDelegation=e}async listTables(l){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${pa(l.namespace)}/tables`})).data.identifiers}async createTable(l,t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${pa(l.namespace)}/tables`,body:t,headers:e})).data.metadata}async updateTable(l,t){const e=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${pa(l.namespace)}/tables/${l.name}`,body:t});return{"metadata-location":e.data["metadata-location"],metadata:e.data.metadata}}async dropTable(l,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${pa(l.namespace)}/tables/${l.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(l){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${pa(l.namespace)}/tables/${l.name}`,headers:t})).data.metadata}async tableExists(l){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${pa(l.namespace)}/tables/${l.name}`,headers:t}),!0}catch(e){if(e instanceof Xr&&e.status===404)return!1;throw e}}async createTableIfNotExists(l,t){try{return await this.createTable(l,t)}catch(e){if(e instanceof Xr&&e.status===409)return await this.loadTable({namespace:l.namespace,name:t.name});throw e}}},Uw=class{constructor(l){let t="v1";l.catalogName&&(t+=`/${l.catalogName}`);const e=l.baseUrl.endsWith("/")?l.baseUrl:`${l.baseUrl}/`;this.client=Bw({baseUrl:e,auth:l.auth,fetchImpl:l.fetch}),this.accessDelegation=l.accessDelegation?.join(","),this.namespaceOps=new Pw(this.client,t),this.tableOps=new Iw(this.client,t,this.accessDelegation)}async listNamespaces(l){return this.namespaceOps.listNamespaces(l)}async createNamespace(l,t){return this.namespaceOps.createNamespace(l,t)}async dropNamespace(l){await this.namespaceOps.dropNamespace(l)}async loadNamespaceMetadata(l){return this.namespaceOps.loadNamespaceMetadata(l)}async listTables(l){return this.tableOps.listTables(l)}async createTable(l,t){return this.tableOps.createTable(l,t)}async updateTable(l,t){return this.tableOps.updateTable(l,t)}async dropTable(l,t){await this.tableOps.dropTable(l,t)}async loadTable(l){return this.tableOps.loadTable(l)}async namespaceExists(l){return this.namespaceOps.namespaceExists(l)}async tableExists(l){return this.tableOps.tableExists(l)}async createNamespaceIfNotExists(l,t){return this.namespaceOps.createNamespaceIfNotExists(l,t)}async createTableIfNotExists(l,t){return this.tableOps.createTableIfNotExists(l,t)}},ac=class extends Error{constructor(l){super(l),this.__isStorageError=!0,this.name="StorageError"}};function Zt(l){return typeof l=="object"&&l!==null&&"__isStorageError"in l}var jw=class extends ac{constructor(l,t,e){super(l),this.name="StorageApiError",this.status=t,this.statusCode=e}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},od=class extends ac{constructor(l,t){super(l),this.name="StorageUnknownError",this.originalError=t}};const kd=l=>l?(...t)=>l(...t):(...t)=>fetch(...t),zw=()=>Response,ld=l=>{if(Array.isArray(l))return l.map(e=>ld(e));if(typeof l=="function"||l!==Object(l))return l;const t={};return Object.entries(l).forEach(([e,s])=>{const a=e.replace(/([-_][a-z])/gi,r=>r.toUpperCase().replace(/[-_]/g,""));t[a]=ld(s)}),t},Fw=l=>{if(typeof l!="object"||l===null)return!1;const t=Object.getPrototypeOf(l);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in l)&&!(Symbol.iterator in l)},Hw=l=>!l||typeof l!="string"||l.length===0||l.length>100||l.trim()!==l||l.includes("/")||l.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(l);function Kr(l){"@babel/helpers - typeof";return Kr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kr(l)}function $w(l,t){if(Kr(l)!="object"||!l)return l;var e=l[Symbol.toPrimitive];if(e!==void 0){var s=e.call(l,t);if(Kr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(l)}function Gw(l){var t=$w(l,"string");return Kr(t)=="symbol"?t:t+""}function qw(l,t,e){return(t=Gw(t))in l?Object.defineProperty(l,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):l[t]=e,l}function my(l,t){var e=Object.keys(l);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(l);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(l,a).enumerable})),e.push.apply(e,s)}return e}function ht(l){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?my(Object(e),!0).forEach(function(s){qw(l,s,e[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(e)):my(Object(e)).forEach(function(s){Object.defineProperty(l,s,Object.getOwnPropertyDescriptor(e,s))})}return l}const zh=l=>{var t;return l.msg||l.message||l.error_description||(typeof l.error=="string"?l.error:(t=l.error)===null||t===void 0?void 0:t.message)||JSON.stringify(l)},Vw=async(l,t,e)=>{l instanceof await zw()&&!e?.noResolveJson?l.json().then(s=>{const a=l.status||500,r=s?.statusCode||a+"";t(new jw(zh(s),a,r))}).catch(s=>{t(new od(zh(s),s))}):t(new od(zh(l),l))},Yw=(l,t,e,s)=>{const a={method:l,headers:t?.headers||{}};return l==="GET"||!s?a:(Fw(s)?(a.headers=ht({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(s)):a.body=s,t?.duplex&&(a.duplex=t.duplex),ht(ht({},a),e))};async function oo(l,t,e,s,a,r){return new Promise((c,u)=>{l(e,Yw(t,s,a,r)).then(d=>{if(!d.ok)throw d;return s?.noResolveJson?d:d.json()}).then(d=>c(d)).catch(d=>Vw(d,u,s))})}async function Wr(l,t,e,s){return oo(l,"GET",t,e,s)}async function ki(l,t,e,s,a){return oo(l,"POST",t,s,a,e)}async function cd(l,t,e,s,a){return oo(l,"PUT",t,s,a,e)}async function Xw(l,t,e,s){return oo(l,"HEAD",t,ht(ht({},e),{},{noResolveJson:!0}),s)}async function Dd(l,t,e,s,a){return oo(l,"DELETE",t,s,a,e)}var Kw=class{constructor(l,t){this.downloadFn=l,this.shouldThrowOnError=t}then(l,t){return this.execute().then(l,t)}async execute(){var l=this;try{return{data:(await l.downloadFn()).body,error:null}}catch(t){if(l.shouldThrowOnError)throw t;if(Zt(t))return{data:null,error:t};throw t}}};let Ov;Ov=Symbol.toStringTag;var Ww=class{constructor(l,t){this.downloadFn=l,this.shouldThrowOnError=t,this[Ov]="BlobDownloadBuilder",this.promise=null}asStream(){return new Kw(this.downloadFn,this.shouldThrowOnError)}then(l,t){return this.getPromise().then(l,t)}catch(l){return this.getPromise().catch(l)}finally(l){return this.getPromise().finally(l)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var l=this;try{return{data:await(await l.downloadFn()).blob(),error:null}}catch(t){if(l.shouldThrowOnError)throw t;if(Zt(t))return{data:null,error:t};throw t}}};const Qw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},yy={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Jw=class{constructor(l,t={},e,s){this.shouldThrowOnError=!1,this.url=l,this.headers=t,this.bucketId=e,this.fetch=kd(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(l,t,e,s){var a=this;try{let r;const c=ht(ht({},yy),s);let u=ht(ht({},a.headers),l==="POST"&&{"x-upsert":String(c.upsert)});const d=c.metadata;typeof Blob<"u"&&e instanceof Blob?(r=new FormData,r.append("cacheControl",c.cacheControl),d&&r.append("metadata",a.encodeMetadata(d)),r.append("",e)):typeof FormData<"u"&&e instanceof FormData?(r=e,r.has("cacheControl")||r.append("cacheControl",c.cacheControl),d&&!r.has("metadata")&&r.append("metadata",a.encodeMetadata(d))):(r=e,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType,d&&(u["x-metadata"]=a.toBase64(a.encodeMetadata(d))),(typeof ReadableStream<"u"&&r instanceof ReadableStream||r&&typeof r=="object"&&"pipe"in r&&typeof r.pipe=="function")&&!c.duplex&&(c.duplex="half")),s?.headers&&(u=ht(ht({},u),s.headers));const f=a._removeEmptyFolders(t),p=a._getFinalPath(f),y=await(l=="PUT"?cd:ki)(a.fetch,`${a.url}/object/${p}`,r,ht({headers:u},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:f,id:y.Id,fullPath:y.Key},error:null}}catch(r){if(a.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}}async upload(l,t,e){return this.uploadOrUpdate("POST",l,t,e)}async uploadToSignedUrl(l,t,e,s){var a=this;const r=a._removeEmptyFolders(l),c=a._getFinalPath(r),u=new URL(a.url+`/object/upload/sign/${c}`);u.searchParams.set("token",t);try{let d;const f=ht({upsert:yy.upsert},s),p=ht(ht({},a.headers),{"x-upsert":String(f.upsert)});return typeof Blob<"u"&&e instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",e)):typeof FormData<"u"&&e instanceof FormData?(d=e,d.append("cacheControl",f.cacheControl)):(d=e,p["cache-control"]=`max-age=${f.cacheControl}`,p["content-type"]=f.contentType),{data:{path:r,fullPath:(await cd(a.fetch,u.toString(),d,{headers:p})).Key},error:null}}catch(d){if(a.shouldThrowOnError)throw d;if(Zt(d))return{data:null,error:d};throw d}}async createSignedUploadUrl(l,t){var e=this;try{let s=e._getFinalPath(l);const a=ht({},e.headers);t?.upsert&&(a["x-upsert"]="true");const r=await ki(e.fetch,`${e.url}/object/upload/sign/${s}`,{},{headers:a}),c=new URL(e.url+r.url),u=c.searchParams.get("token");if(!u)throw new ac("No token returned by API");return{data:{signedUrl:c.toString(),path:l,token:u},error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Zt(s))return{data:null,error:s};throw s}}async update(l,t,e){return this.uploadOrUpdate("PUT",l,t,e)}async move(l,t,e){var s=this;try{return{data:await ki(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:l,destinationKey:t,destinationBucket:e?.destinationBucket},{headers:s.headers}),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Zt(a))return{data:null,error:a};throw a}}async copy(l,t,e){var s=this;try{return{data:{path:(await ki(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:l,destinationKey:t,destinationBucket:e?.destinationBucket},{headers:s.headers})).Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Zt(a))return{data:null,error:a};throw a}}async createSignedUrl(l,t,e){var s=this;try{let a=s._getFinalPath(l),r=await ki(s.fetch,`${s.url}/object/sign/${a}`,ht({expiresIn:t},e?.transform?{transform:e.transform}:{}),{headers:s.headers});const c=e?.download?`&download=${e.download===!0?"":e.download}`:"";return r={signedUrl:encodeURI(`${s.url}${r.signedURL}${c}`)},{data:r,error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Zt(a))return{data:null,error:a};throw a}}async createSignedUrls(l,t,e){var s=this;try{const a=await ki(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:t,paths:l},{headers:s.headers}),r=e?.download?`&download=${e.download===!0?"":e.download}`:"";return{data:a.map(c=>ht(ht({},c),{},{signedUrl:c.signedURL?encodeURI(`${s.url}${c.signedURL}${r}`):null})),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Zt(a))return{data:null,error:a};throw a}}download(l,t){const e=typeof t?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(t?.transform||{}),a=s?`?${s}`:"",r=this._getFinalPath(l),c=()=>Wr(this.fetch,`${this.url}/${e}/${r}${a}`,{headers:this.headers,noResolveJson:!0});return new Ww(c,this.shouldThrowOnError)}async info(l){var t=this;const e=t._getFinalPath(l);try{return{data:ld(await Wr(t.fetch,`${t.url}/object/info/${e}`,{headers:t.headers})),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Zt(s))return{data:null,error:s};throw s}}async exists(l){var t=this;const e=t._getFinalPath(l);try{return await Xw(t.fetch,`${t.url}/object/${e}`,{headers:t.headers}),{data:!0,error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Zt(s)&&s instanceof od){const a=s.originalError;if([400,404].includes(a?.status))return{data:!1,error:s}}throw s}}getPublicUrl(l,t){const e=this._getFinalPath(l),s=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&s.push(a);const r=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${r}/public/${e}${u}`)}}}async remove(l){var t=this;try{return{data:await Dd(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:l},{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Zt(e))return{data:null,error:e};throw e}}async list(l,t,e){var s=this;try{const a=ht(ht(ht({},Qw),t),{},{prefix:l||""});return{data:await ki(s.fetch,`${s.url}/object/list/${s.bucketId}`,a,{headers:s.headers},e),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Zt(a))return{data:null,error:a};throw a}}async listV2(l,t){var e=this;try{const s=ht({},l);return{data:await ki(e.fetch,`${e.url}/object/list-v2/${e.bucketId}`,s,{headers:e.headers},t),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Zt(s))return{data:null,error:s};throw s}}encodeMetadata(l){return JSON.stringify(l)}toBase64(l){return typeof Buffer<"u"?Buffer.from(l).toString("base64"):btoa(l)}_getFinalPath(l){return`${this.bucketId}/${l.replace(/^\/+/,"")}`}_removeEmptyFolders(l){return l.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(l){const t=[];return l.width&&t.push(`width=${l.width}`),l.height&&t.push(`height=${l.height}`),l.resize&&t.push(`resize=${l.resize}`),l.format&&t.push(`format=${l.format}`),l.quality&&t.push(`quality=${l.quality}`),t.join("&")}};const kv="2.89.0",Dv={"X-Client-Info":`storage-js/${kv}`};var Zw=class{constructor(l,t={},e,s){this.shouldThrowOnError=!1;const a=new URL(l);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=ht(ht({},Dv),t),this.fetch=kd(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(l){var t=this;try{const e=t.listBucketOptionsToQueryString(l);return{data:await Wr(t.fetch,`${t.url}/bucket${e}`,{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Zt(e))return{data:null,error:e};throw e}}async getBucket(l){var t=this;try{return{data:await Wr(t.fetch,`${t.url}/bucket/${l}`,{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Zt(e))return{data:null,error:e};throw e}}async createBucket(l,t={public:!1}){var e=this;try{return{data:await ki(e.fetch,`${e.url}/bucket`,{id:l,name:l,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Zt(s))return{data:null,error:s};throw s}}async updateBucket(l,t){var e=this;try{return{data:await cd(e.fetch,`${e.url}/bucket/${l}`,{id:l,name:l,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Zt(s))return{data:null,error:s};throw s}}async emptyBucket(l){var t=this;try{return{data:await ki(t.fetch,`${t.url}/bucket/${l}/empty`,{},{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Zt(e))return{data:null,error:e};throw e}}async deleteBucket(l){var t=this;try{return{data:await Dd(t.fetch,`${t.url}/bucket/${l}`,{},{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Zt(e))return{data:null,error:e};throw e}}listBucketOptionsToQueryString(l){const t={};return l&&("limit"in l&&(t.limit=String(l.limit)),"offset"in l&&(t.offset=String(l.offset)),l.search&&(t.search=l.search),l.sortColumn&&(t.sortColumn=l.sortColumn),l.sortOrder&&(t.sortOrder=l.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},tA=class{constructor(l,t={},e){this.shouldThrowOnError=!1,this.url=l.replace(/\/$/,""),this.headers=ht(ht({},Dv),t),this.fetch=kd(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(l){var t=this;try{return{data:await ki(t.fetch,`${t.url}/bucket`,{name:l},{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Zt(e))return{data:null,error:e};throw e}}async listBuckets(l){var t=this;try{const e=new URLSearchParams;l?.limit!==void 0&&e.set("limit",l.limit.toString()),l?.offset!==void 0&&e.set("offset",l.offset.toString()),l?.sortColumn&&e.set("sortColumn",l.sortColumn),l?.sortOrder&&e.set("sortOrder",l.sortOrder),l?.search&&e.set("search",l.search);const s=e.toString(),a=s?`${t.url}/bucket?${s}`:`${t.url}/bucket`;return{data:await Wr(t.fetch,a,{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Zt(e))return{data:null,error:e};throw e}}async deleteBucket(l){var t=this;try{return{data:await Dd(t.fetch,`${t.url}/bucket/${l}`,{},{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Zt(e))return{data:null,error:e};throw e}}from(l){var t=this;if(!Hw(l))throw new ac("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const e=new Uw({baseUrl:this.url,catalogName:l,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(e,{get(a,r){const c=a[r];return typeof c!="function"?c:async(...u)=>{try{return{data:await c.apply(a,u),error:null}}catch(d){if(s)throw d;return{data:null,error:d}}}}})}};const Md={"X-Client-Info":`storage-js/${kv}`,"Content-Type":"application/json"};var Mv=class extends Error{constructor(l){super(l),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function ui(l){return typeof l=="object"&&l!==null&&"__isStorageVectorsError"in l}var Fh=class extends Mv{constructor(l,t,e){super(l),this.name="StorageVectorsApiError",this.status=t,this.statusCode=e}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},eA=class extends Mv{constructor(l,t){super(l),this.name="StorageVectorsUnknownError",this.originalError=t}};const Nd=l=>l?(...t)=>l(...t):(...t)=>fetch(...t),iA=l=>{if(typeof l!="object"||l===null)return!1;const t=Object.getPrototypeOf(l);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in l)&&!(Symbol.iterator in l)},vy=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),sA=async(l,t,e)=>{if(l&&typeof l=="object"&&"status"in l&&"ok"in l&&typeof l.status=="number"&&!e?.noResolveJson){const s=l.status||500,a=l;if(typeof a.json=="function")a.json().then(r=>{const c=r?.statusCode||r?.code||s+"";t(new Fh(vy(r),s,c))}).catch(()=>{const r=s+"";t(new Fh(a.statusText||`HTTP ${s} error`,s,r))});else{const r=s+"";t(new Fh(a.statusText||`HTTP ${s} error`,s,r))}}else t(new eA(vy(l),l))},nA=(l,t,e,s)=>{const a={method:l,headers:t?.headers||{}};return s?(iA(s)?(a.headers=ht({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(s)):a.body=s,ht(ht({},a),e)):a};async function aA(l,t,e,s,a,r){return new Promise((c,u)=>{l(e,nA(t,s,a,r)).then(d=>{if(!d.ok)throw d;if(s?.noResolveJson)return d;const f=d.headers.get("content-type");return!f||!f.includes("application/json")?{}:d.json()}).then(d=>c(d)).catch(d=>sA(d,u,s))})}async function hi(l,t,e,s,a){return aA(l,"POST",t,s,a,e)}var rA=class{constructor(l,t={},e){this.shouldThrowOnError=!1,this.url=l.replace(/\/$/,""),this.headers=ht(ht({},Md),t),this.fetch=Nd(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(l){var t=this;try{return{data:await hi(t.fetch,`${t.url}/CreateIndex`,l,{headers:t.headers})||{},error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ui(e))return{data:null,error:e};throw e}}async getIndex(l,t){var e=this;try{return{data:await hi(e.fetch,`${e.url}/GetIndex`,{vectorBucketName:l,indexName:t},{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(ui(s))return{data:null,error:s};throw s}}async listIndexes(l){var t=this;try{return{data:await hi(t.fetch,`${t.url}/ListIndexes`,l,{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ui(e))return{data:null,error:e};throw e}}async deleteIndex(l,t){var e=this;try{return{data:await hi(e.fetch,`${e.url}/DeleteIndex`,{vectorBucketName:l,indexName:t},{headers:e.headers})||{},error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(ui(s))return{data:null,error:s};throw s}}},oA=class{constructor(l,t={},e){this.shouldThrowOnError=!1,this.url=l.replace(/\/$/,""),this.headers=ht(ht({},Md),t),this.fetch=Nd(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(l){var t=this;try{if(l.vectors.length<1||l.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await hi(t.fetch,`${t.url}/PutVectors`,l,{headers:t.headers})||{},error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ui(e))return{data:null,error:e};throw e}}async getVectors(l){var t=this;try{return{data:await hi(t.fetch,`${t.url}/GetVectors`,l,{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ui(e))return{data:null,error:e};throw e}}async listVectors(l){var t=this;try{if(l.segmentCount!==void 0){if(l.segmentCount<1||l.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(l.segmentIndex!==void 0&&(l.segmentIndex<0||l.segmentIndex>=l.segmentCount))throw new Error(`segmentIndex must be between 0 and ${l.segmentCount-1}`)}return{data:await hi(t.fetch,`${t.url}/ListVectors`,l,{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ui(e))return{data:null,error:e};throw e}}async queryVectors(l){var t=this;try{return{data:await hi(t.fetch,`${t.url}/QueryVectors`,l,{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ui(e))return{data:null,error:e};throw e}}async deleteVectors(l){var t=this;try{if(l.keys.length<1||l.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await hi(t.fetch,`${t.url}/DeleteVectors`,l,{headers:t.headers})||{},error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ui(e))return{data:null,error:e};throw e}}},lA=class{constructor(l,t={},e){this.shouldThrowOnError=!1,this.url=l.replace(/\/$/,""),this.headers=ht(ht({},Md),t),this.fetch=Nd(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(l){var t=this;try{return{data:await hi(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:l},{headers:t.headers})||{},error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ui(e))return{data:null,error:e};throw e}}async getBucket(l){var t=this;try{return{data:await hi(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:l},{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ui(e))return{data:null,error:e};throw e}}async listBuckets(l={}){var t=this;try{return{data:await hi(t.fetch,`${t.url}/ListVectorBuckets`,l,{headers:t.headers}),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ui(e))return{data:null,error:e};throw e}}async deleteBucket(l){var t=this;try{return{data:await hi(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:l},{headers:t.headers})||{},error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ui(e))return{data:null,error:e};throw e}}},cA=class extends lA{constructor(l,t={}){super(l,t.headers||{},t.fetch)}from(l){return new uA(this.url,this.headers,l,this.fetch)}async createBucket(l){var t=()=>super.createBucket,e=this;return t().call(e,l)}async getBucket(l){var t=()=>super.getBucket,e=this;return t().call(e,l)}async listBuckets(l={}){var t=()=>super.listBuckets,e=this;return t().call(e,l)}async deleteBucket(l){var t=()=>super.deleteBucket,e=this;return t().call(e,l)}},uA=class extends rA{constructor(l,t,e,s){super(l,t,s),this.vectorBucketName=e}async createIndex(l){var t=()=>super.createIndex,e=this;return t().call(e,ht(ht({},l),{},{vectorBucketName:e.vectorBucketName}))}async listIndexes(l={}){var t=()=>super.listIndexes,e=this;return t().call(e,ht(ht({},l),{},{vectorBucketName:e.vectorBucketName}))}async getIndex(l){var t=()=>super.getIndex,e=this;return t().call(e,e.vectorBucketName,l)}async deleteIndex(l){var t=()=>super.deleteIndex,e=this;return t().call(e,e.vectorBucketName,l)}index(l){return new hA(this.url,this.headers,this.vectorBucketName,l,this.fetch)}},hA=class extends oA{constructor(l,t,e,s,a){super(l,t,a),this.vectorBucketName=e,this.indexName=s}async putVectors(l){var t=()=>super.putVectors,e=this;return t().call(e,ht(ht({},l),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async getVectors(l){var t=()=>super.getVectors,e=this;return t().call(e,ht(ht({},l),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async listVectors(l={}){var t=()=>super.listVectors,e=this;return t().call(e,ht(ht({},l),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async queryVectors(l){var t=()=>super.queryVectors,e=this;return t().call(e,ht(ht({},l),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async deleteVectors(l){var t=()=>super.deleteVectors,e=this;return t().call(e,ht(ht({},l),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}},dA=class extends Zw{constructor(l,t={},e,s){super(l,t,e,s)}from(l){return new Jw(this.url,this.headers,l,this.fetch)}get vectors(){return new cA(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new tA(this.url+"/iceberg",this.headers,this.fetch)}};const Nv="2.89.0",Ea=30*1e3,ud=3,Hh=ud*Ea,fA="http://localhost:9999",gA="supabase.auth.token",pA={"X-Client-Info":`gotrue-js/${Nv}`},hd="X-Supabase-Api-Version",Lv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},mA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,yA=600*1e3;class Qr extends Error{constructor(t,e,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=s}}function nt(l){return typeof l=="object"&&l!==null&&"__isAuthError"in l}class vA extends Qr{constructor(t,e,s){super(t,e,s),this.name="AuthApiError",this.status=e,this.code=s}}function bA(l){return nt(l)&&l.name==="AuthApiError"}class _n extends Qr{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class fs extends Qr{constructor(t,e,s,a){super(t,s,a),this.name=e,this.status=s}}class oi extends fs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function _A(l){return nt(l)&&l.name==="AuthSessionMissingError"}class ma extends fs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Pl extends fs{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Il extends fs{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function wA(l){return nt(l)&&l.name==="AuthImplicitGrantRedirectError"}class by extends fs{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AA extends fs{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class dd extends fs{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}}function $h(l){return nt(l)&&l.name==="AuthRetryableFetchError"}class _y extends fs{constructor(t,e,s){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=s}}class fd extends fs{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ql="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),wy=` 	
\r=`.split(""),SA=(()=>{const l=new Array(128);for(let t=0;t<l.length;t+=1)l[t]=-1;for(let t=0;t<wy.length;t+=1)l[wy[t].charCodeAt(0)]=-2;for(let t=0;t<Ql.length;t+=1)l[Ql[t].charCodeAt(0)]=t;return l})();function Ay(l,t,e){if(l!==null)for(t.queue=t.queue<<8|l,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;e(Ql[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;e(Ql[s]),t.queuedBits-=6}}function Bv(l,t,e){const s=SA[l];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)e(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(l)}"`)}}function Sy(l){const t=[],e=c=>{t.push(String.fromCodePoint(c))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},r=c=>{CA(c,s,e)};for(let c=0;c<l.length;c+=1)Bv(l.charCodeAt(c),a,r);return t.join("")}function EA(l,t){if(l<=127){t(l);return}else if(l<=2047){t(192|l>>6),t(128|l&63);return}else if(l<=65535){t(224|l>>12),t(128|l>>6&63),t(128|l&63);return}else if(l<=1114111){t(240|l>>18),t(128|l>>12&63),t(128|l>>6&63),t(128|l&63);return}throw new Error(`Unrecognized Unicode codepoint: ${l.toString(16)}`)}function TA(l,t){for(let e=0;e<l.length;e+=1){let s=l.charCodeAt(e);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(l.charCodeAt(e+1)-56320&65535|a)+65536,e+=1}EA(s,t)}}function CA(l,t,e){if(t.utf8seq===0){if(l<=127){e(l);return}for(let s=1;s<6;s+=1)if((l>>7-s&1)===0){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=l&31;else if(t.utf8seq===3)t.codepoint=l&15;else if(t.utf8seq===4)t.codepoint=l&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(l<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|l&63,t.utf8seq-=1,t.utf8seq===0&&e(t.codepoint)}}function Na(l){const t=[],e={queue:0,queuedBits:0},s=a=>{t.push(a)};for(let a=0;a<l.length;a+=1)Bv(l.charCodeAt(a),e,s);return new Uint8Array(t)}function xA(l){const t=[];return TA(l,e=>t.push(e)),new Uint8Array(t)}function wn(l){const t=[],e={queue:0,queuedBits:0},s=a=>{t.push(a)};return l.forEach(a=>Ay(a,e,s)),Ay(null,e,s),t.join("")}function RA(l){return Math.round(Date.now()/1e3)+l}function OA(){return Symbol("auth-callback")}const Oe=()=>typeof window<"u"&&typeof document<"u",mn={tested:!1,writable:!1},Pv=()=>{if(!Oe())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(mn.tested)return mn.writable;const l=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(l,l),globalThis.localStorage.removeItem(l),mn.tested=!0,mn.writable=!0}catch{mn.tested=!0,mn.writable=!1}return mn.writable};function kA(l){const t={},e=new URL(l);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((a,r)=>{t[r]=a})}catch{}return e.searchParams.forEach((s,a)=>{t[a]=s}),t}const Iv=l=>l?(...t)=>l(...t):(...t)=>fetch(...t),DA=l=>typeof l=="object"&&l!==null&&"status"in l&&"ok"in l&&"json"in l&&typeof l.json=="function",Ta=async(l,t,e)=>{await l.setItem(t,JSON.stringify(e))},yn=async(l,t)=>{const e=await l.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}},xe=async(l,t)=>{await l.removeItem(t)};class rc{constructor(){this.promise=new rc.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}rc.promiseConstructor=Promise;function Gh(l){const t=l.split(".");if(t.length!==3)throw new fd("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!mA.test(t[s]))throw new fd("JWT not in base64url format");return{header:JSON.parse(Sy(t[0])),payload:JSON.parse(Sy(t[1])),signature:Na(t[2]),raw:{header:t[0],payload:t[1]}}}async function MA(l){return await new Promise(t=>{setTimeout(()=>t(null),l)})}function NA(l,t){return new Promise((s,a)=>{(async()=>{for(let r=0;r<1/0;r++)try{const c=await l(r);if(!t(r,null,c)){s(c);return}}catch(c){if(!t(r,c)){a(c);return}}})()})}function LA(l){return("0"+l.toString(16)).substr(-2)}function BA(){const t=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=e.length;let a="";for(let r=0;r<56;r++)a+=e.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(t),Array.from(t,LA).join("")}async function PA(l){const e=new TextEncoder().encode(l),s=await crypto.subtle.digest("SHA-256",e),a=new Uint8Array(s);return Array.from(a).map(r=>String.fromCharCode(r)).join("")}async function IA(l){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),l;const e=await PA(l);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ya(l,t,e=!1){const s=BA();let a=s;e&&(a+="/PASSWORD_RECOVERY"),await Ta(l,`${t}-code-verifier`,a);const r=await IA(s);return[r,s===r?"plain":"s256"]}const UA=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function jA(l){const t=l.headers.get(hd);if(!t||!t.match(UA))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function zA(l){if(!l)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(l<=t)throw new Error("JWT has expired")}function FA(l){switch(l){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const HA=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function va(l){if(!HA.test(l))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function qh(){const l={};return new Proxy(l,{get:(t,e)=>{if(e==="__isUserNotAvailableProxy")return!0;if(typeof e=="symbol"){const s=e.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function $A(l,t){return new Proxy(l,{get:(e,s,a)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const r=s.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)"||r==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(e,s,a)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(e,s,a)}})}function Ey(l){return JSON.parse(JSON.stringify(l))}const vn=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),GA=[502,503,504];async function Ty(l){var t;if(!DA(l))throw new dd(vn(l),0);if(GA.includes(l.status))throw new dd(vn(l),l.status);let e;try{e=await l.json()}catch(r){throw new _n(vn(r),r)}let s;const a=jA(l);if(a&&a.getTime()>=Lv["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?s=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(s=e.error_code),s){if(s==="weak_password")throw new _y(vn(e),l.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new oi}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((r,c)=>r&&typeof c=="string",!0))throw new _y(vn(e),l.status,e.weak_password.reasons);throw new vA(vn(e),l.status||500,s)}const qA=(l,t,e,s)=>{const a={method:l,headers:t?.headers||{}};return l==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),e))};async function ut(l,t,e,s){var a;const r=Object.assign({},s?.headers);r[hd]||(r[hd]=Lv["2024-01-01"].name),s?.jwt&&(r.Authorization=`Bearer ${s.jwt}`);const c=(a=s?.query)!==null&&a!==void 0?a:{};s?.redirectTo&&(c.redirect_to=s.redirectTo);const u=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",d=await VA(l,t,e+u,{headers:r,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(d):{data:Object.assign({},d),error:null}}async function VA(l,t,e,s,a,r){const c=qA(t,s,a,r);let u;try{u=await l(e,Object.assign({},c))}catch(d){throw console.error(d),new dd(vn(d),0)}if(u.ok||await Ty(u),s?.noResolveJson)return u;try{return await u.json()}catch(d){await Ty(d)}}function Oi(l){var t;let e=null;KA(l)&&(e=Object.assign({},l),l.expires_at||(e.expires_at=RA(l.expires_in)));const s=(t=l.user)!==null&&t!==void 0?t:l;return{data:{session:e,user:s},error:null}}function Cy(l){const t=Oi(l);return!t.error&&l.weak_password&&typeof l.weak_password=="object"&&Array.isArray(l.weak_password.reasons)&&l.weak_password.reasons.length&&l.weak_password.message&&typeof l.weak_password.message=="string"&&l.weak_password.reasons.reduce((e,s)=>e&&typeof s=="string",!0)&&(t.data.weak_password=l.weak_password),t}function Hs(l){var t;return{data:{user:(t=l.user)!==null&&t!==void 0?t:l},error:null}}function YA(l){return{data:l,error:null}}function XA(l){const{action_link:t,email_otp:e,hashed_token:s,redirect_to:a,verification_type:r}=l,c=nc(l,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:e,hashed_token:s,redirect_to:a,verification_type:r},d=Object.assign({},c);return{data:{properties:u,user:d},error:null}}function xy(l){return l}function KA(l){return l.access_token&&l.refresh_token&&l.expires_in}const Vh=["global","local","others"];class WA{constructor({url:t="",headers:e={},fetch:s}){this.url=t,this.headers=e,this.fetch=Iv(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,e=Vh[0]){if(Vh.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Vh.join(", ")}`);try{return await ut(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(nt(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,e={}){try{return await ut(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Hs})}catch(s){if(nt(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:e}=t,s=nc(t,["options"]),a=Object.assign(Object.assign({},s),e);return"newEmail"in s&&(a.new_email=s?.newEmail,delete a.newEmail),await ut(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:XA,redirectTo:e?.redirectTo})}catch(e){if(nt(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(t){try{return await ut(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Hs})}catch(e){if(nt(e))return{data:{user:null},error:e};throw e}}async listUsers(t){var e,s,a,r,c,u,d;try{const f={nextPage:null,lastPage:0,total:0},p=await ut(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&s!==void 0?s:"",per_page:(r=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&r!==void 0?r:""},xform:xy});if(p.error)throw p.error;const y=await p.json(),v=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,b=(d=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return b.length>0&&(b.forEach(A=>{const w=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(A.split(";")[1].split("=")[1]);f[`${E}Page`]=w}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},y),f),error:null}}catch(f){if(nt(f))return{data:{users:[]},error:f};throw f}}async getUserById(t){va(t);try{return await ut(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Hs})}catch(e){if(nt(e))return{data:{user:null},error:e};throw e}}async updateUserById(t,e){va(t);try{return await ut(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:Hs})}catch(s){if(nt(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,e=!1){va(t);try{return await ut(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:Hs})}catch(s){if(nt(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){va(t.userId);try{const{data:e,error:s}=await ut(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:e,error:s}}catch(e){if(nt(e))return{data:null,error:e};throw e}}async _deleteFactor(t){va(t.userId),va(t.id);try{return{data:await ut(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(nt(e))return{data:null,error:e};throw e}}async _listOAuthClients(t){var e,s,a,r,c,u,d;try{const f={nextPage:null,lastPage:0,total:0},p=await ut(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&s!==void 0?s:"",per_page:(r=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&r!==void 0?r:""},xform:xy});if(p.error)throw p.error;const y=await p.json(),v=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,b=(d=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return b.length>0&&(b.forEach(A=>{const w=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(A.split(";")[1].split("=")[1]);f[`${E}Page`]=w}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},y),f),error:null}}catch(f){if(nt(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(t){try{return await ut(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(nt(e))return{data:null,error:e};throw e}}async _getOAuthClient(t){try{return await ut(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(nt(e))return{data:null,error:e};throw e}}async _updateOAuthClient(t,e){try{return await ut(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:e,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(nt(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await ut(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(nt(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(t){try{return await ut(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(nt(e))return{data:null,error:e};throw e}}}function Ry(l={}){return{getItem:t=>l[t]||null,setItem:(t,e)=>{l[t]=e},removeItem:t=>{delete l[t]}}}const ba={debug:!!(globalThis&&Pv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Uv extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class QA extends Uv{}async function JA(l,t,e){ba.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",l,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),ba.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",l)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(l,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){ba.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",l,a.name);try{return await e()}finally{ba.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",l,a.name)}}else{if(t===0)throw ba.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",l),new QA(`Acquiring an exclusive Navigator LockManager lock "${l}" immediately failed`);if(ba.debug)try{const r=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(r,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}function ZA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function jv(l){if(!/^0x[a-fA-F0-9]{40}$/.test(l))throw new Error(`@supabase/auth-js: Address "${l}" is invalid.`);return l.toLowerCase()}function tS(l){return parseInt(l,16)}function eS(l){const t=new TextEncoder().encode(l);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function iS(l){var t;const{chainId:e,domain:s,expirationTime:a,issuedAt:r=new Date,nonce:c,notBefore:u,requestId:d,resources:f,scheme:p,uri:y,version:v}=l;{if(!Number.isInteger(e))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${e}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!y)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((t=l.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${l.statement}`)}const b=jv(l.address),A=p?`${p}://${s}`:s,w=l.statement?`${l.statement}
`:"",E=`${A} wants you to sign in with your Ethereum account:
${b}

${w}`;let S=`URI: ${y}
Version: ${v}
Chain ID: ${e}${c?`
Nonce: ${c}`:""}
Issued At: ${r.toISOString()}`;if(a&&(S+=`
Expiration Time: ${a.toISOString()}`),u&&(S+=`
Not Before: ${u.toISOString()}`),d&&(S+=`
Request ID: ${d}`),f){let x=`
Resources:`;for(const C of f){if(!C||typeof C!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${C}`);x+=`
- ${C}`}S+=x}return`${E}
${S}`}class pe extends Error{constructor({message:t,code:e,cause:s,name:a}){var r;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(r=a??(s instanceof Error?s.name:void 0))!==null&&r!==void 0?r:"Unknown Error",this.code=e}}class Jl extends pe{constructor(t,e){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e,message:t}),this.name="WebAuthnUnknownError",this.originalError=e}}function sS({error:l,options:t}){var e,s,a;const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(l.name==="AbortError"){if(t.signal instanceof AbortSignal)return new pe({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:l})}else if(l.name==="ConstraintError"){if(((e=r.authenticatorSelection)===null||e===void 0?void 0:e.requireResidentKey)===!0)return new pe({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:l});if(t.mediation==="conditional"&&((s=r.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new pe({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:l});if(((a=r.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new pe({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:l})}else{if(l.name==="InvalidStateError")return new pe({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:l});if(l.name==="NotAllowedError")return new pe({message:l.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l});if(l.name==="NotSupportedError")return r.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new pe({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:l}):new pe({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:l});if(l.name==="SecurityError"){const c=window.location.hostname;if(zv(c)){if(r.rp.id!==c)return new pe({message:`The RP ID "${r.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:l})}else return new pe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:l})}else if(l.name==="TypeError"){if(r.user.id.byteLength<1||r.user.id.byteLength>64)return new pe({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:l})}else if(l.name==="UnknownError")return new pe({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:l})}return new pe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l})}function nS({error:l,options:t}){const{publicKey:e}=t;if(!e)throw Error("options was missing required publicKey property");if(l.name==="AbortError"){if(t.signal instanceof AbortSignal)return new pe({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:l})}else{if(l.name==="NotAllowedError")return new pe({message:l.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l});if(l.name==="SecurityError"){const s=window.location.hostname;if(zv(s)){if(e.rpId!==s)return new pe({message:`The RP ID "${e.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:l})}else return new pe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:l})}else if(l.name==="UnknownError")return new pe({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:l})}return new pe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l})}class aS{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const rS=new aS;function oS(l){if(!l)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(l);const{challenge:t,user:e,excludeCredentials:s}=l,a=nc(l,["challenge","user","excludeCredentials"]),r=Na(t).buffer,c=Object.assign(Object.assign({},e),{id:Na(e.id).buffer}),u=Object.assign(Object.assign({},a),{challenge:r,user:c});if(s&&s.length>0){u.excludeCredentials=new Array(s.length);for(let d=0;d<s.length;d++){const f=s[d];u.excludeCredentials[d]=Object.assign(Object.assign({},f),{id:Na(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return u}function lS(l){if(!l)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(l);const{challenge:t,allowCredentials:e}=l,s=nc(l,["challenge","allowCredentials"]),a=Na(t).buffer,r=Object.assign(Object.assign({},s),{challenge:a});if(e&&e.length>0){r.allowCredentials=new Array(e.length);for(let c=0;c<e.length;c++){const u=e[c];r.allowCredentials[c]=Object.assign(Object.assign({},u),{id:Na(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return r}function cS(l){var t;if("toJSON"in l&&typeof l.toJSON=="function")return l.toJSON();const e=l;return{id:l.id,rawId:l.id,response:{attestationObject:wn(new Uint8Array(l.response.attestationObject)),clientDataJSON:wn(new Uint8Array(l.response.clientDataJSON))},type:"public-key",clientExtensionResults:l.getClientExtensionResults(),authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function uS(l){var t;if("toJSON"in l&&typeof l.toJSON=="function")return l.toJSON();const e=l,s=l.getClientExtensionResults(),a=l.response;return{id:l.id,rawId:l.id,response:{authenticatorData:wn(new Uint8Array(a.authenticatorData)),clientDataJSON:wn(new Uint8Array(a.clientDataJSON)),signature:wn(new Uint8Array(a.signature)),userHandle:a.userHandle?wn(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function zv(l){return l==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(l)}function Oy(){var l,t;return!!(Oe()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((l=navigator?.credentials)===null||l===void 0?void 0:l.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function hS(l){try{const t=await navigator.credentials.create(l);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Jl("Browser returned unexpected credential type",t)}:{data:null,error:new Jl("Empty credential response",t)}}catch(t){return{data:null,error:sS({error:t,options:l})}}}async function dS(l){try{const t=await navigator.credentials.get(l);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Jl("Browser returned unexpected credential type",t)}:{data:null,error:new Jl("Empty credential response",t)}}catch(t){return{data:null,error:nS({error:t,options:l})}}}const fS={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},gS={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Zl(...l){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),e=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),s={};for(const a of l)if(a)for(const r in a){const c=a[r];if(c!==void 0)if(Array.isArray(c))s[r]=c;else if(e(c))s[r]=c;else if(t(c)){const u=s[r];t(u)?s[r]=Zl(u,c):s[r]=Zl(c)}else s[r]=c}return s}function pS(l,t){return Zl(fS,l,t||{})}function mS(l,t){return Zl(gS,l,t||{})}class yS{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:e,friendlyName:s,signal:a},r){try{const{data:c,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:e});if(!c)return{data:null,error:u};const d=a??rS.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:f}=c.webauthn.credential_options.publicKey;f.name||(f.name=`${f.id}:${s}`),f.displayName||(f.displayName=f.name)}switch(c.webauthn.type){case"create":{const f=pS(c.webauthn.credential_options.publicKey,r?.create),{data:p,error:y}=await hS({publicKey:f,signal:d});return p?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:p}},error:null}:{data:null,error:y}}case"request":{const f=mS(c.webauthn.credential_options.publicKey,r?.request),{data:p,error:y}=await dS(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:f,signal:d}));return p?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:p}},error:null}:{data:null,error:y}}}}catch(c){return nt(c)?{data:null,error:c}:{data:null,error:new _n("Unexpected error in challenge",c)}}}async _verify({challengeId:t,factorId:e,webauthn:s}){return this.client.mfa.verify({factorId:e,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},r){if(!e)return{data:null,error:new Qr("rpId is required for WebAuthn authentication")};try{if(!Oy())return{data:null,error:new _n("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this.challenge({factorId:t,webauthn:{rpId:e,rpOrigins:s},signal:a},{request:r});if(!c)return{data:null,error:u};const{webauthn:d}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:d.type,rpId:e,rpOrigins:s,credential_response:d.credential_response}})}catch(c){return nt(c)?{data:null,error:c}:{data:null,error:new _n("Unexpected error in authenticate",c)}}}async _register({friendlyName:t,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},r){if(!e)return{data:null,error:new Qr("rpId is required for WebAuthn registration")};try{if(!Oy())return{data:null,error:new _n("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(p=>{var y;return(y=p.data)===null||y===void 0?void 0:y.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===t&&v.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p?.id}):void 0),{data:null,error:u};const{data:d,error:f}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:e,rpOrigins:s},signal:a},{create:r});return d?this._verify({factorId:c.id,challengeId:d.challengeId,webauthn:{rpId:e,rpOrigins:s,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:f}}catch(c){return nt(c)?{data:null,error:c}:{data:null,error:new _n("Unexpected error in register",c)}}}}ZA();const vS={url:fA,storageKey:gA,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:pA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function ky(l,t,e){return await e()}const _a={};class Jr{get jwks(){var t,e;return(e=(t=_a[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&e!==void 0?e:{keys:[]}}set jwks(t){_a[this.storageKey]=Object.assign(Object.assign({},_a[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,e;return(e=(t=_a[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){_a[this.storageKey]=Object.assign(Object.assign({},_a[this.storageKey]),{cachedAt:t})}constructor(t){var e,s,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const r=Object.assign(Object.assign({},vS),t);if(this.storageKey=r.storageKey,this.instanceID=(e=Jr.nextInstanceID[this.storageKey])!==null&&e!==void 0?e:0,Jr.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.instanceID>0&&Oe()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=r.persistSession,this.autoRefreshToken=r.autoRefreshToken,this.admin=new WA({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Iv(r.fetch),this.lock=r.lock||ky,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,this.throwOnError=r.throwOnError,r.lock?this.lock=r.lock:this.persistSession&&Oe()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=JA:this.lock=ky,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new yS(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:Pv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ry(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=Ry(this.memoryStorage)),Oe()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Nv}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let e={},s="none";if(Oe()&&(e=kA(window.location.href),this._isImplicitGrantCallback(e)?s="implicit":await this._isPKCECallback(e)&&(s="pkce")),Oe()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:r}=await this._getSessionFromURL(e,s);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),wA(r)){const d=(t=r.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:r}}return await this._removeSession(),{error:r}}const{session:c,redirectType:u}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",u),await this._saveSession(c),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return nt(e)?this._returnResult({error:e}):this._returnResult({error:new _n("Unexpected error during initialization",e)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var e,s,a;try{const r=await ut(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(e=t?.options)===null||e===void 0?void 0:e.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=t?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Oi}),{data:c,error:u}=r;if(u||!c)return this._returnResult({data:{user:null,session:null},error:u});const d=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(r){if(nt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signUp(t){var e,s,a;try{let r;if("email"in t){const{email:p,password:y,options:v}=t;let b=null,A=null;this.flowType==="pkce"&&([b,A]=await ya(this.storage,this.storageKey)),r=await ut(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:p,password:y,data:(e=v?.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:b,code_challenge_method:A},xform:Oi})}else if("phone"in t){const{phone:p,password:y,options:v}=t;r=await ut(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:y,data:(s=v?.data)!==null&&s!==void 0?s:{},channel:(a=v?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:Oi})}else throw new Pl("You must provide either an email or phone number and a password");const{data:c,error:u}=r;if(u||!c)return await xe(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const d=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(r){if(await xe(this.storage,`${this.storageKey}-code-verifier`),nt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithPassword(t){try{let e;if("email"in t){const{email:r,password:c,options:u}=t;e=await ut(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Cy})}else if("phone"in t){const{phone:r,password:c,options:u}=t;e=await ut(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Cy})}else throw new Pl("You must provide either an email or phone number and a password");const{data:s,error:a}=e;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!s||!s.session||!s.user){const r=new ma;return this._returnResult({data:{user:null,session:null},error:r})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(e){if(nt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOAuth(t){var e,s,a,r;return await this._handleProviderSignIn(t.provider,{redirectTo:(e=t.options)===null||e===void 0?void 0:e.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(r=t.options)===null||r===void 0?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:e}=t;switch(e){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${e}"`)}}async signInWithEthereum(t){var e,s,a,r,c,u,d,f,p,y,v;let b,A;if("message"in t)b=t.message,A=t.signature;else{const{chain:w,wallet:E,statement:S,options:x}=t;let C;if(Oe())if(typeof E=="object")C=E;else{const Y=window;if("ethereum"in Y&&typeof Y.ethereum=="object"&&"request"in Y.ethereum&&typeof Y.ethereum.request=="function")C=Y.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!x?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=E}const k=new URL((e=x?.url)!==null&&e!==void 0?e:window.location.href),L=await C.request({method:"eth_requestAccounts"}).then(Y=>Y).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!L||L.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const R=jv(L[0]);let D=(s=x?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!D){const Y=await C.request({method:"eth_chainId"});D=tS(Y)}const z={domain:k.host,address:R,statement:S,uri:k.href,version:"1",chainId:D,nonce:(a=x?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(c=(r=x?.signInWithEthereum)===null||r===void 0?void 0:r.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(u=x?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(d=x?.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(f=x?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(p=x?.signInWithEthereum)===null||p===void 0?void 0:p.resources};b=iS(z),A=await C.request({method:"personal_sign",params:[eS(b),R]})}try{const{data:w,error:E}=await ut(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:A},!((y=t.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Oi});if(E)throw E;if(!w||!w.session||!w.user){const S=new ma;return this._returnResult({data:{user:null,session:null},error:S})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:E})}catch(w){if(nt(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(t){var e,s,a,r,c,u,d,f,p,y,v,b;let A,w;if("message"in t)A=t.message,w=t.signature;else{const{chain:E,wallet:S,statement:x,options:C}=t;let k;if(Oe())if(typeof S=="object")k=S;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))k=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=S}const L=new URL((e=C?.url)!==null&&e!==void 0?e:window.location.href);if("signIn"in k&&k.signIn){const R=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:L.host,uri:L.href}),x?{statement:x}:null));let D;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")D=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)D=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)A=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),w=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");A=[`${L.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${L.href}`,`Issued At: ${(a=(s=C?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((r=C?.signInWithSolana)===null||r===void 0)&&r.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((c=C?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((u=C?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((d=C?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((f=C?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((y=(p=C?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||y===void 0)&&y.length?["Resources",...C.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const R=await k.signMessage(new TextEncoder().encode(A),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=R}}try{const{data:E,error:S}=await ut(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:A,signature:wn(w)},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Oi});if(S)throw S;if(!E||!E.session||!E.user){const x=new ma;return this._returnResult({data:{user:null,session:null},error:x})}return E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),this._returnResult({data:Object.assign({},E),error:S})}catch(E){if(nt(E))return this._returnResult({data:{user:null,session:null},error:E});throw E}}async _exchangeCodeForSession(t){const e=await yn(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(e??"").split("/");try{if(!s&&this.flowType==="pkce")throw new AA;const{data:r,error:c}=await ut(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:Oi});if(await xe(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!r||!r.session||!r.user){const u=new ma;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign(Object.assign({},r),{redirectType:a??null}),error:c})}catch(r){if(await xe(this.storage,`${this.storageKey}-code-verifier`),nt(r))return this._returnResult({data:{user:null,session:null,redirectType:null},error:r});throw r}}async signInWithIdToken(t){try{const{options:e,provider:s,token:a,access_token:r,nonce:c}=t,u=await ut(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:r,nonce:c,gotrue_meta_security:{captcha_token:e?.captchaToken}},xform:Oi}),{data:d,error:f}=u;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!d||!d.session||!d.user){const p=new ma;return this._returnResult({data:{user:null,session:null},error:p})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:f})}catch(e){if(nt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOtp(t){var e,s,a,r,c;try{if("email"in t){const{email:u,options:d}=t;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await ya(this.storage,this.storageKey));const{error:y}=await ut(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(e=d?.data)!==null&&e!==void 0?e:{},create_user:(s=d?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:p},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:y})}if("phone"in t){const{phone:u,options:d}=t,{data:f,error:p}=await ut(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(a=d?.data)!==null&&a!==void 0?a:{},create_user:(r=d?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(c=d?.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:p})}throw new Pl("You must provide either an email or phone number.")}catch(u){if(await xe(this.storage,`${this.storageKey}-code-verifier`),nt(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var e,s;try{let a,r;"options"in t&&(a=(e=t.options)===null||e===void 0?void 0:e.redirectTo,r=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:c,error:u}=await ut(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:r}}),redirectTo:a,xform:Oi});if(u)throw u;if(!c)throw new Error("An error occurred on token verification.");const d=c.session,f=c.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(a){if(nt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var e,s,a,r,c;try{let u=null,d=null;this.flowType==="pkce"&&([u,d]=await ya(this.storage,this.storageKey));const f=await ut(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(e=t.options)===null||e===void 0?void 0:e.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=t?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:d}),headers:this.headers,xform:YA});return!((r=f.data)===null||r===void 0)&&r.url&&Oe()&&!(!((c=t.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(f.data.url),this._returnResult(f)}catch(u){if(await xe(this.storage,`${this.storageKey}-code-verifier`),nt(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:e},error:s}=t;if(s)throw s;if(!e)throw new oi;const{error:a}=await ut(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(nt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const e=`${this.url}/resend`;if("email"in t){const{email:s,type:a,options:r}=t,{error:c}=await ut(this.fetch,"POST",e,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:r?.captchaToken}},redirectTo:r?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in t){const{phone:s,type:a,options:r}=t,{data:c,error:u}=await ut(this.fetch,"POST",e,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:r?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:u})}throw new Pl("You must provide either an email or phone number and a type")}catch(e){if(nt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(t,e){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await e()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=e();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await t(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const e=await yn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?t=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<Hh:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const c=await yn(this.userStorage,this.storageKey+"-user");c?.user?t.user=c.user:t.user=qh()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};t.user=$A(t.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:r}=await this._callRefreshToken(t.refresh_token);return r?this._returnResult({data:{session:null},error:r}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const e=await this._acquireLock(-1,async()=>await this._getUser());return e.data.user&&(this.suppressGetSessionWarning=!0),e}async _getUser(t){try{return t?await ut(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Hs}):await this._useSession(async e=>{var s,a,r;const{data:c,error:u}=e;if(u)throw u;return!(!((s=c.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new oi}:await ut(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&r!==void 0?r:void 0,xform:Hs})})}catch(e){if(nt(e))return _A(e)&&(await this._removeSession(),await xe(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:e});throw e}}async updateUser(t,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,e))}async _updateUser(t,e={}){try{return await this._useSession(async s=>{const{data:a,error:r}=s;if(r)throw r;if(!a.session)throw new oi;const c=a.session;let u=null,d=null;this.flowType==="pkce"&&t.email!=null&&([u,d]=await ya(this.storage,this.storageKey));const{data:f,error:p}=await ut(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:d}),jwt:c.access_token,xform:Hs});if(p)throw p;return c.user=f.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(s){if(await xe(this.storage,`${this.storageKey}-code-verifier`),nt(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new oi;const e=Date.now()/1e3;let s=e,a=!0,r=null;const{payload:c}=Gh(t.access_token);if(c.exp&&(s=c.exp,a=s<=e),a){const{data:u,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!u)return{data:{user:null,session:null},error:null};r=u}else{const{data:u,error:d}=await this._getUser(t.access_token);if(d)throw d;r={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:s-e,expires_at:s},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return this._returnResult({data:{user:r.user,session:r},error:null})}catch(e){if(nt(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async e=>{var s;if(!t){const{data:c,error:u}=e;if(u)throw u;t=(s=c.session)!==null&&s!==void 0?s:void 0}if(!t?.refresh_token)throw new oi;const{data:a,error:r}=await this._callRefreshToken(t.refresh_token);return r?this._returnResult({data:{user:null,session:null},error:r}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(e){if(nt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _getSessionFromURL(t,e){try{if(!Oe())throw new Il("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Il(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new by("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Il("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new by("No code detected.");const{data:x,error:C}=await this._exchangeCodeForSession(t.code);if(C)throw C;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:r,refresh_token:c,expires_in:u,expires_at:d,token_type:f}=t;if(!r||!u||!c||!f)throw new Il("No session defined in URL");const p=Math.round(Date.now()/1e3),y=parseInt(u);let v=p+y;d&&(v=parseInt(d));const b=v-p;b*1e3<=Ea&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${y}s`);const A=v-y;p-A>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",A,v,p):p-A<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",A,v,p);const{data:w,error:E}=await this._getUser(r);if(E)throw E;const S={provider_token:s,provider_refresh_token:a,access_token:r,expires_in:y,expires_at:v,refresh_token:c,token_type:f,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:S,redirectType:t.type},error:null})}catch(s){if(nt(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const e=await yn(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&e)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async e=>{var s;const{data:a,error:r}=e;if(r)return this._returnResult({error:r});const c=(s=a.session)===null||s===void 0?void 0:s.access_token;if(c){const{error:u}=await this.admin.signOut(c,t);if(u&&!(bA(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await xe(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const e=OA(),s={id:e,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async e=>{var s,a;try{const{data:{session:r},error:c}=e;if(c)throw c;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",t,"session",r)}catch(r){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",r),console.error(r)}})}async resetPasswordForEmail(t,e={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await ya(this.storage,this.storageKey,!0));try{return await ut(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(r){if(await xe(this.storage,`${this.storageKey}-code-verifier`),nt(r))return this._returnResult({data:null,error:r});throw r}}async getUserIdentities(){var t;try{const{data:e,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=e.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(e){if(nt(e))return this._returnResult({data:null,error:e});throw e}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var e;try{const{data:s,error:a}=await this._useSession(async r=>{var c,u,d,f,p;const{data:y,error:v}=r;if(v)throw v;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await ut(this.fetch,"GET",b,{headers:this.headers,jwt:(p=(f=y.session)===null||f===void 0?void 0:f.access_token)!==null&&p!==void 0?p:void 0})});if(a)throw a;return Oe()&&!(!((e=t.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:t.provider,url:s?.url},error:null})}catch(s){if(nt(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async e=>{var s;try{const{error:a,data:{session:r}}=e;if(a)throw a;const{options:c,provider:u,token:d,access_token:f,nonce:p}=t,y=await ut(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=r?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:u,id_token:d,access_token:f,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Oi}),{data:v,error:b}=y;return b?this._returnResult({data:{user:null,session:null},error:b}):!v||!v.session||!v.user?this._returnResult({data:{user:null,session:null},error:new ma}):(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),this._returnResult({data:v,error:b}))}catch(a){if(await xe(this.storage,`${this.storageKey}-code-verifier`),nt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async e=>{var s,a;const{data:r,error:c}=e;if(c)throw c;return await ut(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(s=r.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(e){if(nt(e))return this._returnResult({data:null,error:e});throw e}}async _refreshAccessToken(t){const e=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(e,"begin");try{const s=Date.now();return await NA(async a=>(a>0&&await MA(200*Math.pow(2,a-1)),this._debug(e,"refreshing attempt",a),await ut(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Oi})),(a,r)=>{const c=200*Math.pow(2,a);return r&&$h(r)&&Date.now()+c-s<Ea})}catch(s){if(this._debug(e,"error",s),nt(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(e,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,e){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",e,"url",s),Oe()&&!e.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,e;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await yn(this.storage,this.storageKey);if(a&&this.userStorage){let c=await yn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await Ta(this.userStorage,this.storageKey+"-user",c)),a.user=(t=c?.user)!==null&&t!==void 0?t:qh()}else if(a&&!a.user&&!a.user){const c=await yn(this.storage,this.storageKey+"-user");c&&c?.user?(a.user=c.user,await xe(this.storage,this.storageKey+"-user"),await Ta(this.storage,this.storageKey,a)):a.user=qh()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const r=((e=a.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Hh;if(this._debug(s,`session has${r?"":" not"} expired with margin of ${Hh}s`),r){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),$h(c)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:u}=await this._getUser(a.access_token);!u&&c?.user?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(s,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var e,s;if(!t)throw new oi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new rc;const{data:r,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!r.session)throw new oi;await this._saveSession(r.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",r.session);const u={data:r.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(r){if(this._debug(a,"error",r),nt(r)){const c={data:null,error:r};return $h(r)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(c),c}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(r),r}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,e,s=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",e,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:e});const r=[],c=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,e)}catch(d){r.push(d)}});if(await Promise.all(c),r.length>0){for(let u=0;u<r.length;u+=1)console.error(r[u]);throw r[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await xe(this.storage,`${this.storageKey}-code-verifier`);const e=Object.assign({},t),s=e.user&&e.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&e.user&&await Ta(this.userStorage,this.storageKey+"-user",{user:e.user});const a=Object.assign({},e);delete a.user;const r=Ey(a);await Ta(this.storage,this.storageKey,r)}else{const a=Ey(e);await Ta(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await xe(this.storage,this.storageKey),await xe(this.storage,this.storageKey+"-code-verifier"),await xe(this.storage,this.storageKey+"-user"),this.userStorage&&await xe(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Oe()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ea);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:s}}=e;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-t)/Ea);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ea}ms, refresh threshold is ${ud} ticks`),a<=ud&&await this._callRefreshToken(s.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Uv)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Oe()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const e=`#_onVisibilityChanged(${t})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,e,s){const a=[`provider=${encodeURIComponent(e)}`];if(s?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[r,c]=await ya(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(r)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(u.toString())}if(s?.queryParams){const r=new URLSearchParams(s.queryParams);a.push(r.toString())}return s?.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async e=>{var s;const{data:a,error:r}=e;return r?this._returnResult({data:null,error:r}):await ut(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token})})}catch(e){if(nt(e))return this._returnResult({data:null,error:e});throw e}}async _enroll(t){try{return await this._useSession(async e=>{var s,a;const{data:r,error:c}=e;if(c)return this._returnResult({data:null,error:c});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:f}=await ut(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token});return f?this._returnResult({data:null,error:f}):(t.factorType==="totp"&&d.type==="totp"&&(!((a=d?.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(e){if(nt(e))return this._returnResult({data:null,error:e});throw e}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var s;const{data:a,error:r}=e;if(r)return this._returnResult({data:null,error:r});const c=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?cS(t.webauthn.credential_response):uS(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:d}=await ut(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:c,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:d}))})}catch(e){if(nt(e))return this._returnResult({data:null,error:e});throw e}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var s;const{data:a,error:r}=e;if(r)return this._returnResult({data:null,error:r});const c=await ut(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});if(c.error)return c;const{data:u}=c;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:oS(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:lS(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(nt(e))return this._returnResult({data:null,error:e});throw e}})}async _challengeAndVerify(t){const{data:e,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})}async _listFactors(){var t;const{data:{user:e},error:s}=await this.getUser();if(s)return{data:null,error:s};const a={all:[],phone:[],totp:[],webauthn:[]};for(const r of(t=e?.factors)!==null&&t!==void 0?t:[])a.all.push(r),r.status==="verified"&&a[r.factor_type].push(r);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,e;const{data:{session:s},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:r}=Gh(s.access_token);let c=null;r.aal&&(c=r.aal);let u=c;((e=(t=s.user.factors)===null||t===void 0?void 0:t.filter(p=>p.status==="verified"))!==null&&e!==void 0?e:[]).length>0&&(u="aal2");const f=r.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async e=>{const{data:{session:s},error:a}=e;return a?this._returnResult({data:null,error:a}):s?await ut(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new oi})})}catch(e){if(nt(e))return this._returnResult({data:null,error:e});throw e}}async _approveAuthorization(t,e){try{return await this._useSession(async s=>{const{data:{session:a},error:r}=s;if(r)return this._returnResult({data:null,error:r});if(!a)return this._returnResult({data:null,error:new oi});const c=await ut(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&Oe()&&!e?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(s){if(nt(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,e){try{return await this._useSession(async s=>{const{data:{session:a},error:r}=s;if(r)return this._returnResult({data:null,error:r});if(!a)return this._returnResult({data:null,error:new oi});const c=await ut(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&Oe()&&!e?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(s){if(nt(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:e},error:s}=t;return s?this._returnResult({data:null,error:s}):e?await ut(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:e.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new oi})})}catch(t){if(nt(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async e=>{const{data:{session:s},error:a}=e;return a?this._returnResult({data:null,error:a}):s?(await ut(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new oi})})}catch(e){if(nt(e))return this._returnResult({data:null,error:e});throw e}}async fetchJwk(t,e={keys:[]}){let s=e.keys.find(u=>u.kid===t);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(u=>u.kid===t),s&&this.jwks_cached_at+yA>a)return s;const{data:r,error:c}=await ut(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!r.keys||r.keys.length===0||(this.jwks=r,this.jwks_cached_at=a,s=r.keys.find(u=>u.kid===t),!s)?null:s}async getClaims(t,e={}){try{let s=t;if(!s){const{data:b,error:A}=await this.getSession();if(A||!b.session)return this._returnResult({data:null,error:A});s=b.session.access_token}const{header:a,payload:r,signature:c,raw:{header:u,payload:d}}=Gh(s);e?.allowExpired||zA(r.exp);const f=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,e?.keys?{keys:e.keys}:e?.jwks);if(!f){const{error:b}=await this.getUser(s);if(b)throw b;return{data:{claims:r,header:a,signature:c},error:null}}const p=FA(a.alg),y=await crypto.subtle.importKey("jwk",f,p,!0,["verify"]);if(!await crypto.subtle.verify(p,y,c,xA(`${u}.${d}`)))throw new fd("Invalid JWT signature");return{data:{claims:r,header:a,signature:c},error:null}}catch(s){if(nt(s))return this._returnResult({data:null,error:s});throw s}}}Jr.nextInstanceID={};const bS=Jr,_S="2.89.0";let zr="";typeof Deno<"u"?zr="deno":typeof document<"u"?zr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?zr="react-native":zr="node";const wS={"X-Client-Info":`supabase-js-${zr}/${_S}`},AS={headers:wS},SS={schema:"public"},ES={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},TS={};function Zr(l){"@babel/helpers - typeof";return Zr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zr(l)}function CS(l,t){if(Zr(l)!="object"||!l)return l;var e=l[Symbol.toPrimitive];if(e!==void 0){var s=e.call(l,t);if(Zr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(l)}function xS(l){var t=CS(l,"string");return Zr(t)=="symbol"?t:t+""}function RS(l,t,e){return(t=xS(t))in l?Object.defineProperty(l,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):l[t]=e,l}function Dy(l,t){var e=Object.keys(l);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(l);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(l,a).enumerable})),e.push.apply(e,s)}return e}function se(l){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Dy(Object(e),!0).forEach(function(s){RS(l,s,e[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(e)):Dy(Object(e)).forEach(function(s){Object.defineProperty(l,s,Object.getOwnPropertyDescriptor(e,s))})}return l}const OS=l=>l?(...t)=>l(...t):(...t)=>fetch(...t),kS=()=>Headers,DS=(l,t,e)=>{const s=OS(e),a=kS();return async(r,c)=>{var u;const d=(u=await t())!==null&&u!==void 0?u:l;let f=new a(c?.headers);return f.has("apikey")||f.set("apikey",l),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),s(r,se(se({},c),{},{headers:f}))}};function MS(l){return l.endsWith("/")?l:l+"/"}function NS(l,t){var e,s;const{db:a,auth:r,realtime:c,global:u}=l,{db:d,auth:f,realtime:p,global:y}=t,v={db:se(se({},d),a),auth:se(se({},f),r),realtime:se(se({},p),c),storage:{},global:se(se(se({},y),u),{},{headers:se(se({},(e=y?.headers)!==null&&e!==void 0?e:{}),(s=u?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return l.accessToken?v.accessToken=l.accessToken:delete v.accessToken,v}function LS(l){const t=l?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(MS(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var BS=class extends bS{constructor(l){super(l)}},PS=class{constructor(l,t,e){var s,a;this.supabaseUrl=l,this.supabaseKey=t;const r=LS(l);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",r),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",r),this.storageUrl=new URL("storage/v1",r),this.functionsUrl=new URL("functions/v1",r);const c=`sb-${r.hostname.split(".")[0]}-auth-token`,u={db:SS,realtime:TS,auth:se(se({},ES),{},{storageKey:c}),global:AS},d=NS(e??{},u);if(this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken)this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(p,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}});else{var f;this.auth=this._initSupabaseAuthClient((f=d.auth)!==null&&f!==void 0?f:{},this.headers,d.global.fetch)}this.fetch=DS(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(se({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new pw(new URL("rest/v1",r).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new dA(this.storageUrl.href,this.headers,this.fetch,e?.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new uw(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(l){return this.rest.from(l)}schema(l){return this.rest.schema(l)}rpc(l,t={},e={head:!1,get:!1,count:void 0}){return this.rest.rpc(l,t,e)}channel(l,t={config:{}}){return this.realtime.channel(l,t)}getChannels(){return this.realtime.getChannels()}removeChannel(l){return this.realtime.removeChannel(l)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var l=this,t,e;if(l.accessToken)return await l.accessToken();const{data:s}=await l.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:l.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:l,persistSession:t,detectSessionInUrl:e,storage:s,userStorage:a,storageKey:r,flowType:c,lock:u,debug:d,throwOnError:f},p,y){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new BS({url:this.authUrl.href,headers:se(se({},v),p),storageKey:r,autoRefreshToken:l,persistSession:t,detectSessionInUrl:e,storage:s,userStorage:a,flowType:c,lock:u,debug:d,throwOnError:f,fetch:y,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(l){return new Mw(this.realtimeUrl.href,se(se({},l),{},{params:se(se({},{apikey:this.supabaseKey}),l?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((l,t)=>{this._handleTokenChanged(l,"CLIENT",t?.access_token)})}_handleTokenChanged(l,t,e){(l==="TOKEN_REFRESHED"||l==="SIGNED_IN")&&this.changedAccessToken!==e?(this.changedAccessToken=e,this.realtime.setAuth(e)):l==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const IS=(l,t,e)=>new PS(l,t,e);function US(){if(typeof window<"u"||typeof process>"u")return!1;const l=process.version;if(l==null)return!1;const t=l.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}US()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const jS="https://xnibtbraheiooiyktvmz.supabase.co",zS="sb_publishable_0n5CauVZHVHawSW5WIQINg_DZ0xaw6q";let Fv;Fv=IS(jS,zS);const Yh=Fv;var My;(function(l){l.STRING="string",l.NUMBER="number",l.INTEGER="integer",l.BOOLEAN="boolean",l.ARRAY="array",l.OBJECT="object"})(My||(My={}));var Ny;(function(l){l.LANGUAGE_UNSPECIFIED="language_unspecified",l.PYTHON="python"})(Ny||(Ny={}));var Ly;(function(l){l.OUTCOME_UNSPECIFIED="outcome_unspecified",l.OUTCOME_OK="outcome_ok",l.OUTCOME_FAILED="outcome_failed",l.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(Ly||(Ly={}));const By=["user","model","function","system"];var Py;(function(l){l.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",l.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",l.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",l.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",l.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",l.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Py||(Py={}));var Iy;(function(l){l.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",l.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",l.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",l.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",l.BLOCK_NONE="BLOCK_NONE"})(Iy||(Iy={}));var Uy;(function(l){l.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",l.NEGLIGIBLE="NEGLIGIBLE",l.LOW="LOW",l.MEDIUM="MEDIUM",l.HIGH="HIGH"})(Uy||(Uy={}));var jy;(function(l){l.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",l.SAFETY="SAFETY",l.OTHER="OTHER"})(jy||(jy={}));var Vr;(function(l){l.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",l.STOP="STOP",l.MAX_TOKENS="MAX_TOKENS",l.SAFETY="SAFETY",l.RECITATION="RECITATION",l.LANGUAGE="LANGUAGE",l.BLOCKLIST="BLOCKLIST",l.PROHIBITED_CONTENT="PROHIBITED_CONTENT",l.SPII="SPII",l.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",l.OTHER="OTHER"})(Vr||(Vr={}));var zy;(function(l){l.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",l.RETRIEVAL_QUERY="RETRIEVAL_QUERY",l.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",l.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",l.CLASSIFICATION="CLASSIFICATION",l.CLUSTERING="CLUSTERING"})(zy||(zy={}));var Fy;(function(l){l.MODE_UNSPECIFIED="MODE_UNSPECIFIED",l.AUTO="AUTO",l.ANY="ANY",l.NONE="NONE"})(Fy||(Fy={}));var Hy;(function(l){l.MODE_UNSPECIFIED="MODE_UNSPECIFIED",l.MODE_DYNAMIC="MODE_DYNAMIC"})(Hy||(Hy={}));class Le extends Error{constructor(t){super(`[GoogleGenerativeAI Error]: ${t}`)}}class wa extends Le{constructor(t,e){super(t),this.response=e}}class Hv extends Le{constructor(t,e,s,a){super(t),this.status=e,this.statusText=s,this.errorDetails=a}}class qs extends Le{}class $v extends Le{}const FS="https://generativelanguage.googleapis.com",HS="v1beta",$S="0.24.1",GS="genai-js";var Cn;(function(l){l.GENERATE_CONTENT="generateContent",l.STREAM_GENERATE_CONTENT="streamGenerateContent",l.COUNT_TOKENS="countTokens",l.EMBED_CONTENT="embedContent",l.BATCH_EMBED_CONTENTS="batchEmbedContents"})(Cn||(Cn={}));class qS{constructor(t,e,s,a,r){this.model=t,this.task=e,this.apiKey=s,this.stream=a,this.requestOptions=r}toString(){var t,e;const s=((t=this.requestOptions)===null||t===void 0?void 0:t.apiVersion)||HS;let r=`${((e=this.requestOptions)===null||e===void 0?void 0:e.baseUrl)||FS}/${s}/${this.model}:${this.task}`;return this.stream&&(r+="?alt=sse"),r}}function VS(l){const t=[];return l?.apiClient&&t.push(l.apiClient),t.push(`${GS}/${$S}`),t.join(" ")}async function YS(l){var t;const e=new Headers;e.append("Content-Type","application/json"),e.append("x-goog-api-client",VS(l.requestOptions)),e.append("x-goog-api-key",l.apiKey);let s=(t=l.requestOptions)===null||t===void 0?void 0:t.customHeaders;if(s){if(!(s instanceof Headers))try{s=new Headers(s)}catch(a){throw new qs(`unable to convert customHeaders value ${JSON.stringify(s)} to Headers: ${a.message}`)}for(const[a,r]of s.entries()){if(a==="x-goog-api-key")throw new qs(`Cannot set reserved header name ${a}`);if(a==="x-goog-api-client")throw new qs(`Header name ${a} can only be set using the apiClient field`);e.append(a,r)}}return e}async function XS(l,t,e,s,a,r){const c=new qS(l,t,e,s,r);return{url:c.toString(),fetchOptions:Object.assign(Object.assign({},JS(r)),{method:"POST",headers:await YS(c),body:a})}}async function lo(l,t,e,s,a,r={},c=fetch){const{url:u,fetchOptions:d}=await XS(l,t,e,s,a,r);return KS(u,d,c)}async function KS(l,t,e=fetch){let s;try{s=await e(l,t)}catch(a){WS(a,l)}return s.ok||await QS(s,l),s}function WS(l,t){let e=l;throw e.name==="AbortError"?(e=new $v(`Request aborted when fetching ${t.toString()}: ${l.message}`),e.stack=l.stack):l instanceof Hv||l instanceof qs||(e=new Le(`Error fetching from ${t.toString()}: ${l.message}`),e.stack=l.stack),e}async function QS(l,t){let e="",s;try{const a=await l.json();e=a.error.message,a.error.details&&(e+=` ${JSON.stringify(a.error.details)}`,s=a.error.details)}catch{}throw new Hv(`Error fetching from ${t.toString()}: [${l.status} ${l.statusText}] ${e}`,l.status,l.statusText,s)}function JS(l){const t={};if(l?.signal!==void 0||l?.timeout>=0){const e=new AbortController;l?.timeout>=0&&setTimeout(()=>e.abort(),l.timeout),l?.signal&&l.signal.addEventListener("abort",()=>{e.abort()}),t.signal=e.signal}return t}function Ld(l){return l.text=()=>{if(l.candidates&&l.candidates.length>0){if(l.candidates.length>1&&console.warn(`This response had ${l.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Yl(l.candidates[0]))throw new wa(`${Fs(l)}`,l);return ZS(l)}else if(l.promptFeedback)throw new wa(`Text not available. ${Fs(l)}`,l);return""},l.functionCall=()=>{if(l.candidates&&l.candidates.length>0){if(l.candidates.length>1&&console.warn(`This response had ${l.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Yl(l.candidates[0]))throw new wa(`${Fs(l)}`,l);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),$y(l)[0]}else if(l.promptFeedback)throw new wa(`Function call not available. ${Fs(l)}`,l)},l.functionCalls=()=>{if(l.candidates&&l.candidates.length>0){if(l.candidates.length>1&&console.warn(`This response had ${l.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Yl(l.candidates[0]))throw new wa(`${Fs(l)}`,l);return $y(l)}else if(l.promptFeedback)throw new wa(`Function call not available. ${Fs(l)}`,l)},l}function ZS(l){var t,e,s,a;const r=[];if(!((e=(t=l.candidates)===null||t===void 0?void 0:t[0].content)===null||e===void 0)&&e.parts)for(const c of(a=(s=l.candidates)===null||s===void 0?void 0:s[0].content)===null||a===void 0?void 0:a.parts)c.text&&r.push(c.text),c.executableCode&&r.push("\n```"+c.executableCode.language+`
`+c.executableCode.code+"\n```\n"),c.codeExecutionResult&&r.push("\n```\n"+c.codeExecutionResult.output+"\n```\n");return r.length>0?r.join(""):""}function $y(l){var t,e,s,a;const r=[];if(!((e=(t=l.candidates)===null||t===void 0?void 0:t[0].content)===null||e===void 0)&&e.parts)for(const c of(a=(s=l.candidates)===null||s===void 0?void 0:s[0].content)===null||a===void 0?void 0:a.parts)c.functionCall&&r.push(c.functionCall);if(r.length>0)return r}const tE=[Vr.RECITATION,Vr.SAFETY,Vr.LANGUAGE];function Yl(l){return!!l.finishReason&&tE.includes(l.finishReason)}function Fs(l){var t,e,s;let a="";if((!l.candidates||l.candidates.length===0)&&l.promptFeedback)a+="Response was blocked",!((t=l.promptFeedback)===null||t===void 0)&&t.blockReason&&(a+=` due to ${l.promptFeedback.blockReason}`),!((e=l.promptFeedback)===null||e===void 0)&&e.blockReasonMessage&&(a+=`: ${l.promptFeedback.blockReasonMessage}`);else if(!((s=l.candidates)===null||s===void 0)&&s[0]){const r=l.candidates[0];Yl(r)&&(a+=`Candidate was blocked due to ${r.finishReason}`,r.finishMessage&&(a+=`: ${r.finishMessage}`))}return a}function to(l){return this instanceof to?(this.v=l,this):new to(l)}function eE(l,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=e.apply(l,t||[]),a,r=[];return a={},c("next"),c("throw"),c("return"),a[Symbol.asyncIterator]=function(){return this},a;function c(v){s[v]&&(a[v]=function(b){return new Promise(function(A,w){r.push([v,b,A,w])>1||u(v,b)})})}function u(v,b){try{d(s[v](b))}catch(A){y(r[0][3],A)}}function d(v){v.value instanceof to?Promise.resolve(v.value.v).then(f,p):y(r[0][2],v)}function f(v){u("next",v)}function p(v){u("throw",v)}function y(v,b){v(b),r.shift(),r.length&&u(r[0][0],r[0][1])}}const Gy=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function iE(l){const t=l.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),e=aE(t),[s,a]=e.tee();return{stream:nE(s),response:sE(a)}}async function sE(l){const t=[],e=l.getReader();for(;;){const{done:s,value:a}=await e.read();if(s)return Ld(rE(t));t.push(a)}}function nE(l){return eE(this,arguments,function*(){const e=l.getReader();for(;;){const{value:s,done:a}=yield to(e.read());if(a)break;yield yield to(Ld(s))}})}function aE(l){const t=l.getReader();return new ReadableStream({start(s){let a="";return r();function r(){return t.read().then(({value:c,done:u})=>{if(u){if(a.trim()){s.error(new Le("Failed to parse stream"));return}s.close();return}a+=c;let d=a.match(Gy),f;for(;d;){try{f=JSON.parse(d[1])}catch{s.error(new Le(`Error parsing JSON response: "${d[1]}"`));return}s.enqueue(f),a=a.substring(d[0].length),d=a.match(Gy)}return r()}).catch(c=>{let u=c;throw u.stack=c.stack,u.name==="AbortError"?u=new $v("Request aborted when reading from the stream"):u=new Le("Error reading from the stream"),u})}}})}function rE(l){const t=l[l.length-1],e={promptFeedback:t?.promptFeedback};for(const s of l){if(s.candidates){let a=0;for(const r of s.candidates)if(e.candidates||(e.candidates=[]),e.candidates[a]||(e.candidates[a]={index:a}),e.candidates[a].citationMetadata=r.citationMetadata,e.candidates[a].groundingMetadata=r.groundingMetadata,e.candidates[a].finishReason=r.finishReason,e.candidates[a].finishMessage=r.finishMessage,e.candidates[a].safetyRatings=r.safetyRatings,r.content&&r.content.parts){e.candidates[a].content||(e.candidates[a].content={role:r.content.role||"user",parts:[]});const c={};for(const u of r.content.parts)u.text&&(c.text=u.text),u.functionCall&&(c.functionCall=u.functionCall),u.executableCode&&(c.executableCode=u.executableCode),u.codeExecutionResult&&(c.codeExecutionResult=u.codeExecutionResult),Object.keys(c).length===0&&(c.text=""),e.candidates[a].content.parts.push(c)}a++}s.usageMetadata&&(e.usageMetadata=s.usageMetadata)}return e}async function Gv(l,t,e,s){const a=await lo(t,Cn.STREAM_GENERATE_CONTENT,l,!0,JSON.stringify(e),s);return iE(a)}async function qv(l,t,e,s){const r=await(await lo(t,Cn.GENERATE_CONTENT,l,!1,JSON.stringify(e),s)).json();return{response:Ld(r)}}function Vv(l){if(l!=null){if(typeof l=="string")return{role:"system",parts:[{text:l}]};if(l.text)return{role:"system",parts:[l]};if(l.parts)return l.role?l:{role:"system",parts:l.parts}}}function eo(l){let t=[];if(typeof l=="string")t=[{text:l}];else for(const e of l)typeof e=="string"?t.push({text:e}):t.push(e);return oE(t)}function oE(l){const t={role:"user",parts:[]},e={role:"function",parts:[]};let s=!1,a=!1;for(const r of l)"functionResponse"in r?(e.parts.push(r),a=!0):(t.parts.push(r),s=!0);if(s&&a)throw new Le("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!s&&!a)throw new Le("No content is provided for sending chat message.");return s?t:e}function lE(l,t){var e;let s={model:t?.model,generationConfig:t?.generationConfig,safetySettings:t?.safetySettings,tools:t?.tools,toolConfig:t?.toolConfig,systemInstruction:t?.systemInstruction,cachedContent:(e=t?.cachedContent)===null||e===void 0?void 0:e.name,contents:[]};const a=l.generateContentRequest!=null;if(l.contents){if(a)throw new qs("CountTokensRequest must have one of contents or generateContentRequest, not both.");s.contents=l.contents}else if(a)s=Object.assign(Object.assign({},s),l.generateContentRequest);else{const r=eo(l);s.contents=[r]}return{generateContentRequest:s}}function qy(l){let t;return l.contents?t=l:t={contents:[eo(l)]},l.systemInstruction&&(t.systemInstruction=Vv(l.systemInstruction)),t}function cE(l){return typeof l=="string"||Array.isArray(l)?{content:eo(l)}:l}const Vy=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],uE={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function hE(l){let t=!1;for(const e of l){const{role:s,parts:a}=e;if(!t&&s!=="user")throw new Le(`First content should be with role 'user', got ${s}`);if(!By.includes(s))throw new Le(`Each item should include role field. Got ${s} but valid roles are: ${JSON.stringify(By)}`);if(!Array.isArray(a))throw new Le("Content should have 'parts' property with an array of Parts");if(a.length===0)throw new Le("Each Content should have at least one part");const r={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const u of a)for(const d of Vy)d in u&&(r[d]+=1);const c=uE[s];for(const u of Vy)if(!c.includes(u)&&r[u]>0)throw new Le(`Content with role '${s}' can't contain '${u}' part`);t=!0}}function Yy(l){var t;if(l.candidates===void 0||l.candidates.length===0)return!1;const e=(t=l.candidates[0])===null||t===void 0?void 0:t.content;if(e===void 0||e.parts===void 0||e.parts.length===0)return!1;for(const s of e.parts)if(s===void 0||Object.keys(s).length===0||s.text!==void 0&&s.text==="")return!1;return!0}const Xy="SILENT_ERROR";class dE{constructor(t,e,s,a={}){this.model=e,this.params=s,this._requestOptions=a,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=t,s?.history&&(hE(s.history),this._history=s.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(t,e={}){var s,a,r,c,u,d;await this._sendPromise;const f=eo(t),p={safetySettings:(s=this.params)===null||s===void 0?void 0:s.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(c=this.params)===null||c===void 0?void 0:c.toolConfig,systemInstruction:(u=this.params)===null||u===void 0?void 0:u.systemInstruction,cachedContent:(d=this.params)===null||d===void 0?void 0:d.cachedContent,contents:[...this._history,f]},y=Object.assign(Object.assign({},this._requestOptions),e);let v;return this._sendPromise=this._sendPromise.then(()=>qv(this._apiKey,this.model,p,y)).then(b=>{var A;if(Yy(b.response)){this._history.push(f);const w=Object.assign({parts:[],role:"model"},(A=b.response.candidates)===null||A===void 0?void 0:A[0].content);this._history.push(w)}else{const w=Fs(b.response);w&&console.warn(`sendMessage() was unsuccessful. ${w}. Inspect response object for details.`)}v=b}).catch(b=>{throw this._sendPromise=Promise.resolve(),b}),await this._sendPromise,v}async sendMessageStream(t,e={}){var s,a,r,c,u,d;await this._sendPromise;const f=eo(t),p={safetySettings:(s=this.params)===null||s===void 0?void 0:s.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(c=this.params)===null||c===void 0?void 0:c.toolConfig,systemInstruction:(u=this.params)===null||u===void 0?void 0:u.systemInstruction,cachedContent:(d=this.params)===null||d===void 0?void 0:d.cachedContent,contents:[...this._history,f]},y=Object.assign(Object.assign({},this._requestOptions),e),v=Gv(this._apiKey,this.model,p,y);return this._sendPromise=this._sendPromise.then(()=>v).catch(b=>{throw new Error(Xy)}).then(b=>b.response).then(b=>{if(Yy(b)){this._history.push(f);const A=Object.assign({},b.candidates[0].content);A.role||(A.role="model"),this._history.push(A)}else{const A=Fs(b);A&&console.warn(`sendMessageStream() was unsuccessful. ${A}. Inspect response object for details.`)}}).catch(b=>{b.message!==Xy&&console.error(b)}),v}}async function fE(l,t,e,s){return(await lo(t,Cn.COUNT_TOKENS,l,!1,JSON.stringify(e),s)).json()}async function gE(l,t,e,s){return(await lo(t,Cn.EMBED_CONTENT,l,!1,JSON.stringify(e),s)).json()}async function pE(l,t,e,s){const a=e.requests.map(c=>Object.assign(Object.assign({},c),{model:t}));return(await lo(t,Cn.BATCH_EMBED_CONTENTS,l,!1,JSON.stringify({requests:a}),s)).json()}class Ky{constructor(t,e,s={}){this.apiKey=t,this._requestOptions=s,e.model.includes("/")?this.model=e.model:this.model=`models/${e.model}`,this.generationConfig=e.generationConfig||{},this.safetySettings=e.safetySettings||[],this.tools=e.tools,this.toolConfig=e.toolConfig,this.systemInstruction=Vv(e.systemInstruction),this.cachedContent=e.cachedContent}async generateContent(t,e={}){var s;const a=qy(t),r=Object.assign(Object.assign({},this._requestOptions),e);return qv(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(s=this.cachedContent)===null||s===void 0?void 0:s.name},a),r)}async generateContentStream(t,e={}){var s;const a=qy(t),r=Object.assign(Object.assign({},this._requestOptions),e);return Gv(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(s=this.cachedContent)===null||s===void 0?void 0:s.name},a),r)}startChat(t){var e;return new dE(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(e=this.cachedContent)===null||e===void 0?void 0:e.name},t),this._requestOptions)}async countTokens(t,e={}){const s=lE(t,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),a=Object.assign(Object.assign({},this._requestOptions),e);return fE(this.apiKey,this.model,s,a)}async embedContent(t,e={}){const s=cE(t),a=Object.assign(Object.assign({},this._requestOptions),e);return gE(this.apiKey,this.model,s,a)}async batchEmbedContents(t,e={}){const s=Object.assign(Object.assign({},this._requestOptions),e);return pE(this.apiKey,this.model,t,s)}}class mE{constructor(t){this.apiKey=t}getGenerativeModel(t,e){if(!t.model)throw new Le("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Ky(this.apiKey,t,e)}getGenerativeModelFromCachedContent(t,e,s){if(!t.name)throw new qs("Cached content must contain a `name` field.");if(!t.model)throw new qs("Cached content must contain a `model` field.");const a=["model","systemInstruction"];for(const c of a)if(e?.[c]&&t[c]&&e?.[c]!==t[c]){if(c==="model"){const u=e.model.startsWith("models/")?e.model.replace("models/",""):e.model,d=t.model.startsWith("models/")?t.model.replace("models/",""):t.model;if(u===d)continue}throw new qs(`Different value for "${c}" specified in modelParams (${e[c]}) and cachedContent (${t[c]})`)}const r=Object.assign(Object.assign({},e),{model:t.model,tools:t.tools,toolConfig:t.toolConfig,systemInstruction:t.systemInstruction,cachedContent:t});return new Ky(this.apiKey,r,s)}}function yE(l){const t={nome:"no encontrado",email:"no encontrado",telefone:"no encontrado"},e=/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi,s=l.match(e);s&&s[0]&&(t.email=s[0]);const a=/(?:(?:\+|00)?55\s?)?(?:\(?([1-9][0-9])\)?\s?)?(?:((?:9\s?)?[2-9]\d{3})[-\s]?(\d{4}))/g;let r=null;const c=[...l.matchAll(a)];for(const f of c){const p=f[0];/^(19|20)\d{2}\s*-\s*(19|20)\d{2}$/.test(p)||(f[1]||!r)&&(r=p.trim())}r&&(t.telefone=r);let u=l.split(`
`).map(f=>f.trim()).filter(f=>f.length>0);if(u.length===1&&(u=u[0].split(/\s{2,}n\s{2,}|\s{3,}|[|;]/).map(p=>p.trim()).filter(p=>p.length>0),console.log("PDF tinha 1 linha, dividido em",u.length,"partes")),u.length<5){const p=u.join(" ").split(/(?=\(?\d{2}\)?[\s-]?\d{4,5}[\s-]?\d{4})|(?=[a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z]{2,})|(?=LinkedIn:|GitHub:|Sobre|Formao|Experincia|Habilidades)/i).map(y=>y.trim()).filter(y=>y.length>0);p.length>u.length&&(u=p,console.log("Melhor diviso encontrada:",u.length,"partes"))}console.log("=== DEBUG EXTRAO DE NOME ==="),console.log("Total de linhas aps split:",u.length),console.log("Primeiras 20 linhas:"),u.slice(0,20).forEach((f,p)=>console.log(`  [${p}] "${f}"`));const d=[];for(let f=0;f<Math.min(30,u.length);f++){const p=u[f];if(p.length<2){console.log(`  [${f}] SKIP - muito curto`);continue}const y=["@","www.","http",".com",".br","curriculum","currculo","resume","telefone","phone","cel","celular","email","e-mail","endereo","address","rua","av.","linkedin","github","portfolio","objetivo","objective","experincia","experience","formao","education","escolaridade","habilidades","skills","competncias","idiomas","languages","perfil","profile","resumo","summary","profissional","professional","contato","contact","contact info","sobre","about","ensino","educao","colgio","faculdade","universidade","escola","prmio","award","bolsa","scholarship"],v=p.toLowerCase(),b=y.some(C=>v.includes(C)),w=(p.match(/\d/g)||[]).length>=2,E=/\(?\d{2}\)?\s*\d{4,5}[-\s]?\d{4}/.test(p);if(b||E||w){console.log(`  [${f}] SKIP - palavra-chave/telefone/muitos nmeros detectados`);continue}const x=p.replace(/^(nome|name|candidato|candidate):\s*/i,"").replace(/^[-]\s*/,"").replace(/\s+n\s+/g," ").replace(/\s*[-]\s*[A-Z]{2}\s*$/,"").trim().match(/[A-Z-][a-z-A-Z-'\-]*/g);if(x&&x.length>0){const C=["fortaleza","so","paulo","rio","janeiro","belo","horizonte","braslia","salvador","curitiba","recife","porto","alegre","manaus","belm","goinia","campinas","lus","macei","natal","teresina","joo","pessoa","aracaju","florianpolis","vitria","cuiab","campo","grande","cear","brasil"],k=[],L=D=>{for(const z of D){const Y=z.toLowerCase();if(["telefone","email","endereo","address","engenharia","engineer","analista","analyst","desenvolvedor","developer","mecnica","mechanic","eltrica","electric","tcnico","technician","auxiliar","assistant","estagirio","intern","gerente","manager"].includes(Y)||C.includes(Y)||/^(CE|SP|RJ|MG|BA|PR|SC|RS|PE|PA|AM|RO|AC|AP|RR|TO|MA|PI|AL|SE|PB|RN|MT|MS|GO|DF)$/i.test(z))break;z.length>=2&&k.push(z)}};L(x);let R=f+1;for(;k.length<6&&R<Math.min(f+3,u.length);){const D=u[R],z=D.toLowerCase(),Y=y.some(At=>z.includes(At)),K=(D.match(/\d/g)||[]).length>=2,dt=/\(?\d{2}\)?\s*\d{4,5}[-\s]?\d{4}/.test(D);if(Y||K||dt)break;const vt=D.replace(/^(nome|name|candidato|candidate):\s*/i,"").replace(/^[-]\s*/,"").trim().match(/[A-Z-][a-z-A-Z-'\-]*/g);if(vt&&vt.length>0)L(vt);else break;R++}if(k.length>=2){const D=k.join(" ");let z=0;f<=5?z+=5:f<=10&&(z+=2),k.length>=3&&(z+=3);const Y=Math.min(R+2,u.length);for(let Q=R;Q<Y;Q++){const K=u[Q].toLowerCase();if(K.includes("engenharia")||K.includes("desenvolvedor")||K.includes("analista")||K.includes("telefone")||K.includes("email")||K.includes("perfil profissional")){z+=10,console.log(`  [${f}] Bnus de contexto: linha seguinte tem palavra-chave de currculo`);break}}console.log(`  [${f}] Candidato: "${D}" (Score: ${z})`),d.push({name:D,score:z})}}else console.log(`  [${f}] Nenhuma palavra capitalizada vlida`)}return d.length>0?(d.sort((f,p)=>p.score-f.score),t.nome=d[0].name,console.log(`=== VENCEDOR: "${t.nome}" com score ${d[0].score} ===`)):console.log("Nenhum candidato a nome encontrado."),console.log("=== FIM DEBUG ==="),console.log("Resultado:",t),t}async function vE(l,t){if(!t)throw new Error("Chave da API Gemini no fornecida.");const e=new mE(t),s=["gemini-2.5-flash","gemini-2.5-pro","gemini-2.0-flash","gemini-1.5-flash","gemini-1.5-flash-8b","gemini-1.5-pro","gemini-pro","gemini-1.0-pro"];for(const a of s)try{console.log(`Tentando conectar com modelo: ${a}`);const r=e.getGenerativeModel({model:a}),c=`
            Voc  um assistente especialista em extrao de dados de currculos.
            Analise o texto fornecido abaixo e extraia os seguintes campos:
            - nome (O nome completo do candidato)
            - email (O endereo de email principal)
            - telefone (O nmero de telefone principal)

            Regras:
            1. Retorne um objeto JSON estrito.
            2. Se algum dado no for encontrado, o valor deve ser exatamente "no encontrado".
            3. Normalize/formate o telefone se possvel.

            Texto do currculo:
            """
            ${l}
            """
            `;let f=(await(await r.generateContent(c)).response).text();return f=f.replace(/```json/g,"").replace(/```/g,"").trim(),JSON.parse(f)}catch(r){console.warn(`Falha com modelo ${a}:`,r.message)}return console.error("Todas as tentativas de modelo Gemini falharam. Usando extrao por regex como fallback."),console.warn("AVISO: A extrao por regex  menos precisa que a IA. Considere verificar sua chave API do Gemini."),yE(l)}const Ie=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),gd=[.001,0,0,.001,0,0],Xh=1.35,li={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},$s={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},io="pdfjs_internal_editor_",bt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},kt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},bE={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},pd={TRIANGLES:1,LATTICE:2},Re={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Xl={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ge={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Ca={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},oc={ERRORS:0,WARNINGS:1,INFOS:5},so={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Br={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},_E={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let lc=oc.WARNINGS;function wE(l){Number.isInteger(l)&&(lc=l)}function AE(){return lc}function cc(l){lc>=oc.INFOS&&console.info(`Info: ${l}`)}function mt(l){lc>=oc.WARNINGS&&console.warn(`Warning: ${l}`)}function qt(l){throw new Error(l)}function Dt(l,t){l||qt(t)}function SE(l){switch(l?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Yv(l,t=null,e=null){if(!l)return null;if(e&&typeof l=="string"&&(e.addDefaultProtocol&&l.startsWith("www.")&&l.match(/\./g)?.length>=2&&(l=`http://${l}`),e.tryConvertEncoding))try{l=RE(l)}catch{}const s=t?URL.parse(l,t):URL.parse(l);return SE(s)?s:null}function Xv(l,t,e=!1){const s=URL.parse(l);return s?(s.hash=t,s.href):e&&Yv(l,"http://example.com")?l.split("#",1)[0]+`${t?`#${t}`:""}`:""}function yt(l,t,e,s=!1){return Object.defineProperty(l,t,{value:e,enumerable:!s,configurable:!0,writable:!1}),e}const On=(function(){function t(e,s){this.message=e,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class Wy extends On{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Kh extends On{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class md extends On{constructor(t){super(t,"InvalidPDFException")}}class tc extends On{constructor(t,e,s){super(t,"ResponseException"),this.status=e,this.missing=s}}class EE extends On{constructor(t){super(t,"FormatError")}}class Vs extends On{constructor(t){super(t,"AbortException")}}function Kv(l){(typeof l!="object"||l?.length===void 0)&&qt("Invalid argument for bytesToString");const t=l.length,e=8192;if(t<e)return String.fromCharCode.apply(null,l);const s=[];for(let a=0;a<t;a+=e){const r=Math.min(a+e,t),c=l.subarray(a,r);s.push(String.fromCharCode.apply(null,c))}return s.join("")}function co(l){typeof l!="string"&&qt("Invalid argument for stringToBytes");const t=l.length,e=new Uint8Array(t);for(let s=0;s<t;++s)e[s]=l.charCodeAt(s)&255;return e}function TE(l){return String.fromCharCode(l>>24&255,l>>16&255,l>>8&255,l&255)}function CE(){const l=new Uint8Array(4);return l[0]=1,new Uint32Array(l.buffer,0,1)[0]===1}function xE(){try{return new Function(""),!0}catch{return!1}}class Me{static get isLittleEndian(){return yt(this,"isLittleEndian",CE())}static get isEvalSupported(){return yt(this,"isEvalSupported",xE())}static get isOffscreenCanvasSupported(){return yt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return yt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return yt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return yt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return yt(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return yt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Wh=Array.from(Array(256).keys(),l=>l.toString(16).padStart(2,"0"));class et{static makeHexColor(t,e,s){return`#${Wh[t]}${Wh[e]}${Wh[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let s;t[0]?(t[0]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[3],e[3]*=t[3]):(s=e[0],e[0]=e[1],e[1]=s,s=e[2],e[2]=e[3],e[3]=s,t[1]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,s=0){const a=t[s],r=t[s+1];t[s]=a*e[0]+r*e[2]+e[4],t[s+1]=a*e[1]+r*e[3]+e[5]}static applyTransformToBezier(t,e,s=0){const a=e[0],r=e[1],c=e[2],u=e[3],d=e[4],f=e[5];for(let p=0;p<6;p+=2){const y=t[s+p],v=t[s+p+1];t[s+p]=y*a+v*c+d,t[s+p+1]=y*r+v*u+f}}static applyInverseTransform(t,e){const s=t[0],a=t[1],r=e[0]*e[3]-e[1]*e[2];t[0]=(s*e[3]-a*e[2]+e[2]*e[5]-e[4]*e[3])/r,t[1]=(-s*e[1]+a*e[0]+e[4]*e[1]-e[5]*e[0])/r}static axialAlignedBoundingBox(t,e,s){const a=e[0],r=e[1],c=e[2],u=e[3],d=e[4],f=e[5],p=t[0],y=t[1],v=t[2],b=t[3];let A=a*p+d,w=A,E=a*v+d,S=E,x=u*y+f,C=x,k=u*b+f,L=k;if(r!==0||c!==0){const R=r*p,D=r*v,z=c*y,Y=c*b;A+=z,S+=z,E+=Y,w+=Y,x+=R,L+=R,k+=D,C+=D}s[0]=Math.min(s[0],A,E,w,S),s[1]=Math.min(s[1],x,k,C,L),s[2]=Math.max(s[2],A,E,w,S),s[3]=Math.max(s[3],x,k,C,L)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const s=t[0],a=t[1],r=t[2],c=t[3],u=s**2+a**2,d=s*r+a*c,f=r**2+c**2,p=(u+f)/2,y=Math.sqrt(p**2-(u*f-d**2));e[0]=Math.sqrt(p+y||1),e[1]=Math.sqrt(p-y||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const s=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),a=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(s>a)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>c?null:[s,r,a,c]}static pointBoundingBox(t,e,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],e),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],e)}static rectBoundingBox(t,e,s,a,r){r[0]=Math.min(r[0],t,s),r[1]=Math.min(r[1],e,a),r[2]=Math.max(r[2],t,s),r[3]=Math.max(r[3],e,a)}static#t(t,e,s,a,r,c,u,d,f,p){if(f<=0||f>=1)return;const y=1-f,v=f*f,b=v*f,A=y*(y*(y*t+3*f*e)+3*v*s)+b*a,w=y*(y*(y*r+3*f*c)+3*v*u)+b*d;p[0]=Math.min(p[0],A),p[1]=Math.min(p[1],w),p[2]=Math.max(p[2],A),p[3]=Math.max(p[3],w)}static#e(t,e,s,a,r,c,u,d,f,p,y,v){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,e,s,a,r,c,u,d,-y/p,v);return}const b=p**2-4*y*f;if(b<0)return;const A=Math.sqrt(b),w=2*f;this.#t(t,e,s,a,r,c,u,d,(-p+A)/w,v),this.#t(t,e,s,a,r,c,u,d,(-p-A)/w,v)}static bezierBoundingBox(t,e,s,a,r,c,u,d,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,d),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,d),this.#e(t,s,r,u,e,a,c,d,3*(-t+3*(s-r)+u),6*(t-2*s+r),3*(s-t),f),this.#e(t,s,r,u,e,a,c,d,3*(-e+3*(a-c)+d),6*(e-2*a+c),3*(a-e),f)}}function RE(l){return decodeURIComponent(escape(l))}let Qh=null,Qy=null;function OE(l){return Qh||(Qh=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Qy=new Map([["","t"]])),l.replaceAll(Qh,(t,e,s)=>e?e.normalize("NFKC"):Qy.get(s))}function Wv(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const l=new Uint8Array(32);return crypto.getRandomValues(l),Kv(l)}const ka="pdfjs_internal_id_";function kE(l,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[s,a,...r]=e;if(!l(s)&&!Number.isInteger(s)||!t(a))return!1;const c=r.length;let u=!0;switch(a.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const d of r)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function Ue(l,t,e){return Math.min(Math.max(l,t),e)}function Qv(l){return Uint8Array.prototype.toBase64?l.toBase64():btoa(Kv(l))}function DE(l){return Uint8Array.fromBase64?Uint8Array.fromBase64(l):co(atob(l))}typeof Promise.try!="function"&&(Promise.try=function(l,...t){return new Promise(e=>{e(l(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(l){return l.reduce((t,e)=>t+e,0)});class no{static textContent(t){const e=[],s={items:e,styles:Object.create(null)};function a(r){if(!r)return;let c=null;const u=r.name;if(u==="#text")c=r.value;else if(no.shouldBuildText(u))r?.attributes?.textContent?c=r.attributes.textContent:r.value&&(c=r.value);else return;if(c!==null&&e.push({str:c}),!!r.children)for(const d of r.children)a(d)}return a(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Jv{static setupStorage(t,e,s,a,r){const c=a.getValue(e,{value:null});switch(s.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),r==="print")break;t.addEventListener("input",u=>{a.setValue(e,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(c.value===s.attributes.xfaOn?t.setAttribute("checked",!0):c.value===s.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",u=>{a.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),r==="print")break;t.addEventListener("input",u=>{a.setValue(e,{value:u.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const u of s.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;a.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:s=null,intent:a,linkService:r}){const{attributes:c}=e,u=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${a}`);for(const[d,f]of Object.entries(c))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}u&&r.addLinkAttributes(t,c.href,c.newWindow),s&&c.dataId&&this.setupStorage(t,c.dataId,e,s)}static render(t){const e=t.annotationStorage,s=t.linkService,a=t.xfaHtml,r=t.intent||"display",c=document.createElement(a.name);a.attributes&&this.setAttributes({html:c,element:a,intent:r,linkService:s});const u=r!=="richText",d=t.div;if(d.append(c),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=y}u&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(a.children.length===0){if(a.value){const y=document.createTextNode(a.value);c.append(y),u&&no.shouldBuildText(a.name)&&f.push(y)}return{textDivs:f}}const p=[[a,-1,c]];for(;p.length>0;){const[y,v,b]=p.at(-1);if(v+1===y.children.length){p.pop();continue}const A=y.children[++p.at(-1)[1]];if(A===null)continue;const{name:w}=A;if(w==="#text"){const S=document.createTextNode(A.value);f.push(S),b.append(S);continue}const E=A?.attributes?.xmlns?document.createElementNS(A.attributes.xmlns,w):document.createElement(w);if(b.append(E),A.attributes&&this.setAttributes({html:E,element:A,storage:e,intent:r,linkService:s}),A.children?.length>0)p.push([A,-1,E]);else if(A.value){const S=document.createTextNode(A.value);u&&no.shouldBuildText(w)&&f.push(S),E.append(S)}}for(const y of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const cs="http://www.w3.org/2000/svg";class ja{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function uo(l,t="text"){if(Fr(l,document.baseURI)){const e=await fetch(l);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,s)=>{const a=new XMLHttpRequest;a.open("GET",l,!0),a.responseType=t,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(a.response);return}e(a.responseText);return}s(new Error(a.statusText))}},a.send(null)})}class ho{constructor({viewBox:t,userUnit:e,scale:s,rotation:a,offsetX:r=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=s,this.rotation=a,this.offsetX=r,this.offsetY=c,s*=e;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let p,y,v,b;switch(a%=360,a<0&&(a+=360),a){case 180:p=-1,y=0,v=0,b=1;break;case 90:p=0,y=1,v=1,b=0;break;case 270:p=0,y=-1,v=-1,b=0;break;case 0:p=1,y=0,v=0,b=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(v=-v,b=-b);let A,w,E,S;p===0?(A=Math.abs(f-t[1])*s+r,w=Math.abs(d-t[0])*s+c,E=(t[3]-t[1])*s,S=(t[2]-t[0])*s):(A=Math.abs(d-t[0])*s+r,w=Math.abs(f-t[1])*s+c,E=(t[2]-t[0])*s,S=(t[3]-t[1])*s),this.transform=[p*s,y*s,v*s,b*s,A-p*s*d-v*s*f,w-y*s*d-b*s*f],this.width=E,this.height=S}get rawDims(){const t=this.viewBox;return yt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:s=this.offsetX,offsetY:a=this.offsetY,dontFlip:r=!1}={}){return new ho({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:a,dontFlip:r})}convertToViewportPoint(t,e){const s=[t,e];return et.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const e=[t[0],t[1]];et.applyTransform(e,this.transform);const s=[t[2],t[3]];return et.applyTransform(s,this.transform),[e[0],e[1],s[0],s[1]]}convertToPdfPoint(t,e){const s=[t,e];return et.applyInverseTransform(s,this.transform),s}}class Bd extends On{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function uc(l){const t=l.length;let e=0;for(;e<t&&l[e].trim()==="";)e++;return l.substring(e,e+5).toLowerCase()==="data:"}function Pd(l){return typeof l=="string"&&/\.pdf$/i.test(l)}function ME(l){return[l]=l.split(/[#?]/,1),l.substring(l.lastIndexOf("/")+1)}function NE(l,t="document.pdf"){if(typeof l!="string")return t;if(uc(l))return mt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(l);if(!s)return t;const a=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},r=/\.pdf$/i,c=s.pathname.split("/").at(-1);if(r.test(c))return a(c);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const f of u)if(r.test(f))return a(f);const d=Array.from(s.searchParams.keys()).reverse();for(const f of d)if(r.test(f))return a(f)}if(s.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(d)return a(d[0])}return t}class Jy{started=Object.create(null);times=[];time(t){t in this.started&&mt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||mt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:s}of this.times)e=Math.max(s.length,e);for(const{name:s,start:a,end:r}of this.times)t.push(`${s.padEnd(e)} ${r-a}ms
`);return t.join("")}}function Fr(l,t){const e=t?URL.parse(l,t):URL.parse(l);return e?.protocol==="http:"||e?.protocol==="https:"}function Ti(l){l.preventDefault()}function ne(l){l.preventDefault(),l.stopPropagation()}function LE(l){console.log("Deprecated API usage: "+l)}class yd{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const s=parseInt(e[1],10);let a=parseInt(e[2],10);a=a>=1&&a<=12?a-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let c=parseInt(e[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(e[6],10);d=d>=0&&d<=59?d:0;const f=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let y=parseInt(e[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(c+=p,u+=y):f==="+"&&(c-=p,u-=y),new Date(Date.UTC(s,a,r,c,u,d))}}function BE(l,{scale:t=1,rotation:e=0}){const{width:s,height:a}=l.attributes.style,r=[0,0,parseInt(s),parseInt(a)];return new ho({viewBox:r,userUnit:1,scale:t,rotation:e})}function fo(l){if(l.startsWith("#")){const t=parseInt(l.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return l.startsWith("rgb(")?l.slice(4,-1).split(",").map(t=>parseInt(t)):l.startsWith("rgba(")?l.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(mt(`Not a valid color format: "${l}"`),[0,0,0])}function PE(l){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of l.keys()){t.style.color=e;const s=window.getComputedStyle(t).color;l.set(e,fo(s))}t.remove()}function Jt(l){const{a:t,b:e,c:s,d:a,e:r,f:c}=l.getTransform();return[t,e,s,a,r,c]}function ji(l){const{a:t,b:e,c:s,d:a,e:r,f:c}=l.getTransform().invertSelf();return[t,e,s,a,r,c]}function xn(l,t,e=!1,s=!0){if(t instanceof ho){const{pageWidth:a,pageHeight:r}=t.rawDims,{style:c}=l,u=Me.isCSSRoundSupported,d=`var(--total-scale-factor) * ${a}px`,f=`var(--total-scale-factor) * ${r}px`,p=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(c.width=p,c.height=y):(c.width=y,c.height=p)}s&&l.setAttribute("data-main-rotation",t.rotation)}class $i{constructor(){const{pixelRatio:t}=$i;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,s,a,r=-1){let c=1/0,u=1/0,d=1/0;s=$i.capPixels(s,r),s>0&&(c=Math.sqrt(s/(t*e))),a!==-1&&(u=a/t,d=a/e);const f=Math.min(c,u,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,s):s}return t}}const vd=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class IE{static get isDarkMode(){return yt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class UE{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),yt(this,"commentForegroundColor",fo(s))}}function jE(l,t,e,s){s=Math.min(Math.max(s??1,0),1);const a=255*(1-s);return l=Math.round(l*s+a),t=Math.round(t*s+a),e=Math.round(e*s+a),[l,t,e]}function Zy(l,t){const e=l[0]/255,s=l[1]/255,a=l[2]/255,r=Math.max(e,s,a),c=Math.min(e,s,a),u=(r+c)/2;if(r===c)t[0]=t[1]=0;else{const d=r-c;switch(t[1]=u<.5?d/(r+c):d/(2-r-c),r){case e:t[0]=((s-a)/d+(s<a?6:0))*60;break;case s:t[0]=((a-e)/d+2)*60;break;case a:t[0]=((e-s)/d+4)*60;break}}t[2]=u}function bd(l,t){const e=l[0],s=l[1],a=l[2],r=(1-Math.abs(2*a-1))*s,c=r*(1-Math.abs(e/60%2-1)),u=a-r/2;switch(Math.floor(e/60)){case 0:t[0]=r+u,t[1]=c+u,t[2]=u;break;case 1:t[0]=c+u,t[1]=r+u,t[2]=u;break;case 2:t[0]=u,t[1]=r+u,t[2]=c+u;break;case 3:t[0]=u,t[1]=c+u,t[2]=r+u;break;case 4:t[0]=c+u,t[1]=u,t[2]=r+u;break;case 5:case 6:t[0]=r+u,t[1]=u,t[2]=c+u;break}}function tv(l){return l<=.03928?l/12.92:((l+.055)/1.055)**2.4}function ev(l,t,e){bd(l,e),e.map(tv);const s=.2126*e[0]+.7152*e[1]+.0722*e[2];bd(t,e),e.map(tv);const a=.2126*e[0]+.7152*e[1]+.0722*e[2];return s>a?(s+.05)/(a+.05):(a+.05)/(s+.05)}const iv=new Map;function zE(l,t){const e=l[0]+l[1]*256+l[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=iv.get(e);if(s)return s;const a=new Float32Array(9),r=a.subarray(0,3),c=a.subarray(3,6);Zy(l,c);const u=a.subarray(6,9);Zy(t,u);const d=u[2]<.5,f=d?12:4.5;if(c[2]=d?Math.sqrt(c[2]):1-Math.sqrt(1-c[2]),ev(c,u,r)<f){let p,y;d?(p=c[2],y=1):(p=0,y=c[2]);const v=.005;for(;y-p>v;){const b=c[2]=(p+y)/2;d===ev(c,u,r)<f?p=b:y=b}c[2]=d?y:p}return bd(c,r),s=et.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),iv.set(e,s),s}function Zv({html:l,dir:t,className:e},s){const a=document.createDocumentFragment();if(typeof l=="string"){const r=document.createElement("p");r.dir=t||"auto";const c=l.split(/(?:\r\n?|\n)/);for(let u=0,d=c.length;u<d;++u){const f=c[u];r.append(document.createTextNode(f)),u<d-1&&r.append(document.createElement("br"))}a.append(r)}else Jv.render({xfaHtml:l,div:a,intent:"richText"});a.firstElementChild.classList.add("richText",e),s.append(a)}function tb(l){const t=new Path2D;if(!l)return t;for(let e=0,s=l.length;e<s;)switch(l[e++]){case Br.moveTo:t.moveTo(l[e++],l[e++]);break;case Br.lineTo:t.lineTo(l[e++],l[e++]);break;case Br.curveTo:t.bezierCurveTo(l[e++],l[e++],l[e++],l[e++],l[e++],l[e++]);break;case Br.quadraticCurveTo:t.quadraticCurveTo(l[e++],l[e++],l[e++],l[e++]);break;case Br.closePath:t.closePath();break;default:mt(`Unrecognized drawing path operator: ${l[e-1]}`);break}return t}class Yr{#t=null;#e=null;#s;#i=null;#r=null;#a=null;#n=null;#o=null;static#c=null;constructor(t){this.#s=t,Yr.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#s._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",Ti,{signal:e}),t.addEventListener("pointerdown",Yr.#l,{signal:e}));const s=this.#i=document.createElement("div");s.className="buttons",t.append(s);const a=this.#s.toolbarPosition;if(a){const{style:r}=t,c=this.#s._uiManager.direction==="ltr"?1-a[0]:a[0];r.insetInlineEnd=`${100*c}%`,r.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#s._focusEventsAllowed=!1,ne(t)}#h(t){this.#s._focusEventsAllowed=!0,ne(t)}#f(t){const e=this.#s._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Ti,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#a?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#s,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",Yr.#c[t]),this.#f(s)&&s.addEventListener("click",a=>{e.delete()},{signal:e._signal}),this.#i.append(s)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#i.append(e,this.#m),this.#r=t}addComment(t,e=null){if(this.#a)return;const s=t.renderForToolbar();if(!s)return;this.#f(s);const a=this.#n=this.#m;e?(this.#i.insertBefore(s,e),this.#i.insertBefore(a,e)):this.#i.append(s,a),this.#a=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#i.append(e,this.#m)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#s);this.#f(e),this.#i.append(e,this.#m)}removeButton(t){t==="comment"&&(this.#a?.removeToolbarCommentButton(),this.#a=null,this.#n?.remove(),this.#n=null)}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,s){if(!e&&t==="comment")return;const a=this.#i.querySelector(s);a&&t==="comment"&&this.addComment(e,a)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class FE{#t=null;#e=null;#s;constructor(t){this.#s=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#s._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",Ti,{signal:e});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#s.hasCommentManager()&&this.#a("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#s.commentSelection("floating_button")}),this.#a("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#s.highlightSelection("floating_button")}),t}#r(t,e){let s=0,a=0;for(const r of t){const c=r.y+r.height;if(c<s)continue;const u=r.x+(e?r.width:0);if(c>s){a=u,s=c;continue}e?u>a&&(a=u):u<a&&(a=u)}return[e?1-a:a,s]}show(t,e,s){const[a,r]=this.#r(e,s),{style:c}=this.#e||=this.#i();t.append(this.#e),c.insetInlineEnd=`${100*a}%`,c.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#a(t,e,s,a){const r=document.createElement("button");r.classList.add("basic",t),r.tabIndex=0,r.setAttribute("data-l10n-id",e);const c=document.createElement("span");r.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",s);const u=this.#s._signal;u instanceof AbortSignal&&!u.aborted&&(r.addEventListener("contextmenu",Ti,{signal:u}),r.addEventListener("click",a,{signal:u})),this.#t.append(r)}}function eb(l,t,e){for(const s of e)t.addEventListener(s,l[s].bind(l))}class Pt{static#t=NaN;static#e=null;static#s=NaN;static#i=null;static initializeAndAddPointerId(t){(Pt.#e||=new Set).add(t)}static setPointer(t,e){Pt.#t||=e,Pt.#i??=t}static setTimeStamp(t){Pt.#s=t}static isSamePointerId(t){return Pt.#t===t}static isSamePointerIdOrRemove(t){return Pt.#t===t?!0:(Pt.#e?.delete(t),!1)}static isSamePointerType(t){return Pt.#i===t}static isInitializedAndDifferentPointerType(t){return Pt.#i!==null&&!Pt.isSamePointerType(t)}static isSameTimeStamp(t){return Pt.#s===t}static isUsingMultiplePointers(){return Pt.#e?.size>=1}static clearPointerType(){Pt.#i=null}static clearPointerIds(){Pt.#t=NaN,Pt.#e=null}static clearTimeStamp(){Pt.#s=NaN}}class HE{#t=0;get id(){return`${io}${this.#t++}`}}class Id{#t=Wv();#e=0;#s=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const r=a.decode().then(()=>(s.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return yt(this,"_isSVGFittingCanvas",r)}async#i(t,e){this.#s||=new Map;let s=this.#s.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let a;if(typeof e=="string"?(s.url=e,a=await uo(e,"blob")):e instanceof File?a=s.file=e:e instanceof Blob&&(a=e),a.type==="image/svg+xml"){const r=Id._isSVGFittingCanvas,c=new FileReader,u=new Image,d=new Promise((f,p)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,f()},c.onload=async()=>{const y=s.svgUrl=c.result;u.src=await r?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=c.onerror=p});c.readAsDataURL(a),await d}else s.bitmap=await createImageBitmap(a);s.refCounter=1}catch(a){mt(a),s=null}return this.#s.set(t,s),s&&this.#s.set(s.id,s),s}async getFromFile(t){const{lastModified:e,name:s,size:a,type:r}=t;return this.#i(`${e}_${s}_${a}_${r}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const s=await e;return this.#i(t,s)}async getFromId(t){this.#s||=new Map;const e=this.#s.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:s}=e;return delete e.blobPromise,this.getFromBlob(e.id,s)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#s||=new Map;let s=this.#s.get(t);if(s?.bitmap)return s.refCounter+=1,s;const a=new OffscreenCanvas(e.width,e.height);return a.getContext("2d").drawImage(e,0,0),s={bitmap:a.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#s.set(t,s),this.#s.set(s.id,s),s}getSvgUrl(t){const e=this.#s.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#s||=new Map;const e=this.#s.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:s}=e;if(!e.url&&!e.file){const a=new OffscreenCanvas(s.width,s.height);a.getContext("bitmaprenderer").transferFromImageBitmap(s),e.blobPromise=a.convertToBlob()}s.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class $E{#t=[];#e=!1;#s;#i=-1;constructor(t=128){this.#s=t}add({cmd:t,undo:e,post:s,mustExec:a,type:r=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(a&&t(),this.#e)return;const d={cmd:t,undo:e,post:s,type:r};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(d);return}if(c&&this.#t[this.#i].type===r){u&&(d.undo=this.#t[this.#i].undo),this.#t[this.#i]=d;return}const f=this.#i+1;f===this.#s?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class go{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Me.platform;for(const[s,a,r={}]of t)for(const c of s){const u=c.startsWith("mac+");e&&u?(this.callbacks.set(c.slice(4),{callback:a,options:r}),this.allKeys.add(c.split("+").at(-1))):!e&&!u&&(this.callbacks.set(c,{callback:a,options:r}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const s=this.callbacks.get(this.#t(e));if(!s)return;const{callback:a,options:{bubbles:r=!1,args:c=[],checker:u=null}}=s;u&&!u(t,e)||(a.bind(t,...c,e)(),r||ne(e))}}class Ud{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return PE(t),yt(this,"_colors",t)}convert(t){const e=fo(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[s,a]of this._colors)if(a.every((r,c)=>r===e[c]))return Ud._colorsMapping.get(s);return e}getHexCode(t){const e=this._colors.get(t);return e?et.makeHexColor(...e):t}}class Ys{#t=new AbortController;#e=null;#s=null;#i=new Map;#r=new Map;#a=null;#n=null;#o=null;#c=new $E;#l=null;#d=null;#h=null;#f=0;#m=new Set;#p=null;#u=null;#g=new Set;_editorUndoBar=null;#y=!1;#b=!1;#v=!1;#T=null;#S=null;#w=null;#x=null;#_=!1;#E=null;#k=new HE;#R=!1;#O=!1;#I=!1;#M=null;#L=null;#U=null;#B=null;#G=null;#C=bt.NONE;#A=new Set;#N=null;#j=null;#F=null;#Y=null;#V=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#P=null;#q=null;#J=null;#Z=null;#z=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Ys.prototype,e=c=>c.#q.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),s=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},a=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return yt(this,"_keyboardManager",new go([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#q.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#q.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}constructor(t,e,s,a,r,c,u,d,f,p,y,v,b,A,w,E){const S=this._signal=this.#t.signal;this.#q=t,this.#J=e,this.#Z=s,this.#a=a,this.#l=r,this.#j=c,this.#V=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:S}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:S}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:S}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:S}),u._on("setpreference",this.onSetPreference.bind(this),{signal:S}),u._on("switchannotationeditorparams",x=>this.updateParams(x.type,x.value),{signal:S}),window.addEventListener("pointerdown",()=>{this.#O=!0},{capture:!0,signal:S}),window.addEventListener("pointerup",()=>{this.#O=!1},{capture:!0,signal:S}),this.#rt(),this.#dt(),this.#et(),this.#n=d.annotationStorage,this.#T=d.filterFactory,this.#F=f,this.#x=p||null,this.#y=y,this.#b=v,this.#v=b,this.#G=A||null,this.viewParameters={realScale:ja.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=w||null,this._supportsPinchToZoom=E!==!1,r?.setSidebarUiManager(this)}destroy(){this.#z?.resolve(),this.#z=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#i.clear(),this.#g.clear(),this.#B?.clear(),this.#e=null,this.#A.clear(),this.#c.destroy(),this.#a?.destroy(),this.#l?.destroy(),this.#j?.destroy(),this.#E?.hide(),this.#E=null,this.#U?.destroy(),this.#U=null,this.#s=null,this.#S&&(clearTimeout(this.#S),this.#S=null),this.#P&&(clearTimeout(this.#P),this.#P=null),this._editorUndoBar?.destroy(),this.#V=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#b}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return yt(this,"hcmFilter",this.#F?this.#T.addHCMFilter(this.#F.foreground,this.#F.background):"none")}get direction(){return yt(this,"direction",getComputedStyle(this.#q).direction)}get _highlightColors(){return yt(this,"_highlightColors",this.#x?new Map(this.#x.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return yt(this,"highlightColors",null);const e=new Map,s=!!this.#F;for(const[a,r]of t){const c=a.endsWith("_HCM");if(s&&c){e.set(a.replace("_HCM",""),r);continue}!s&&!c&&e.set(a,r)}return yt(this,"highlightColors",e)}get highlightColorNames(){return yt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#U=t}editAltText(t,e=!1){this.#a?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,s,a){this.#l?.showDialog(this,t,e,s,a)}selectComment(t,e){this.#r.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,e,s=void 0){this.#l?.toggleCommentPopup(t,e,s)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#r.has(t-1))return;const{resolve:e,promise:s}=Promise.withResolvers(),a=r=>{r.pageNumber===t&&(this._eventBus._off("editorsrendered",a),e())};this._eventBus.on("editorsrendered",a),await s}getSignature(t){this.#j?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#j}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#v=e)}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#q.focus()}findParent(t,e){for(const s of this.#r.values()){const{x:a,y:r,width:c,height:u}=s.div.getBoundingClientRect();if(t>=a&&t<=a+c&&e>=r&&e<=r+u)return s}return null}disableUserSelect(t=!1){this.#J.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#g.add(t)}removeShouldRescale(t){this.#g.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*ja.PDF_TO_CSS_UNITS;for(const e of this.#g)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const s of this.#r.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t="",e=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:a,anchorOffset:r,focusNode:c,focusOffset:u}=s,d=s.toString(),p=this.#Q(s).closest(".textLayer"),y=this.getSelectionBoxes(p);if(!y)return;s.empty();const v=this.#tt(p),b=this.#C===bt.NONE,A=()=>{const w=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:a,anchorOffset:r,focusNode:c,focusOffset:u,text:d});b&&this.showAllEditors("highlight",!0,!0),e&&w?.editComment()};if(b){this.switchToMode(bt.HIGHLIGHT,A);return}A()}commentSelection(t=""){this.highlightSelection(t,!0)}#nt(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#Q(t).closest(".textLayer"),a=this.getSelectionBoxes(s);a&&(this.#E||=new FE(this),this.#E.show(s,a,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#n)return null;const e=`${io}${t}`,s=this.#n.getRawValue(e);return s&&this.#n.remove(e),s}addToAnnotationStorage(t){!t.isEmpty()&&this.#n&&!this.#n.has(t.id)&&this.#n.setValue(t.id,t)}a11yAlert(t,e=null){const s=this.#Z;s&&(s.setAttribute("data-l10n-id",t),e?s.setAttribute("data-l10n-args",JSON.stringify(e)):s.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#N&&(this.#E?.hide(),this.#N=null,this.#D({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#N)return;const a=this.#Q(t).closest(".textLayer");if(!a){this.#N&&(this.#E?.hide(),this.#N=null,this.#D({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#N=e,this.#D({hasSelectedText:!0}),!(this.#C!==bt.HIGHLIGHT&&this.#C!==bt.NONE)&&(this.#C===bt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#_=this.isShiftKeyDown,!this.isShiftKeyDown)){const r=this.#C===bt.HIGHLIGHT?this.#tt(a):null;if(r?.toggleDrawing(),this.#O){const c=new AbortController,u=this.combinedSignal(c),d=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),r?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else r?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#C===bt.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#nt()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#ot(){if(this.#w)return;this.#w=new AbortController;const t=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#A)if(e.div.contains(t)){this.#L=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,e]=this.#L;this.#L=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#M)return;this.#M=new AbortController;const t=this.combinedSignal(this.#M);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#M?.abort(),this.#M=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(e.type)){s.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const s of this.#A){const a=s.serialize(!0);a&&e.push(a)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const c of this.#u)if(c.isHandlingMimeForPasting(r.type)){c.paste(r,this.currentLayer);return}let s=e.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){mt(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const a=this.currentLayer;try{const r=[];for(const d of s){const f=await a.deserialize(d);if(!f)return;r.push(f)}const c=()=>{for(const d of r)this.#it(d);this.#st(r)},u=()=>{for(const d of r)d.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(r){mt(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#C!==bt.NONE&&!this.isEditorHandlingKeyboard&&Ys._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#D(t){Object.entries(t).some(([s,a])=>this.#X[s]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,t)}),this.#C===bt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#$([[kt.HIGHLIGHT_FREE,!0]]))}#$(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#D({isEditing:this.#C!==bt.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#D({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const e of this.#u)this.#$(e.defaultPropertiesToUpdate)}}getId(){return this.#k.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#r.set(t.pageIndex,t),this.#R?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,e=null,s=!1,a=!1,r=!1){if(this.#C!==t&&!(this.#z&&(await this.#z.promise,!this.#z))){if(this.#z=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#C===bt.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#C=t,t===bt.NONE){this.setEditingState(!1),this.#gt();for(const c of this.#i.values())c.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#z.resolve();return}for(const c of this.#i.values())c.addStandaloneCommentButton();t===bt.SIGNATURE&&await this.#j?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const c of this.#r.values())c.updateMode(t);if(t===bt.POPUP){this.#s||=await this.#V.getAnnotationsByType(new Set(this.#u.map(d=>d._editorType)));const c=new Set,u=[];for(const d of this.#i.values()){const{annotationElementId:f,hasComment:p,deleted:y}=d;f&&c.add(f),p&&!y&&u.push(d.getData())}for(const d of this.#s){const{id:f,popupRef:p,contentsObj:y}=d;p&&y?.str&&!c.has(f)&&!this.#m.has(f)&&u.push(d)}this.#l?.showSidebar(u)}if(!e){s&&this.addNewEditorFromKeyboard(),this.#z.resolve();return}for(const c of this.#i.values())c.uid===e?(this.setSelected(c),r?c.editComment():a?c.enterInEditMode():c.focus()):c.unselect();this.#z.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#C&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#u){switch(t){case kt.CREATE:this.currentLayer.addNewEditor(e);return;case kt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#Y||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const s of this.#A)s.updateParams(t,e);else for(const s of this.#u)s.updateDefaultParams(t,e)}}showAllEditors(t,e,s=!1){for(const r of this.#i.values())r.editorType===t&&r.show(e);(this.#Y?.get(kt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#$([[kt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#I!==t){this.#I=t;for(const e of this.#r.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#R){this.#R=!0;const t=[];for(const e of this.#r.values())t.push(e.enable());await Promise.all(t);for(const e of this.#i.values())e.enable()}}#gt(){if(this.unselectAll(),this.#R){this.#R=!1;for(const t of this.#r.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const e of this.#i.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#S&&clearTimeout(this.#S),this.#S=setTimeout(()=>{this.focusMainContainer(),this.#S=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#n?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#it(t){const e=this.#r.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#$(t.propertiesToUpdate))}get#pt(){let t=null;for(t of this.#A);return t}updateUI(t){this.#pt===t&&this.#$(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#$(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#A.has(t)){this.#A.delete(t),t.unselect(),this.#D({hasSelectedEditor:this.hasSelection});return}this.#A.add(t),t.select(),this.#$(t.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const e of this.#A)e!==t&&e.unselect();this.#A.clear(),this.#A.add(t),t.select(),this.#$(t.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}isSelected(t){return this.#A.has(t)}get firstSelectedEditor(){return this.#A.values().next().value}unselect(t){t.unselect(),this.#A.delete(t),this.#D({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#A.size!==0}get isEnterHandled(){return this.#A.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#D({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#c.add(t),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(t){this.#c.cleanType(t)}#W(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#A],s=()=>{this._editorUndoBar?.show(a,e.length===1?e[0].editorType:e.length);for(const r of e)r.remove()},a=()=>{for(const r of e)this.#it(r)};this.addCommands({cmd:s,undo:a,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#st(t){for(const e of this.#A)e.unselect();this.#A.clear();for(const e of t)e.isEmpty()||(this.#A.add(e),e.select());this.#D({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#A)t.commit();this.#st(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#C!==bt.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#A)t.unselect();this.#A.clear(),this.#D({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=e;const[a,r]=this.#H,c=[...this.#A],u=1e3;this.#P&&clearTimeout(this.#P),this.#P=setTimeout(()=>{this.#P=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const d of c)this.#i.has(d.id)&&(d.translateInPage(a,r),d.translationDone())},undo:()=>{for(const d of c)this.#i.has(d.id)&&(d.translateInPage(-a,-r),d.translationDone())},mustExec:!1})},u);for(const d of c)d.translateInPage(t,e),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#A)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let e=!1;for(const[{x:a,y:r,pageIndex:c},u]of t)u.newX=a,u.newY=r,u.newPageIndex=c,e||=a!==u.savedX||r!==u.savedY||c!==u.savedPageIndex;if(!e)return!1;const s=(a,r,c,u)=>{if(this.#i.has(a.id)){const d=this.#r.get(u);d?a._setParentAndPosition(d,r,c):(a.pageIndex=u,a.x=r,a.y=c)}};return this.addCommands({cmd:()=>{for(const[a,{newX:r,newY:c,newPageIndex:u}]of t)s(a,r,c,u)},undo:()=>{for(const[a,{savedX:r,savedY:c,savedPageIndex:u}]of t)s(a,r,c,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#p)for(const s of this.#p.keys())s.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#A.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#C}isEditingMode(){return this.#C!==bt.NONE}get imageManager(){return yt(this,"imageManager",new Id)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,p=e.rangeCount;f<p;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:s,y:a,width:r,height:c}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,p,y,v)=>({x:(p-a)/c,y:1-(f+y-s)/r,width:v/c,height:y/r});break;case"180":u=(f,p,y,v)=>({x:1-(f+y-s)/r,y:1-(p+v-a)/c,width:y/r,height:v/c});break;case"270":u=(f,p,y,v)=>({x:1-(p+v-a)/c,y:(f-s)/r,width:v/c,height:y/r});break;default:u=(f,p,y,v)=>({x:(f-s)/r,y:(p-a)/c,width:y/r,height:v/c});break}const d=[];for(let f=0,p=e.rangeCount;f<p;f++){const y=e.getRangeAt(f);if(!y.collapsed)for(const{x:v,y:b,width:A,height:w}of y.getClientRects())A===0||w===0||d.push(u(v,b,A,w))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const s=this.#n.getRawValue(e);s&&(this.#C===bt.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,e,s){const a=this.#B?.get(t);a&&(a.setCanvas(e,s),this.#B.delete(t))}addMissingCanvas(t,e){(this.#B||=new Map).set(t,e)}}class Hi{#t=null;#e=!1;#s=null;#i=null;#r=null;#a=null;#n=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Hi.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Hi._l10n??=t}async render(){const t=this.#s=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Hi.#f.missing),e.setAttribute("data-l10n-id",Hi.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",Ti,{signal:s}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const a=r=>{r.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",a,{capture:!0,signal:s}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(this.#n=!0,a(r))},{signal:s}),await this.#p(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#n}),this.#n=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await Hi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:s,textWithDisclaimer:a,cancel:r=!1}){s&&(this.#l=s,this.#d=a),!(this.#t===t&&this.#e===e)&&(r||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#s&&(!t&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#s.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#s?.remove(),this.#s=null,this.#i=null,this.#r=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#s;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Hi.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",Hi.#f[`${this.#m}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#r;if(!e){this.#r=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const a=100,r=this.#c._uiManager._signal;r.addEventListener("abort",()=>{clearTimeout(this.#a),this.#a=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},a)},{signal:r}),t.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#r?.classList.remove("show")},{signal:r})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Ul{#t=null;#e=null;#s=!1;#i=null;#r=null;#a=null;#n=null;#o=null;#c=!1;#l=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#i.commentButtonPosition;if(e){const{style:s}=t;s.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const a=this.#i.commentButtonColor;a&&(s.backgroundColor=a)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:s}=this.#t.getBoundingClientRect(),{x:a,y:r,width:c,height:u}=this.#i.parent.boundingClientRect;return[(t-a)/c,(e+s-r)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=this.#i._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",Ti,{signal:s}),e&&(t.addEventListener("focusin",r=>{this.#i._focusEventsAllowed=!1,ne(r)},{capture:!0,signal:s}),t.addEventListener("focusout",r=>{this.#i._focusEventsAllowed=!0,ne(r)},{capture:!0,signal:s})),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const a=r=>{r.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",a,{capture:!0,signal:s}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(this.#s=!0,a(r))},{signal:s}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:s}),t}edit(t){const e=this.commentPopupPositionInLayer;let s,a;if(e)[s,a]=e;else{[s,a]=this.#i.commentButtonPosition;const{width:p,height:y,x:v,y:b}=this.#i;s=v+s*p,a=b+a*y}const r=this.#i.parent.boundingClientRect,{x:c,y:u,width:d,height:f}=r;this.#i._uiManager.editComment(this.#i,c+s*d,u+a*f,{...t,parentDimensions:r})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#s}),this.#s=!1)}isDeleted(){return this.#c||this.#n===""}isEmpty(){return this.#n===null}hasBeenEdited(){return this.isDeleted()||this.#n!==this.#r}serialize(){return this.data}get data(){return{text:this.#n,richText:this.#a,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#n&&(this.#a=null),t===null){this.#n="",this.#c=!0;return}this.#n=t,this.#o=new Date,this.#c=!1}setInitialText(t,e=null){this.#r=t,this.data=t,this.#o=null,this.#a=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#n="",this.#a=null,this.#o=null,this.#i=null,this.#s=!1,this.#c=!1}}class hc{#t;#e=!1;#s=null;#i;#r;#a;#n;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:s=null,onPinchStart:a=null,onPinching:r=null,onPinchEnd:c=null,signal:u}){this.#t=t,this.#s=s,this.#i=e,this.#r=a,this.#a=r,this.#n=c,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/$i.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const a=this.#o=new AbortController,r=AbortSignal.any([this.#c,a.signal]),c=this.#t,u={capture:!0,signal:r,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(ne(f),d(f))},u),c.addEventListener("pointerup",d,u),c.addEventListener("pointercancel",d,u);return}if(!this.#h){this.#h=new AbortController;const a=AbortSignal.any([this.#c,this.#h.signal]),r=this.#t,c={signal:a,capture:!1,passive:!1};r.addEventListener("touchmove",this.#m.bind(this),c);const u=this.#p.bind(this);r.addEventListener("touchend",u,c),r.addEventListener("touchcancel",u,c),c.capture=!0,r.addEventListener("pointerdown",ne,c),r.addEventListener("pointermove",ne,c),r.addEventListener("pointercancel",ne,c),r.addEventListener("pointerup",ne,c),this.#r?.()}if(ne(t),t.touches.length!==2||this.#s?.()){this.#l=null;return}let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;ne(t);let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]);const{screenX:a,screenY:r}=e,{screenX:c,screenY:u}=s,d=this.#l,{touch0X:f,touch0Y:p,touch1X:y,touch1Y:v}=d,b=y-f,A=v-p,w=c-a,E=u-r,S=Math.hypot(w,E)||1,x=Math.hypot(b,A)||1;if(!this.#e&&Math.abs(x-S)<=hc.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=a,d.touch0Y=r,d.touch1X=c,d.touch1Y=u,!this.#e){this.#e=!0;return}const C=[(a+c)/2,(r+u)/2];this.#a?.(C,x,S)}#p(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#n?.()),this.#l&&(ne(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class rt{#t=null;#e=null;#s=null;#i=null;#r=null;#a=!1;#n=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#m="";#p=!1;#u=null;#g=!1;#y=!1;#b=!1;#v=null;#T=0;#S=0;#w=null;#x=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#_=!1;#E=rt._zIndex++;static _borderLineWidth=-1;static _colorManager=new Ud;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=rt.prototype._resizeWithKeyboard,e=Ys.TRANSLATE_SMALL,s=Ys.TRANSLATE_BIG;return yt(this,"_resizerKeyboardManager",new go([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],rt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:s,pageHeight:a,pageX:r,pageY:c}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,a],this.pageTranslation=[r,c];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return yt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new GE({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(rt._l10n??=t,rt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),rt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);rt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){qt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#_}set _isDraggable(t){this.#_=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#E}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#P(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#p?this.#p=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,s,a){const[r,c]=this.parentDimensions;[s,a]=this.screenToPageTranslation(s,a),this.x=(t+s)/r,this.y=(e+a)/c,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[s,a]=this.parentDimensions;this.setAt(t*s,e*a,this.width*s,this.height*a),this._onTranslated()}#k([t,e],s,a){[s,a]=this.screenToPageTranslation(s,a),this.x+=s/t,this.y+=a/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#k(this.parentDimensions,t,e)}translateInPage(t,e){this.#u||=[this.x,this.y,this.width,this.height],this.#k(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[a,r]}=this;if(this.x+=t/a,this.y+=e/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[d,f]=this.getBaseTranslation();c+=d,u+=f;const{style:p}=s;p.left=`${(100*c).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:s}=rt,a=s/t,r=s/e;switch(this.rotation){case 90:return[-a,r];case 180:return[a,r];case 270:return[a,-r];default:return[-a,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[s,a]}=this;let{x:r,y:c,width:u,height:d}=this;if(u*=s,d*=a,r*=s,c*=a,this._mustFixPosition)switch(t){case 0:r=Ue(r,0,s-u),c=Ue(c,0,a-d);break;case 90:r=Ue(r,0,s-d),c=Ue(c,u,a);break;case 180:r=Ue(r,u,s),c=Ue(c,d,a);break;case 270:r=Ue(r,d,s),c=Ue(c,0,a-u);break}this.x=r/=s,this.y=c/=a;const[f,p]=this.getBaseTranslation();r+=f,c+=p,e.left=`${(100*r).toFixed(2)}%`,e.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#R(t,e,s){switch(s){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return rt.#R(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return rt.#R(t,e,360-this.parentRotation)}#O(t){switch(t){case 90:{const[e,s]=this.pageDimensions;return[0,-e/s,s/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,s]=this.pageDimensions;return[0,e/s,-s/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,s]}=this;return[e*t,s*t]}setDims(){const{div:{style:t},width:e,height:s}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#I(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const s of t){const a=document.createElement("div");this.#c.append(a),a.classList.add("resizer",s),a.setAttribute("data-resizer-name",s),a.addEventListener("pointerdown",this.#M.bind(this,s),{signal:e}),a.addEventListener("contextmenu",Ti,{signal:e}),a.tabIndex=-1}this.div.prepend(this.#c)}#M(t,e){e.preventDefault();const{isMac:s}=Me.platform;if(e.button!==0||e.ctrlKey&&s)return;this.#s?.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const r=new AbortController,c=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",ne,{passive:!1,signal:c}),window.addEventListener("contextmenu",Ti,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{r.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#U()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#L(t,e,s,a){this.width=s,this.height=a,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#U(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:s,savedHeight:a}=this.#d;this.#d=null;const r=this.x,c=this.y,u=this.width,d=this.height;r===t&&c===e&&u===s&&d===a||this.addCommands({cmd:this.#L.bind(this,r,c,u,d),undo:this.#L.bind(this,t,e,s,a),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,e){const[s,a]=this.parentDimensions,r=this.x,c=this.y,u=this.width,d=this.height,f=rt.MIN_SIZE/s,p=rt.MIN_SIZE/a,y=this.#O(this.rotation),v=(P,G)=>[y[0]*P+y[2]*G,y[1]*P+y[3]*G],b=this.#O(360-this.rotation),A=(P,G)=>[b[0]*P+b[2]*G,b[1]*P+b[3]*G];let w,E,S=!1,x=!1;switch(t){case"topLeft":S=!0,w=(P,G)=>[0,0],E=(P,G)=>[P,G];break;case"topMiddle":w=(P,G)=>[P/2,0],E=(P,G)=>[P/2,G];break;case"topRight":S=!0,w=(P,G)=>[P,0],E=(P,G)=>[0,G];break;case"middleRight":x=!0,w=(P,G)=>[P,G/2],E=(P,G)=>[0,G/2];break;case"bottomRight":S=!0,w=(P,G)=>[P,G],E=(P,G)=>[0,0];break;case"bottomMiddle":w=(P,G)=>[P/2,G],E=(P,G)=>[P/2,0];break;case"bottomLeft":S=!0,w=(P,G)=>[0,G],E=(P,G)=>[P,0];break;case"middleLeft":x=!0,w=(P,G)=>[0,G/2],E=(P,G)=>[P,G/2];break}const C=w(u,d),k=E(u,d);let L=v(...k);const R=rt._round(r+L[0]),D=rt._round(c+L[1]);let z=1,Y=1,Q,K;if(e.fromKeyboard)({deltaX:Q,deltaY:K}=e);else{const{screenX:P,screenY:G}=e,[W,gt]=this.#l;[Q,K]=this.screenToPageTranslation(P-W,G-gt),this.#l[0]=P,this.#l[1]=G}if([Q,K]=A(Q/s,K/a),S){const P=Math.hypot(u,d);z=Y=Math.max(Math.min(Math.hypot(k[0]-C[0]-Q,k[1]-C[1]-K)/P,1/u,1/d),f/u,p/d)}else x?z=Ue(Math.abs(k[0]-C[0]-Q),f,1)/u:Y=Ue(Math.abs(k[1]-C[1]-K),p,1)/d;const dt=rt._round(u*z),St=rt._round(d*Y);L=v(...E(dt,St));const vt=R-L[0],At=D-L[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=dt,this.height=St,this.x=vt,this.y=At,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new Yr(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,s]of t)await this._editToolbar.addButton(e,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#s?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#s||(Hi.initialize(rt._l10n),this.#s=new Hi(this),this.#t&&(this.#s.data=this.#t,this.#t=null)),this.#s}get altTextData(){return this.#s?.data}set altTextData(t){this.#s&&(this.#s.data=t)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(t){await this.#s?.setGuessedText(t)}serializeAltText(t){return this.#s?.serialize(t)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.canAddComment?this.#i||=new Ul(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#i.renderForStandalone(),this.div.append(this.#r))}}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:s,deleted:a}}=this.#i;return{text:e,richText:t,date:s,deleted:a,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new Ul(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:s}){if(!e||(this.#i||=new Ul(this),this.#i.setInitialText(t,s),!this.annotationElementId))return;const a=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);a&&this.updateFromAnnotationLayer(a)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new Ul(this),this.#i.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,a]=t.rect,[r]=this.pageDimensions,[c]=this.pageTranslation,u=c+r+1,d=a-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,f,a]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#i.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#a?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#F();const[e,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/s).toFixed(2)}%`);const[a,r]=this.getInitialTranslation();return this.translate(a,r),eb(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#x||=new hc({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#C.bind(this),onPinchEnd:this.#A.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#G(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#s?.toggle(!1),this.parent.togglePointerEvents(!1)}#C(t,e,s){let r=.7*(s/e)+1-.7;if(r===1)return;const c=this.#O(this.rotation),u=(R,D)=>[c[0]*R+c[2]*D,c[1]*R+c[3]*D],[d,f]=this.parentDimensions,p=this.x,y=this.y,v=this.width,b=this.height,A=rt.MIN_SIZE/d,w=rt.MIN_SIZE/f;r=Math.max(Math.min(r,1/v,1/b),A/v,w/b);const E=rt._round(v*r),S=rt._round(b*r);if(E===v&&S===b)return;this.#u||=[p,y,v,b];const x=u(v/2,b/2),C=rt._round(p+x[0]),k=rt._round(y+x[1]),L=u(E/2,S/2);this.x=C-L[0],this.y=k-L[1],this.width=E,this.height=S,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#A(){this.#s?.toggle(!0),this.parent.togglePointerEvents(!0),this.#U()}pointerdown(t){const{isMac:e}=Me.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#p=!0,this._isDraggable){this.#j(t);return}this.#N(t)}#N(t){const{isMac:e}=Me.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#j(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let s=!1;const a=new AbortController,r=this._uiManager.combinedSignal(a),c={capture:!0,passive:!1,signal:r},u=f=>{a.abort(),this.#n=null,this.#p=!1,this._uiManager.endDragSession()||this.#N(f),s&&this._onStopDragging()};e&&(this.#T=t.clientX,this.#S=t.clientY,this.#n=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:y,pointerId:v}=f;if(v!==this.#n){ne(f);return}const[b,A]=this.screenToPageTranslation(p-this.#T,y-this.#S);this.#T=p,this.#S=y,this._uiManager.dragSelectedEditors(b,A)},c),window.addEventListener("touchmove",ne,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#x||f.isPrimary)&&u(f),ne(f)},c));const d=f=>{if(!this.#n||this.#n===f.pointerId){u(f);return}ne(f)};window.addEventListener("pointerup",d,{signal:r}),window.addEventListener("blur",d,{signal:r})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,s){t.changeParent(this),this.x=e,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,s=this.rotation){const a=this.parentScale,[r,c]=this.pageDimensions,[u,d]=this.pageTranslation,f=t/a,p=e/a,y=this.x*r,v=this.y*c,b=this.width*r,A=this.height*c;switch(s){case 0:return[y+f+u,c-v-p-A+d,y+f+b+u,c-v-p+d];case 90:return[y+p+u,c-v+f+d,y+p+A+u,c-v+f+b+d];case 180:return[y-f-b+u,c-v+p+d,y-f+u,c-v+p+A+d];case 270:return[y-p-A+u,c-v-f-b+d,y-p+u,c-v-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[s,a,r,c]=t,u=r-s,d=c-a;switch(this.rotation){case 0:return[s,e-c,u,d];case 90:return[s,e-a,d,u];case 180:return[r,e-a,u,d];case 270:return[r,e-c,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&rt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:s,opacity:a,deleted:r,richText:c},uid:u,pageIndex:d,creationDate:f,modificationDate:p}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:c,contentsObj:{str:t},creationDate:f,modificationDate:s||p,popupRef:!r,color:e,opacity:a}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:s,right:a}=this.getClientDimensions(),{innerHeight:r,innerWidth:c}=window;return e<c&&a>0&&t<r&&s>0}#F(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#F()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,s){const a=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});a.rotation=t.rotation,a.#t=t.accessibilityData,a._isCopy=t.isCopy||!1;const[r,c]=a.pageDimensions,[u,d,f,p]=a.getRectInCurrentCoords(t.rect,c);return a.x=u/r,a.y=d/c,a.width=f/r,a.height=p/c,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#P(),this.removeEditToolbar(),this.#w){for(const t of this.#w.values())clearTimeout(t);this.#w=null}this.parent=null,this.#x?.destroy(),this.#x=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#I(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[s,a,r,c]=this.getPDFRect();return[rt._round(s+(r-s)*t),rt._round(a+(c-a)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const c=this.#Y.bind(this),u=this.#V.bind(this),d=this._uiManager._signal;for(const f of this.#e){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:d}),f.addEventListener("blur",u,{signal:d}),f.addEventListener("focus",this.#X.bind(this,p),{signal:d}),f.setAttribute("data-l10n-id",rt._l10nResizer[p])}}const s=this.#e[0];let a=0;for(const c of e){if(c===s)break;a++}const r=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(r!==a){if(r<a)for(let u=0;u<a-r;u++)this.#c.append(this.#c.firstElementChild);else if(r>a)for(let u=0;u<r-a;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let c=0;for(const u of e){const f=this.#e[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",rt._l10nResizer[f])}}this.#H(0),this.#b=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Y(t){rt._resizerKeyboardManager.exec(this,t)}#V(t){this.#b&&t.relatedTarget?.parentNode!==this.#c&&this.#P()}#X(t){this.#m=this.#b?t:""}#H(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#b&&this.#B(this.#m,{deltaX:t,deltaY:e,fromKeyboard:!0})}#P(){this.#b=!1,this.#H(-1),this.#U()}_stopResizingWithKeyboard(){this.#P(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#g}set isEditing(t){this.#g=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#w||=new Map;const{action:s}=t;let a=this.#w.get(s);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(t),this.#w.delete(s),this.#w.size===0&&(this.#w=null)},rt._telemetryTimeout),this.#w.set(s,a);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#a=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#a=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const s=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),s.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class GE extends rt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const sv=3285377520,Ai=4294901760,zi=65535;class ib{constructor(t){this.h1=t?t&4294967295:sv,this.h2=t?t&4294967295:sv}update(t){let e,s;if(typeof t=="string"){e=new Uint8Array(t.length*2),s=0;for(let w=0,E=t.length;w<E;w++){const S=t.charCodeAt(w);S<=255?e[s++]=S:(e[s++]=S>>>8,e[s++]=S&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),s=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=s>>2,r=s-a*4,c=new Uint32Array(e.buffer,0,a);let u=0,d=0,f=this.h1,p=this.h2;const y=3432918353,v=461845907,b=y&zi,A=v&zi;for(let w=0;w<a;w++)w&1?(u=c[w],u=u*y&Ai|u*b&zi,u=u<<15|u>>>17,u=u*v&Ai|u*A&zi,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(d=c[w],d=d*y&Ai|d*b&zi,d=d<<15|d>>>17,d=d*v&Ai|d*A&zi,p^=d,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,r){case 3:u^=e[a*4+2]<<16;case 2:u^=e[a*4+1]<<8;case 1:u^=e[a*4],u=u*y&Ai|u*b&zi,u=u<<15|u>>>17,u=u*v&Ai|u*A&zi,a&1?f^=u:p^=u}this.h1=f,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Ai|t*36045&zi,e=e*4283543511&Ai|((e<<16|t>>>16)*2950163797&Ai)>>>16,t^=e>>>1,t=t*444984403&Ai|t*60499&zi,e=e*3301882366&Ai|((e<<16|t>>>16)*3120437893&Ai)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const _d=Object.freeze({map:null,hash:"",transfer:void 0});class jd{#t=!1;#e=null;#s=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const s=this.#i.get(t);return s===void 0?e:Object.assign(e,s)}getRawValue(t){return this.#i.get(t)}remove(t){const e=this.#i.get(t);if(e!==void 0&&(e instanceof rt&&this.#s.delete(e.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#i.values())if(s instanceof rt)return;this.onAnnotationEditor(null)}}setValue(t,e){const s=this.#i.get(t);let a=!1;if(s!==void 0)for(const[r,c]of Object.entries(e))s[r]!==c&&(a=!0,s[r]=c);else a=!0,this.#i.set(t,e);a&&this.#r(),e instanceof rt&&((this.#s||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new sb(this)}get serializable(){if(this.#i.size===0)return _d;const t=new Map,e=new ib,s=[],a=Object.create(null);let r=!1;for(const[c,u]of this.#i){const d=u instanceof rt?u.serialize(!1,a):u;d&&(t.set(c,d),e.update(`${c}:${JSON.stringify(d)}`),r||=!!d.bitmap)}if(r)for(const c of t.values())c.bitmap&&s.push(c.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:s}:_d}get editorStats(){let t=null;const e=new Map;let s=0,a=0;for(const r of this.#i.values()){if(!(r instanceof rt)){r.popup&&(r.popup.deleted?a+=1:s+=1);continue}r.isCommentDeleted?a+=1:r.hasEditedComment&&(s+=1);const c=r.telemetryFinalData;if(!c)continue;const{type:u}=c;e.has(u)||e.set(u,Object.getPrototypeOf(r).constructor),t||=Object.create(null);const d=t[u]||=new Map;for(const[f,p]of Object.entries(c)){if(f==="type")continue;let y=d.get(f);y||(y=new Map,d.set(f,y));const v=y.get(p)??0;y.set(p,v+1)}}if((a>0||s>0)&&(t||=Object.create(null),t.comments={deleted:a,edited:s}),!t)return null;for(const[r,c]of e)t[r]=c.computeTelemetryFinalData(t[r]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const s=this.#s?.get(t);return s?(s.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#s?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#s)for(const e of this.#s.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class sb extends jd{#t;constructor(t){super();const{map:e,hash:s,transfer:a}=t.serializable,r=structuredClone(e,a?{transfer:a}:null);this.#t={map:r,hash:s,transfer:a}}get print(){qt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return yt(this,"modifiedIds",{ids:new Set,hash:""})}}class qE{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(Dt(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:r,style:c}=t,u=new FontFace(a,r,c);this.addNativeFontFace(u);try{await u.load(),this.#t.add(a),s?.(t)}catch{mt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}qt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(a){throw mt(`Failed to load font '${s.family}': '${a}'.`),t.disableFontFace=!0,a}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const a=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,a)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return yt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return yt(this,"isSyncFontLoadingSupported",Ie||Me.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Dt(!a.done,"completeRequest() cannot be called twice."),a.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,a={done:!1,complete:e,callback:t};return s.push(a),a}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return yt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function s(k,L){return k.charCodeAt(L)<<24|k.charCodeAt(L+1)<<16|k.charCodeAt(L+2)<<8|k.charCodeAt(L+3)&255}function a(k,L,R,D){const z=k.substring(0,L),Y=k.substring(L+R);return z+D+Y}let r,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let f=0;function p(k,L){if(++f>30){mt("Load test font never loaded."),L();return}if(d.font="30px "+k,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){L();return}setTimeout(p.bind(null,k,L))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=a(v,976,y.length,y);const A=16,w=1482184792;let E=s(v,A);for(r=0,c=y.length-3;r<c;r+=4)E=E-w+s(y,r)|0;r<y.length&&(E=E-w+s(y+"XXX",r)|0),v=a(v,A,4,TE(E));const S=`url(data:font/opentype;base64,${btoa(v)});`,x=`@font-face {font-family:"${y}";src:${S}}`;this.insertRule(x);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const k of[t.loadedName,y]){const L=this._document.createElement("span");L.textContent="Hi",L.style.fontFamily=k,C.append(L)}this._document.body.append(C),p(y,()=>{C.remove(),e.complete()})}}class VE{#t;constructor(t,e=null,s,a){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,s&&Object.assign(this,s),a&&(this.charProcOperatorList=a)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Qv(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const s=this.loadedName+"_path_"+e;let a;try{a=t.get(s)}catch(c){mt(`getPathGenerator - ignoring character: "${c}".`)}const r=tb(a);return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[e]=r}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){yt(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){yt(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class La{#t;#e;#s;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,s={};let a=0;for(const f of La.strings){const p=e.encode(t[f]);s[f]=p,a+=4+p.length}const r=new ArrayBuffer(a),c=new Uint8Array(r),u=new DataView(r);let d=0;for(const f of La.strings){const p=s[f],y=p.length;u.setUint32(d,y),c.set(p,d+4),d+=4+y}return Dt(d===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#s=new TextDecoder}#i(t){Dt(t<La.strings.length,"Invalid string index");let e=0;for(let a=0;a<t;a++)e+=this.#e.getUint32(e)+4;const s=this.#e.getUint32(e);return this.#s.decode(new Uint8Array(this.#t,e+4,s))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class Ba{#t;#e;#s;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,s={};let a=0;for(const v of Ba.strings){const b=e.encode(t[v]);s[v]=b,a+=4+b.length}a+=4;let r,c,u=1+a;t.style&&(r=e.encode(t.style.style),c=e.encode(t.style.weight),u+=4+r.length+4+c.length);const d=new ArrayBuffer(u),f=new Uint8Array(d),p=new DataView(d);let y=0;p.setUint8(y++,t.guessFallback?1:0),p.setUint32(y,0),y+=4,a=0;for(const v of Ba.strings){const b=s[v],A=b.length;a+=4+A,p.setUint32(y,A),f.set(b,y+4),y+=4+A}return p.setUint32(y-a-4,a),t.style&&(p.setUint32(y,r.length),f.set(r,y+4),y+=4+r.length,p.setUint32(y,c.length),f.set(c,y+4),y+=4+c.length),Dt(y<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(y)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#s=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Dt(t<Ba.strings.length,"Invalid string index");let e=5;for(let a=0;a<t;a++)e+=this.#e.getUint32(e)+4;const s=this.#e.getUint32(e);return this.#s.decode(new Uint8Array(this.#t,e+4,s))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),s=this.#s.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const a=this.#e.getUint32(t),r=this.#s.decode(new Uint8Array(this.#t,t+4,a));return{style:s,weight:r}}}class Ht{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#s=this.#e+1+8;static#i=this.#s+1+48;static#r=this.#i+1+6;#a;#n;#o;constructor({data:t,extra:e}){this.#a=t,this.#n=new TextDecoder,this.#o=new DataView(this.#a),e&&Object.assign(this,e)}#c(t){Dt(t<Ht.bools.length,"Invalid boolean index");const e=Math.floor(t/4),s=t*2%8,a=this.#o.getUint8(e)>>s&3;return a===0?void 0:a===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Dt(t<Ht.numbers.length,"Invalid number index"),this.#o.getFloat64(Ht.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Ht.#e;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<4;a++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=Ht.#s;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<6;a++)s.push(this.#o.getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=Ht.#i;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<3;a++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}#d(t){Dt(t<Ht.strings.length,"Invalid string index");let e=Ht.#r+4;for(let r=0;r<t;r++)e+=this.#o.getUint32(e)+4;const s=this.#o.getUint32(e),a=new Uint8Array(s);return a.set(new Uint8Array(this.#a,e+4,s)),this.#n.decode(a)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Ht.#r;const e=this.#o.getUint32(t);t+=4+e;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);t+=4+a;const r=this.#o.getUint32(t);if(r!==0)return new Uint8Array(this.#a,t+4,r)}clearData(){let t=Ht.#r;const e=this.#o.getUint32(t);t+=4+e;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);t+=4+a;const r=this.#o.getUint32(t);new Uint8Array(this.#a,t+4,r).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Ht.#r;const e=this.#o.getUint32(t);t+=4+e;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);if(a===0)return null;const r=new Uint8Array(a);return r.set(new Uint8Array(this.#a,t+4,a)),new La(r.buffer)}get systemFontInfo(){let t=Ht.#r;const e=this.#o.getUint32(t);t+=4+e;const s=this.#o.getUint32(t);if(s===0)return null;const a=new Uint8Array(s);return a.set(new Uint8Array(this.#a,t+4,s)),new Ba(a.buffer)}static write(t){const e=t.systemFontInfo?Ba.write(t.systemFontInfo):null,s=t.cssFontInfo?La.write(t.cssFontInfo):null,a=new TextEncoder,r={};let c=0;for(const w of Ht.strings)r[w]=a.encode(t[w]),c+=4+r[w].length;const u=Ht.#r+4+c+4+(e?e.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),d=new ArrayBuffer(u),f=new Uint8Array(d),p=new DataView(d);let y=0;const v=Ht.bools.length;let b=0,A=0;for(let w=0;w<v;w++){const E=t[Ht.bools[w]];b|=(E===void 0?0:E?2:1)<<A,A+=2,(A===8||w===v-1)&&(p.setUint8(y++,b),b=0,A=0)}Dt(y===Ht.#t,"FontInfo.write: Boolean properties offset mismatch");for(const w of Ht.numbers)p.setFloat64(y,t[w]),y+=8;if(Dt(y===Ht.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){p.setUint8(y++,4);for(const w of t.bbox)p.setInt16(y,w,!0),y+=2}else p.setUint8(y++,0),y+=8;if(Dt(y===Ht.#s,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){p.setUint8(y++,6);for(const w of t.fontMatrix)p.setFloat64(y,w,!0),y+=8}else p.setUint8(y++,0),y+=48;if(Dt(y===Ht.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){p.setUint8(y++,1);for(const w of t.defaultVMetrics)p.setInt16(y,w,!0),y+=2}else p.setUint8(y++,0),y+=6;Dt(y===Ht.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(Ht.#r,0),y+=4;for(const w of Ht.strings){const E=r[w],S=E.length;p.setUint32(y,S),f.set(E,y+4),y+=4+S}if(p.setUint32(Ht.#r,y-Ht.#r-4),!e)p.setUint32(y,0),y+=4;else{const w=e.byteLength;p.setUint32(y,w),Dt(y+4+w<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),y+4),y+=4+w}if(!s)p.setUint32(y,0),y+=4;else{const w=s.byteLength;p.setUint32(y,w),Dt(y+4+w<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(s),y+4),y+=4+w}return t.data===void 0?(p.setUint32(y,0),y+=4):(p.setUint32(y,t.data.length),f.set(t.data,y+4),y+=4+t.data.length),Dt(y<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(y)}}class _e{static#t=0;static#e=1;static#s=2;static#i=3;static#r=4;static#a=8;static#n=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,s=null,a=[],r=[],c=[],u=[],d=null,f=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,s=t[2],c=t[3],e===1?a.push(...t[4],...t[5]):a.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,d=t[1],a=t[2],r=t[3],u=t[4]||[],s=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const p=Math.floor(a.length/2),y=Math.floor(r.length/3),v=c.length,b=u.length;let A=0;for(const L of u)A+=1,A=Math.ceil(A/4)*4,A+=4+L.coords.length*4,A+=4+L.colors.length*4,L.verticesPerRow!==void 0&&(A+=4);const w=20+p*8+y*3+v*8+(s?16:0)+(f?3:0)+A,E=new ArrayBuffer(w),S=new DataView(E),x=new Uint8Array(E);S.setUint8(_e.#t,e),S.setUint8(_e.#e,s?1:0),S.setUint8(_e.#s,f?1:0),S.setUint8(_e.#i,d),S.setUint32(_e.#r,p,!0),S.setUint32(_e.#a,y,!0),S.setUint32(_e.#n,v,!0),S.setUint32(_e.#o,b,!0);let C=20;new Float32Array(E,C,p*2).set(a),C+=p*8,x.set(r,C),C+=y*3;for(const[L,R]of c)S.setFloat32(C,L,!0),C+=4,S.setUint32(C,parseInt(R.slice(1),16),!0),C+=4;if(s)for(const L of s)S.setFloat32(C,L,!0),C+=4;f&&(x.set(f,C),C+=3);for(let L=0;L<u.length;L++){const R=u[L];S.setUint8(C,R.type),C+=1,C=Math.ceil(C/4)*4,S.setUint32(C,R.coords.length,!0),C+=4,new Int32Array(E,C,R.coords.length).set(R.coords),C+=R.coords.length*4,S.setUint32(C,R.colors.length,!0),C+=4,new Int32Array(E,C,R.colors.length).set(R.colors),C+=R.colors.length*4,R.verticesPerRow!==void 0&&(S.setUint32(C,R.verticesPerRow,!0),C+=4)}return E}getIR(){const t=this.view,e=this.data[_e.#t],s=!!this.data[_e.#e],a=!!this.data[_e.#s],r=t.getUint32(_e.#r,!0),c=t.getUint32(_e.#a,!0),u=t.getUint32(_e.#n,!0),d=t.getUint32(_e.#o,!0);let f=20;const p=new Float32Array(this.buffer,f,r*2);f+=r*8;const y=new Uint8Array(this.buffer,f,c*3);f+=c*3;const v=[];for(let E=0;E<u;++E){const S=t.getFloat32(f,!0);f+=4;const x=t.getUint32(f,!0);f+=4,v.push([S,`#${x.toString(16).padStart(6,"0")}`])}let b=null;if(s){b=[];for(let E=0;E<4;++E)b.push(t.getFloat32(f,!0)),f+=4}let A=null;a&&(A=new Uint8Array(this.buffer,f,3),f+=3);const w=[];for(let E=0;E<d;++E){const S=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const x=t.getUint32(f,!0);f+=4;const C=new Int32Array(this.buffer,f,x);f+=x*4;const k=t.getUint32(f,!0);f+=4;const L=new Int32Array(this.buffer,f,k);f+=k*4;const R={type:S,coords:C,colors:L};S===pd.LATTICE&&(R.verticesPerRow=t.getUint32(f,!0),f+=4),w.push(R)}if(e===1)return["RadialAxial","axial",b,v,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",b,v,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(e===3){const E=this.data[_e.#i];let S=null;if(p.length>0){let x=p[0],C=p[0],k=p[1],L=p[1];for(let R=0;R<p.length;R+=2){const D=p[R],z=p[R+1];x=x>D?D:x,k=k>z?z:k,C=C<D?D:C,L=L<z?z:L}S=[x,k,C,L]}return["Mesh",E,p,y,w,S,b,A]}throw new Error(`Unsupported pattern kind: ${e}`)}}function YE(l){if(l instanceof URL)return l.href;if(typeof l=="string"){if(Ie)return l;const t=URL.parse(l,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function XE(l){if(Ie&&typeof Buffer<"u"&&l instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength)return l;if(typeof l=="string")return co(l);if(l instanceof ArrayBuffer||ArrayBuffer.isView(l)||typeof l=="object"&&!isNaN(l?.length))return new Uint8Array(l);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function jl(l){if(typeof l!="string")return null;if(l.endsWith("/"))return l;throw new Error(`Invalid factory url: "${l}" must include trailing slash.`)}const wd=l=>typeof l=="object"&&Number.isInteger(l?.num)&&l.num>=0&&Number.isInteger(l?.gen)&&l.gen>=0,KE=l=>typeof l=="object"&&typeof l?.name=="string",WE=kE.bind(null,wd,KE);class QE{#t=new Map;#e=Promise.resolve();postMessage(t,e){const s={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[a]of this.#t)a.call(this,s)})}addEventListener(t,e,s=null){let a=null;if(s?.signal instanceof AbortSignal){const{signal:r}=s;if(r.aborted){mt("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,e);a=()=>r.removeEventListener("abort",c),r.addEventListener("abort",c)}this.#t.set(e,a)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const zl={DATA:1,ERROR:2},fe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function nv(){}function Ke(l){if(l instanceof Vs||l instanceof md||l instanceof Wy||l instanceof tc||l instanceof Kh)return l;switch(l instanceof Error||typeof l=="object"&&l!==null||qt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),l.name){case"AbortException":return new Vs(l.message);case"InvalidPDFException":return new md(l.message);case"PasswordException":return new Wy(l.message,l.code);case"ResponseException":return new tc(l.message,l.status,l.missing);case"UnknownErrorException":return new Kh(l.message,l.details)}return new Kh(l.message,l.toString())}class Hr{#t=new AbortController;constructor(t,e,s){this.sourceName=t,this.targetName=e,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const s=t.callbackId,a=this.callbackCapabilities[s];if(!a)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===zl.DATA)a.resolve(t.data);else if(t.callback===zl.ERROR)a.reject(Ke(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,a=t.sourceName,r=this.comObj;Promise.try(e,t.data).then(function(c){r.postMessage({sourceName:s,targetName:a,callback:zl.DATA,callbackId:t.callbackId,data:c})},function(c){r.postMessage({sourceName:s,targetName:a,callback:zl.ERROR,callbackId:t.callbackId,reason:Ke(c)})});return}if(t.streamId){this.#s(t);return}e(t.data)}on(t,e){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=e}send(t,e,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},s)}sendWithPromise(t,e,s){const a=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[a]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:e},s)}catch(c){r.reject(c)}return r.promise}sendWithStream(t,e,s,a){const r=this.streamId++,c=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[r]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:c,targetName:u,action:t,streamId:r,data:e,desiredSize:f.desiredSize},a),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[r].pullCall=p,d.postMessage({sourceName:c,targetName:u,stream:fe.PULL,streamId:r,desiredSize:f.desiredSize}),p.promise},cancel:f=>{Dt(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[r].cancelCall=p,this.streamControllers[r].isClosed=!0,d.postMessage({sourceName:c,targetName:u,stream:fe.CANCEL,streamId:r,reason:Ke(f)}),p.promise}},s)}#s(t){const e=t.streamId,s=this.sourceName,a=t.sourceName,r=this.comObj,c=this,u=this.actionHandler[t.action],d={enqueue(f,p=1,y){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=p,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:a,stream:fe.ENQUEUE,streamId:e,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:a,stream:fe.CLOSE,streamId:e}),delete c.streamSinks[e])},error(f){Dt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:a,stream:fe.ERROR,streamId:e,reason:Ke(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[e]=d,Promise.try(u,t.data,d).then(function(){r.postMessage({sourceName:s,targetName:a,stream:fe.START_COMPLETE,streamId:e,success:!0})},function(f){r.postMessage({sourceName:s,targetName:a,stream:fe.START_COMPLETE,streamId:e,reason:Ke(f)})})}#i(t){const e=t.streamId,s=this.sourceName,a=t.sourceName,r=this.comObj,c=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case fe.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(Ke(t.reason));break;case fe.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(Ke(t.reason));break;case fe.PULL:if(!u){r.postMessage({sourceName:s,targetName:a,stream:fe.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||nv).then(function(){r.postMessage({sourceName:s,targetName:a,stream:fe.PULL_COMPLETE,streamId:e,success:!0})},function(f){r.postMessage({sourceName:s,targetName:a,stream:fe.PULL_COMPLETE,streamId:e,reason:Ke(f)})});break;case fe.ENQUEUE:if(Dt(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case fe.CLOSE:if(Dt(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#r(c,e);break;case fe.ERROR:Dt(c,"error should have stream controller"),c.controller.error(Ke(t.reason)),this.#r(c,e);break;case fe.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(Ke(t.reason)),this.#r(c,e);break;case fe.CANCEL:if(!u)break;const d=Ke(t.reason);Promise.try(u.onCancel||nv,d).then(function(){r.postMessage({sourceName:s,targetName:a,stream:fe.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){r.postMessage({sourceName:s,targetName:a,stream:fe.CANCEL_COMPLETE,streamId:e,reason:Ke(f)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#r(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class nb{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,e);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,s){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){qt("Abstract method `_createCanvas` called.")}}class JE extends nb{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const s=this._document.createElement("canvas");return s.width=t,s.height=e,s}}class ab{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){qt("Abstract method `_fetch` called.")}}class av extends ab{async _fetch(t){const e=await uo(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):co(e)}}class rb{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,s,a,r){return"none"}destroy(t=!1){}}class ZE extends rb{#t;#e;#s;#i;#r;#a;#n=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#r=e}get#o(){return this.#e||=new Map}get#c(){return this.#a||=new Map}get#l(){if(!this.#s){const t=this.#r.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const s=this.#r.createElementNS(cs,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#s=this.#r.createElementNS(cs,"defs"),t.append(s),s.append(this.#s),this.#r.body.append(t)}return this.#s}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let y=0;y<256;y++)f[y]=d[y]/255;const p=f.join(",");return[p,p,p]}const[e,s,a]=t,r=new Array(256),c=new Array(256),u=new Array(256);for(let d=0;d<256;d++)r[d]=e[d]/255,c[d]=s[d]/255,u[d]=a[d]/255;return[r.join(","),c.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#r.URL;e!==this.#r.baseURI&&(uc(e)?mt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=Xv(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[s,a,r]=this.#d(t),c=t.length===1?s:`${s}${a}${r}`;if(e=this.#o.get(c),e)return this.#o.set(t,e),e;const u=`g_${this.#i}_transfer_map_${this.#n++}`,d=this.#h(u);this.#o.set(t,d),this.#o.set(c,d);const f=this.#p(u);return this.#g(s,a,r,f),d}addHCMFilter(t,e){const s=`${t}-${e}`,a="base";let r=this.#c.get(a);if(r?.key===s||(r?(r.filter?.remove(),r.key=s,r.url="none",r.filter=null):(r={key:s,url:"none",filter:null},this.#c.set(a,r)),!t||!e))return r.url;const c=this.#b(t);t=et.makeHexColor(...c);const u=this.#b(e);if(e=et.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return r.url;const d=new Array(256);for(let b=0;b<=255;b++){const A=b/255;d[b]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const f=d.join(","),p=`g_${this.#i}_hcm_filter`,y=r.filter=this.#p(p);this.#g(f,f,f,y),this.#m(y);const v=(b,A)=>{const w=c[b]/255,E=u[b]/255,S=new Array(A+1);for(let x=0;x<=A;x++)S[x]=w+x/A*(E-w);return S.join(",")};return this.#g(v(0,5),v(1,5),v(2,5),y),r.url=this.#h(p),r.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[s]=this.#d([t]),a=`alpha_${s}`;if(e=this.#o.get(a),e)return this.#o.set(t,e),e;const r=`g_${this.#i}_alpha_map_${this.#n++}`,c=this.#h(r);this.#o.set(t,c),this.#o.set(a,c);const u=this.#p(r);return this.#y(s,u),c}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let s,a;if(t?([s]=this.#d([t]),a=`luminosity_${s}`):a="luminosity",e=this.#o.get(a),e)return this.#o.set(t,e),e;const r=`g_${this.#i}_luminosity_map_${this.#n++}`,c=this.#h(r);this.#o.set(t,c),this.#o.set(a,c);const u=this.#p(r);return this.#f(u),t&&this.#y(s,u),c}addHighlightHCMFilter(t,e,s,a,r){const c=`${e}-${s}-${a}-${r}`;let u=this.#c.get(t);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#c.set(t,u)),!e||!s))return u.url;const[d,f]=[e,s].map(this.#b.bind(this));let p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[v,b]=[a,r].map(this.#b.bind(this));y<p&&([p,y,v,b]=[y,p,b,v]),this.#l.style.color="";const A=(S,x,C)=>{const k=new Array(256),L=(y-p)/C,R=S/255,D=(x-S)/(255*C);let z=0;for(let Y=0;Y<=C;Y++){const Q=Math.round(p+Y*L),K=R+Y*D;for(let dt=z;dt<=Q;dt++)k[dt]=K;z=Q+1}for(let Y=z;Y<256;Y++)k[Y]=k[z-1];return k.join(",")},w=`g_${this.#i}_hcm_${t}_filter`,E=u.filter=this.#p(w);return this.#m(E),this.#g(A(v[0],b[0],5),A(v[1],b[1],5),A(v[2],b[2],5),E),u.url=this.#h(w),u.url}destroy(t=!1){t&&this.#a?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#e?.clear(),this.#e=null,this.#a?.clear(),this.#a=null,this.#n=0)}#f(t){const e=this.#r.createElementNS(cs,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#m(t){const e=this.#r.createElementNS(cs,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#r.createElementNS(cs,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#u(t,e,s){const a=this.#r.createElementNS(cs,e);a.setAttribute("type","discrete"),a.setAttribute("tableValues",s),t.append(a)}#g(t,e,s,a){const r=this.#r.createElementNS(cs,"feComponentTransfer");a.append(r),this.#u(r,"feFuncR",t),this.#u(r,"feFuncG",e),this.#u(r,"feFuncB",s)}#y(t,e){const s=this.#r.createElementNS(cs,"feComponentTransfer");e.append(s),this.#u(s,"feFuncA",t)}#b(t){return this.#l.style.color=t,fo(getComputedStyle(this.#l).getPropertyValue("color"))}}class ob{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){qt("Abstract method `_fetch` called.")}}class rv extends ob{async _fetch(t){const e=await uo(t,"arraybuffer");return new Uint8Array(e)}}class lb{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){qt("Abstract method `_fetch` called.")}}class ov extends lb{async _fetch(t){const e=await uo(t,"arraybuffer");return new Uint8Array(e)}}Ie&&mt("Please use the `legacy` build in Node.js environments.");async function zd(l){const e=await process.getBuiltinModule("fs").promises.readFile(l);return new Uint8Array(e)}class tT extends rb{}class eT extends nb{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class iT extends ab{async _fetch(t){return zd(t)}}class sT extends ob{async _fetch(t){return zd(t)}}class nT extends lb{async _fetch(t){return zd(t)}}const Aa="__forcedDependency",{floor:lv,ceil:cv}=Math;function Fl(l,t,e,s,a,r){l[t*4+0]=Math.min(l[t*4+0],e),l[t*4+1]=Math.min(l[t*4+1],s),l[t*4+2]=Math.max(l[t*4+2],a),l[t*4+3]=Math.max(l[t*4+3],r)}const Ad=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class aT{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Ad}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Hl=(l,t)=>{if(!l)return;let e=l.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},l.set(t,e)),e};class rT{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Aa]:[]};#s=new Map;#i=[];#r=[];#a=[[1,0,0,1,0,0]];#n=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#m;#p;#u;#g;constructor(t,e,s=!1){this.#f=t.width,this.#m=t.height,this.#y(e),s&&(this.#g=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,e){const s=new ArrayBuffer(t*4);this.#p=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),e&&e.length>0?(this.#u.set(e),this.#u.fill(Ad,e.length)):this.#u.fill(Ad)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Aa]:{__proto__:this.#e[Aa]}},this.#n={__proto__:this.#n},this.#i.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#n=Object.getPrototypeOf(this.#n);const s=this.#i.pop();return s!==void 0&&(Hl(this.#g,t)?.dependencies.add(s),this.#u[t]=this.#u[s]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const e=this.#i.pop();return e!==void 0&&(Hl(this.#g,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}beginMarkedContent(t){return this.#r.push(t),this}endMarkedContent(t){const e=this.#r.pop();return e!==void 0&&(Hl(this.#g,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}pushBaseTransform(t){return this.#a.push(et.multiplyByDOMMatrix(this.#a.at(-1),t.getTransform())),this}popBaseTransform(){return this.#a.length>1&&this.#a.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#s.set(t,e),this}recordSimpleDataFromNamed(t,e,s){this.#t[t]=this.#s.get(e)??s}recordFutureForcedDependency(t,e){return this.recordIncrementalData(Aa,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(Aa,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,s,a,r,c){const u=et.multiplyByDOMMatrix(this.#a.at(-1),e.getTransform()),d=[1/0,1/0,-1/0,-1/0];et.axialAlignedBoundingBox([s,r,a,c],u,d);const f=et.intersect(this.#n,d);return f?(this.#n[0]=f[0],this.#n[1]=f[1],this.#n[2]=f[2],this.#n[3]=f[3]):(this.#n[0]=this.#n[1]=1/0,this.#n[2]=this.#n[3]=-1/0),this}recordBBox(t,e,s,a,r,c){const u=this.#n;if(u[0]===1/0)return this;const d=et.multiplyByDOMMatrix(this.#a.at(-1),e.getTransform());if(u[0]===-1/0)return et.axialAlignedBoundingBox([s,r,a,c],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return et.axialAlignedBoundingBox([s,r,a,c],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,e,s,a=1,r=0,c=0,u){const d=s.bbox;let f,p;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#h.get(s),f!==!1&&(p=[0,0,0,0],et.axialAlignedBoundingBox(d,s.fontMatrix,p),(a!==1||r!==0||c!==0)&&et.scaleMinMax([a,0,0,-a,r,c],p),f)))return this.recordBBox(t,e,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return d&&p&&f===void 0&&(f=p[0]<=r-y.actualBoundingBoxLeft&&p[2]>=r+y.actualBoundingBoxRight&&p[1]<=c-y.actualBoundingBoxAscent&&p[3]>=c+y.actualBoundingBoxDescent,this.#h.set(s,f),f)?this.recordBBox(t,e,p[0],p[2],p[1],p[3]):this.recordBBox(t,e,r-y.actualBoundingBoxLeft,r+y.actualBoundingBoxRight,c-y.actualBoundingBoxAscent,c+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#n[0]),this.#o[1]=Math.max(0,this.#n[1]),this.#o[2]=Math.min(this.#f,this.#n[2]),this.#o[3]=Math.min(this.#m,this.#n[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const s=this.#l,a=this.#t,r=this.#e;for(const c of e)c in this.#t?s.add(a[c]):c in r&&r[c].forEach(s.add,s);return this}recordNamedDependency(t,e){return this.#s.has(e)&&this.#l.add(this.#s.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[Aa]),this.#g){const s=Hl(this.#g,t),{dependencies:a}=s;this.#l.forEach(a.add,a),this.#i.forEach(a.add,a),this.#r.forEach(a.add,a),a.delete(t),s.isRenderingOperation=!0}if(this.#c===t){const s=lv(this.#o[0]*256/this.#f),a=lv(this.#o[1]*256/this.#m),r=cv(this.#o[2]*256/this.#f),c=cv(this.#o[3]*256/this.#m);Fl(this.#p,t,s,a,r,c);for(const u of this.#l)u!==t&&Fl(this.#p,u,s,a,r,c);for(const u of this.#i)u!==t&&Fl(this.#p,u,s,a,r,c);for(const u of this.#r)u!==t&&Fl(this.#p,u,s,a,r,c);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const s=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const a of s)this.recordIncrementalData("sameLineText",a);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#n[0]=Math.max(this.#n[0],this.#o[0]),this.#n[1]=Math.max(this.#n[1],this.#o[1]),this.#n[2]=Math.min(this.#n[2],this.#o[2]),this.#n[3]=Math.min(this.#n[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#h.clear(),new aT(this.#u,this.#p)}takeDebugMetadata(){return this.#g}}class ec{#t;#e;#s;#i=0;#r=0;constructor(t,e,s){if(t instanceof ec&&t.#s===!!s)return t;this.#t=t,this.#e=e,this.#s=!!s}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#r++,this.#t.save(this.#e),this}restore(t){return this.#r>0&&(this.#t.restore(this.#e),this.#r--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,s){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#s||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,s,a,r,c){return this.#s||this.#t.recordClipBox(this.#e,e,s,a,r,c),this}recordBBox(t,e,s,a,r,c){return this.#s||this.#t.recordBBox(this.#e,e,s,a,r,c),this}recordCharacterBBox(t,e,s,a,r,c,u){return this.#s||this.#t.recordCharacterBBox(this.#e,e,s,a,r,c,u),this}recordFullPageBBox(t){return this.#s||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#s||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Si={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},De={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Sd(l,t){if(!t)return;const e=t[2]-t[0],s=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],e,s),l.clip(a)}class Fd{isModifyingCurrentTransform(){return!1}getPattern(){qt("Abstract method `getPattern` called.")}}class oT extends Fd{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)e.addColorStop(s[0],s[1]);return e}getPattern(t,e,s,a){let r;if(a===De.STROKE||a===De.FILL){const c=e.current.getClippedPathBoundingBox(a,Jt(t))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,d=Math.ceil(c[3]-c[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,d),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-c[0],-c[1]),s=et.transform(s,[1,0,0,1,c[0],c[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),Sd(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),r=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(s);r.setTransform(y)}else Sd(t,this._bbox),r=this._createGradient(t);return r}}function Jh(l,t,e,s,a,r,c,u){const d=t.coords,f=t.colors,p=l.data,y=l.width*4;let v;d[e+1]>d[s+1]&&(v=e,e=s,s=v,v=r,r=c,c=v),d[s+1]>d[a+1]&&(v=s,s=a,a=v,v=c,c=u,u=v),d[e+1]>d[s+1]&&(v=e,e=s,s=v,v=r,r=c,c=v);const b=(d[e]+t.offsetX)*t.scaleX,A=(d[e+1]+t.offsetY)*t.scaleY,w=(d[s]+t.offsetX)*t.scaleX,E=(d[s+1]+t.offsetY)*t.scaleY,S=(d[a]+t.offsetX)*t.scaleX,x=(d[a+1]+t.offsetY)*t.scaleY;if(A>=x)return;const C=f[r],k=f[r+1],L=f[r+2],R=f[c],D=f[c+1],z=f[c+2],Y=f[u],Q=f[u+1],K=f[u+2],dt=Math.round(A),St=Math.round(x);let vt,At,P,G,W,gt,Et,M;for(let H=dt;H<=St;H++){if(H<E){const lt=H<A?0:(A-H)/(A-E);vt=b-(b-w)*lt,At=C-(C-R)*lt,P=k-(k-D)*lt,G=L-(L-z)*lt}else{let lt;H>x?lt=1:E===x?lt=0:lt=(E-H)/(E-x),vt=w-(w-S)*lt,At=R-(R-Y)*lt,P=D-(D-Q)*lt,G=z-(z-K)*lt}let X;H<A?X=0:H>x?X=1:X=(A-H)/(A-x),W=b-(b-S)*X,gt=C-(C-Y)*X,Et=k-(k-Q)*X,M=L-(L-K)*X;const J=Math.round(Math.min(vt,W)),ot=Math.round(Math.max(vt,W));let ft=y*H+J*4;for(let lt=J;lt<=ot;lt++)X=(vt-lt)/(vt-W),X<0?X=0:X>1&&(X=1),p[ft++]=At-(At-gt)*X|0,p[ft++]=P-(P-Et)*X|0,p[ft++]=G-(G-M)*X|0,p[ft++]=255}}function lT(l,t,e){const s=t.coords,a=t.colors;let r,c;switch(t.type){case pd.LATTICE:const u=t.verticesPerRow,d=Math.floor(s.length/u)-1,f=u-1;for(r=0;r<d;r++){let p=r*u;for(let y=0;y<f;y++,p++)Jh(l,e,s[p],s[p+1],s[p+u],a[p],a[p+1],a[p+u]),Jh(l,e,s[p+u+1],s[p+1],s[p+u],a[p+u+1],a[p+1],a[p+u])}break;case pd.TRIANGLES:for(r=0,c=s.length;r<c;r+=3)Jh(l,e,s[r],s[r+1],s[r+2],a[r],a[r+1],a[r+2]);break;default:throw new Error("illegal figure")}}class cT extends Fd{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,s){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-d,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),b=f/y,A=p/v,w={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/b,scaleY:1/A},E=y+4,S=v+4,x=s.getCanvas("mesh",E,S),C=x.context,k=C.createImageData(y,v);if(e){const R=k.data;for(let D=0,z=R.length;D<z;D+=4)R[D]=e[0],R[D+1]=e[1],R[D+2]=e[2],R[D+3]=255}for(const R of this._figures)lT(k,R,w);return C.putImageData(k,2,2),{canvas:x.canvas,offsetX:u-2*b,offsetY:d-2*A,scaleX:b,scaleY:A}}isModifyingCurrentTransform(){return!0}getPattern(t,e,s,a){Sd(t,this._bbox);const r=new Float32Array(2);if(a===De.SHADING)et.singularValueDecompose2dScale(Jt(t),r);else if(this.matrix){et.singularValueDecompose2dScale(this.matrix,r);const[u,d]=r;et.singularValueDecompose2dScale(e.baseTransform,r),r[0]*=u,r[1]*=d}else et.singularValueDecompose2dScale(e.baseTransform,r);const c=this._createMeshCanvas(r,a===De.SHADING?null:this._background,e.cachedCanvases);return a!==De.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class uT extends Fd{getPattern(){return"hotpink"}}function hT(l){switch(l[0]){case"RadialAxial":return new oT(l);case"Mesh":return new cT(l);case"Dummy":return new uT}throw new Error(`Unknown IR type: ${l[0]}`)}const uv={COLORED:1,UNCOLORED:2};class Hd{static MAX_PATTERN_SIZE=3e3;constructor(t,e,s,a){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=s,this.baseTransform=a}createPatternCanvas(t,e){const{bbox:s,operatorList:a,paintType:r,tilingType:c,color:u,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),cc("TilingType: "+c);const y=s[0],v=s[1],b=s[2],A=s[3],w=b-y,E=A-v,S=new Float32Array(2);et.singularValueDecompose2dScale(this.matrix,S);const[x,C]=S;et.singularValueDecompose2dScale(this.baseTransform,S);const k=x*S[0],L=C*S[1];let R=w,D=E,z=!1,Y=!1;const Q=Math.ceil(f*k),K=Math.ceil(p*L),dt=Math.ceil(w*k),St=Math.ceil(E*L);Q>=dt?R=f:z=!0,K>=St?D=p:Y=!0;const vt=this.getSizeAndScale(R,this.ctx.canvas.width,k),At=this.getSizeAndScale(D,this.ctx.canvas.height,L),P=t.cachedCanvases.getCanvas("pattern",vt.size,At.size),G=P.context,W=d.createCanvasGraphics(G,e);if(W.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(W,r,u),G.translate(-vt.scale*y,-At.scale*v),W.transform(0,vt.scale,0,0,At.scale,0,0),G.save(),W.dependencyTracker?.save(),this.clipBbox(W,y,v,b,A),W.baseTransform=Jt(W.ctx),W.executeOperatorList(a),W.endDrawing(),W.dependencyTracker?.restore(),G.restore(),z||Y){const gt=P.canvas;z&&(R=f),Y&&(D=p);const Et=this.getSizeAndScale(R,this.ctx.canvas.width,k),M=this.getSizeAndScale(D,this.ctx.canvas.height,L),H=Et.size,X=M.size,J=t.cachedCanvases.getCanvas("pattern-workaround",H,X),ot=J.context,ft=z?Math.floor(w/f):0,lt=Y?Math.floor(E/p):0;for(let ae=0;ae<=ft;ae++)for(let $t=0;$t<=lt;$t++)ot.drawImage(gt,H*ae,X*$t,H,X,0,0,H,X);return{canvas:J.canvas,scaleX:Et.scale,scaleY:M.scale,offsetX:y,offsetY:v}}return{canvas:P.canvas,scaleX:vt.scale,scaleY:At.scale,offsetX:y,offsetY:v}}getSizeAndScale(t,e,s){const a=Math.max(Hd.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*s);return r>=a?r=a:s=r/t,{scale:s,size:r}}clipBbox(t,e,s,a,r){const c=a-e,u=r-s;t.ctx.rect(e,s,c,u),et.axialAlignedBoundingBox([e,s,a,r],Jt(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,s){const a=t.ctx,r=t.current;switch(e){case uv.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;a.fillStyle=r.fillColor=c,a.strokeStyle=r.strokeColor=u;break;case uv.UNCOLORED:a.fillStyle=a.strokeStyle=s,r.fillColor=r.strokeColor=s;break;default:throw new EE(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,s,a,r){let c=s;a!==De.SHADING&&(c=et.transform(c,e.baseTransform),this.matrix&&(c=et.transform(c,this.matrix)));const u=this.createPatternCanvas(e,r);let d=new DOMMatrix(c);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(d),f}}function dT({src:l,srcPos:t=0,dest:e,width:s,height:a,nonBlackColor:r=4294967295,inverseDecode:c=!1}){const u=Me.isLittleEndian?4278190080:255,[d,f]=c?[r,u]:[u,r],p=s>>3,y=s&7,v=l.length;e=new Uint32Array(e.buffer);let b=0;for(let A=0;A<a;A++){for(const E=t+p;t<E;t++){const S=t<v?l[t]:255;e[b++]=S&128?f:d,e[b++]=S&64?f:d,e[b++]=S&32?f:d,e[b++]=S&16?f:d,e[b++]=S&8?f:d,e[b++]=S&4?f:d,e[b++]=S&2?f:d,e[b++]=S&1?f:d}if(y===0)continue;const w=t<v?l[t++]:255;for(let E=0;E<y;E++)e[b++]=w&1<<7-E?f:d}return{srcPos:t,destPos:b}}const hv=16,dv=100,fT=15,fv=10,We=16,Zh=new DOMMatrix,ci=new Float32Array(2),Da=new Float32Array([1/0,1/0,-1/0,-1/0]);function gT(l,t){if(l._removeMirroring)throw new Error("Context is already forwarding operations.");l.__originalSave=l.save,l.__originalRestore=l.restore,l.__originalRotate=l.rotate,l.__originalScale=l.scale,l.__originalTranslate=l.translate,l.__originalTransform=l.transform,l.__originalSetTransform=l.setTransform,l.__originalResetTransform=l.resetTransform,l.__originalClip=l.clip,l.__originalMoveTo=l.moveTo,l.__originalLineTo=l.lineTo,l.__originalBezierCurveTo=l.bezierCurveTo,l.__originalRect=l.rect,l.__originalClosePath=l.closePath,l.__originalBeginPath=l.beginPath,l._removeMirroring=()=>{l.save=l.__originalSave,l.restore=l.__originalRestore,l.rotate=l.__originalRotate,l.scale=l.__originalScale,l.translate=l.__originalTranslate,l.transform=l.__originalTransform,l.setTransform=l.__originalSetTransform,l.resetTransform=l.__originalResetTransform,l.clip=l.__originalClip,l.moveTo=l.__originalMoveTo,l.lineTo=l.__originalLineTo,l.bezierCurveTo=l.__originalBezierCurveTo,l.rect=l.__originalRect,l.closePath=l.__originalClosePath,l.beginPath=l.__originalBeginPath,delete l._removeMirroring},l.save=function(){t.save(),this.__originalSave()},l.restore=function(){t.restore(),this.__originalRestore()},l.translate=function(e,s){t.translate(e,s),this.__originalTranslate(e,s)},l.scale=function(e,s){t.scale(e,s),this.__originalScale(e,s)},l.transform=function(e,s,a,r,c,u){t.transform(e,s,a,r,c,u),this.__originalTransform(e,s,a,r,c,u)},l.setTransform=function(e,s,a,r,c,u){t.setTransform(e,s,a,r,c,u),this.__originalSetTransform(e,s,a,r,c,u)},l.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},l.rotate=function(e){t.rotate(e),this.__originalRotate(e)},l.clip=function(e){t.clip(e),this.__originalClip(e)},l.moveTo=function(e,s){t.moveTo(e,s),this.__originalMoveTo(e,s)},l.lineTo=function(e,s){t.lineTo(e,s),this.__originalLineTo(e,s)},l.bezierCurveTo=function(e,s,a,r,c,u){t.bezierCurveTo(e,s,a,r,c,u),this.__originalBezierCurveTo(e,s,a,r,c,u)},l.rect=function(e,s,a,r){t.rect(e,s,a,r),this.__originalRect(e,s,a,r)},l.closePath=function(){t.closePath(),this.__originalClosePath()},l.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class pT{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,s){let a;return this.cache[t]!==void 0?(a=this.cache[t],this.canvasFactory.reset(a,e,s)):(a=this.canvasFactory.create(e,s),this.cache[t]=a),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function $l(l,t,e,s,a,r,c,u,d,f){const[p,y,v,b,A,w]=Jt(l);if(y===0&&v===0){const x=c*p+A,C=Math.round(x),k=u*b+w,L=Math.round(k),R=(c+d)*p+A,D=Math.abs(Math.round(R)-C)||1,z=(u+f)*b+w,Y=Math.abs(Math.round(z)-L)||1;return l.setTransform(Math.sign(p),0,0,Math.sign(b),C,L),l.drawImage(t,e,s,a,r,0,0,D,Y),l.setTransform(p,y,v,b,A,w),[D,Y]}if(p===0&&b===0){const x=u*v+A,C=Math.round(x),k=c*y+w,L=Math.round(k),R=(u+f)*v+A,D=Math.abs(Math.round(R)-C)||1,z=(c+d)*y+w,Y=Math.abs(Math.round(z)-L)||1;return l.setTransform(0,Math.sign(y),Math.sign(v),0,C,L),l.drawImage(t,e,s,a,r,0,0,Y,D),l.setTransform(p,y,v,b,A,w),[Y,D]}l.drawImage(t,e,s,a,r,c,u,d,f);const E=Math.hypot(p,y),S=Math.hypot(v,b);return[E*d,S*f]}class gv{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=gd;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Re.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,s){s?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Da.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=De.FILL,e=null){const s=this.minMax.slice();if(t===De.STROKE){e||qt("Stroke bounding box must include transform."),et.singularValueDecompose2dScale(e,ci);const a=ci[0]*this.lineWidth/2,r=ci[1]*this.lineWidth/2;s[0]-=a,s[1]-=r,s[2]+=a,s[3]+=r}return s}updateClipFromPath(){const t=et.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Da,0)}getClippedPathBoundingBox(t=De.FILL,e=null){return et.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function pv(l,t){if(t instanceof ImageData){l.putImageData(t,0,0);return}const e=t.height,s=t.width,a=e%We,r=(e-a)/We,c=a===0?r:r+1,u=l.createImageData(s,We);let d=0,f;const p=t.data,y=u.data;let v,b,A,w;if(t.kind===Xl.GRAYSCALE_1BPP){const E=p.byteLength,S=new Uint32Array(y.buffer,0,y.byteLength>>2),x=S.length,C=s+7>>3,k=4294967295,L=Me.isLittleEndian?4278190080:255;for(v=0;v<c;v++){for(A=v<r?We:a,f=0,b=0;b<A;b++){const R=E-d;let D=0;const z=R>C?s:R*8-7,Y=z&-8;let Q=0,K=0;for(;D<Y;D+=8)K=p[d++],S[f++]=K&128?k:L,S[f++]=K&64?k:L,S[f++]=K&32?k:L,S[f++]=K&16?k:L,S[f++]=K&8?k:L,S[f++]=K&4?k:L,S[f++]=K&2?k:L,S[f++]=K&1?k:L;for(;D<z;D++)Q===0&&(K=p[d++],Q=128),S[f++]=K&Q?k:L,Q>>=1}for(;f<x;)S[f++]=0;l.putImageData(u,0,v*We)}}else if(t.kind===Xl.RGBA_32BPP){for(b=0,w=s*We*4,v=0;v<r;v++)y.set(p.subarray(d,d+w)),d+=w,l.putImageData(u,0,b),b+=We;v<c&&(w=s*a*4,y.set(p.subarray(d,d+w)),l.putImageData(u,0,b))}else if(t.kind===Xl.RGB_24BPP)for(A=We,w=s*A,v=0;v<c;v++){for(v>=r&&(A=a,w=s*A),f=0,b=w;b--;)y[f++]=p[d++],y[f++]=p[d++],y[f++]=p[d++],y[f++]=255;l.putImageData(u,0,v*We)}else throw new Error(`bad image kind: ${t.kind}`)}function mv(l,t){if(t.bitmap){l.drawImage(t.bitmap,0,0);return}const e=t.height,s=t.width,a=e%We,r=(e-a)/We,c=a===0?r:r+1,u=l.createImageData(s,We);let d=0;const f=t.data,p=u.data;for(let y=0;y<c;y++){const v=y<r?We:a;({srcPos:d}=dT({src:f,srcPos:d,dest:p,width:s,height:v,nonBlackColor:0})),l.putImageData(u,0,y*We)}}function Pr(l,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of e)l[s]!==void 0&&(t[s]=l[s]);l.setLineDash!==void 0&&(t.setLineDash(l.getLineDash()),t.lineDashOffset=l.lineDashOffset)}function Gl(l){l.strokeStyle=l.fillStyle="#000000",l.fillRule="nonzero",l.globalAlpha=1,l.lineWidth=1,l.lineCap="butt",l.lineJoin="miter",l.miterLimit=10,l.globalCompositeOperation="source-over",l.font="10px sans-serif",l.setLineDash!==void 0&&(l.setLineDash([]),l.lineDashOffset=0);const{filter:t}=l;t!=="none"&&t!==""&&(l.filter="none")}function yv(l,t){if(t)return!0;et.singularValueDecompose2dScale(l,ci);const e=Math.fround($i.pixelRatio*ja.PDF_TO_CSS_UNITS);return ci[0]<=e&&ci[1]<=e}const mT=["butt","round","square"],yT=["miter","round","bevel"],vT={},vv={};class Pa{constructor(t,e,s,a,r,{optionalContentConfig:c,markedContentStack:u=null},d,f,p){this.ctx=t,this.current=new gv(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=s,this.canvasFactory=a,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new pT(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,e,s=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):s}beginDrawing({transform:t,viewport:e,transparency:s=!1,background:a=null}){const r=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,r,c),this.ctx.fillStyle=u,s){const d=this.cachedCanvases.getCanvas("transparent",r,c);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...Jt(this.compositeCtx))}this.ctx.save(),Gl(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Jt(this.ctx)}executeOperatorList(t,e,s,a,r){const c=t.argsArray,u=t.fnArray;let d=e||0;const f=c.length;if(f===d)return d;const p=f-d>fv&&typeof s=="function",y=p?Date.now()+fT:0;let v=0;const b=this.commonObjs,A=this.objs;let w,E;for(;;){if(a!==void 0&&d===a.nextBreakPoint)return a.breakIt(d,s),d;if(!r||r(d))if(w=u[d],E=c[d]??null,w!==so.dependency)E===null?this[w](d):this[w](d,...E);else for(const S of E){this.dependencyTracker?.recordNamedData(S,d);const x=S.startsWith("g_")?b:A;if(!x.has(S))return x.get(S,s),d}if(d++,d===f)return d;if(p&&++v>fv){if(Date.now()>y)return s(),d;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const s=t.width??t.displayWidth,a=t.height??t.displayHeight;let r=Math.max(Math.hypot(e[0],e[1]),1),c=Math.max(Math.hypot(e[2],e[3]),1),u=s,d=a,f="prescale1",p,y;for(;r>2&&u>1||c>2&&d>1;){let v=u,b=d;r>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),r/=u/v),c>2&&d>1&&(b=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,c/=d/b),p=this.cachedCanvases.getCanvas(f,v,b),y=p.context,y.clearRect(0,0,v,b),y.drawImage(t,0,0,u,d,0,0,v,b),t=p.canvas,u=v,d=b,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t,e){const s=this.ctx,{width:a,height:r}=e,c=this.current.fillColor,u=this.current.patternFill,d=Jt(s);let f,p,y,v;if((e.bitmap||e.data)&&e.count>1){const Q=e.bitmap||e.data.buffer;p=JSON.stringify(u?d:[d.slice(0,4),c]),f=this._cachedBitmapsMap.get(Q),f||(f=new Map,this._cachedBitmapsMap.set(Q,f));const K=f.get(p);if(K&&!u){const dt=Math.round(Math.min(d[0],d[2])+d[4]),St=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,Si.transformAndFill),{canvas:K,offsetX:dt,offsetY:St}}y=K}y||(v=this.cachedCanvases.getCanvas("maskCanvas",a,r),mv(v.context,e));let b=et.transform(d,[1/a,0,0,-1/r,0,0]);b=et.transform(b,[1,0,0,1,0,-r]);const A=Da.slice();et.axialAlignedBoundingBox([0,0,a,r],b,A);const[w,E,S,x]=A,C=Math.round(S-w)||1,k=Math.round(x-E)||1,L=this.cachedCanvases.getCanvas("fillCanvas",C,k),R=L.context,D=w,z=E;R.translate(-D,-z),R.transform(...b),y||(y=this._scaleImage(v.canvas,ji(R)),y=y.img,f&&u&&f.set(p,y)),R.imageSmoothingEnabled=yv(Jt(R),e.interpolate),$l(R,y,0,0,y.width,y.height,0,0,a,r),R.globalCompositeOperation="source-in";const Y=et.transform(ji(R),[1,0,0,1,-D,-z]);return R.fillStyle=u?c.getPattern(s,this,Y,De.FILL,t):c,R.fillRect(0,0,a,r),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,L.canvas)),this.dependencyTracker?.recordDependencies(t,Si.transformAndFill),{canvas:L.canvas,offsetX:Math.round(D),offsetY:Math.round(z)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=mT[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=yT[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,s){this.dependencyTracker?.recordSimpleData("dash",t);const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(e),a.lineDashOffset=s)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[s,a]of e)switch(s){case"LW":this.setLineWidth(t,a);break;case"LC":this.setLineCap(t,a);break;case"LJ":this.setLineJoin(t,a);break;case"ML":this.setMiterLimit(t,a);break;case"D":this.setDash(t,a[0],a[1]);break;case"RI":this.setRenderingIntent(t,a);break;case"FL":this.setFlatness(t,a);break;case"Font":this.setFont(t,a[0],a[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=a;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=a;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=a;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,s=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(a,e,s);this.suspendedCtx=this.ctx;const c=this.ctx=r.context;c.setTransform(this.suspendedCtx.getTransform()),Pr(this.suspendedCtx,c),gT(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Pr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,s,a){const r=a[0],c=a[1],u=a[2]-r,d=a[3]-c;u===0||d===0||(this.genericComposeSMask(e.context,s,u,d,e.subtype,e.backdrop,e.transferMap,r,c,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,e,s,a,r,c,u,d,f,p,y){let v=t.canvas,b=d-p,A=f-y;if(c)if(b<0||A<0||b+s>v.width||A+a>v.height){const E=this.cachedCanvases.getCanvas("maskExtension",s,a),S=E.context;S.drawImage(v,-b,-A),S.globalCompositeOperation="destination-atop",S.fillStyle=c,S.fillRect(0,0,s,a),S.globalCompositeOperation="source-over",v=E.canvas,b=A=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(b,A,s,a),t.clip(E),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(b,A,s,a),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const w=new Path2D;w.rect(d,f,s,a),e.clip(w),e.globalCompositeOperation="destination-in",e.drawImage(v,b,A,s,a,d,f,s,a),e.restore()}save(t){this.inSMaskMode&&Pr(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Pr(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,s,a,r,c,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,s,a,r,c,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,s,a){let[r]=s;if(!a){r||=s[0]=new Path2D,this[e](t,r);return}if(this.dependencyTracker!==null){const c=e===so.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,a[0]-c,a[2]+c,a[1]-c,a[3]+c).recordDependencies(t,["transform"])}r instanceof Path2D||(r=s[0]=tb(r)),et.axialAlignedBoundingBox(a,Jt(this.ctx),this.current.minMax),this[e](t,r),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,s=!0){const a=this.ctx,r=this.current.strokeColor;if(a.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&r?.getPattern){const c=r.isModifyingCurrentTransform()?a.getTransform():null;if(a.save(),a.strokeStyle=r.getPattern(a,this,ji(a),De.STROKE,t),c){const u=new Path2D;u.addPath(e,a.getTransform().invertSelf().multiplySelf(c)),e=u}this.rescaleAndStroke(e,!1),a.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,Si.stroke),s&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(De.STROKE,Jt(this.ctx))),a.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,s=!0){const a=this.ctx,r=this.current.fillColor,c=this.current.patternFill;let u=!1;if(c){const f=r.isModifyingCurrentTransform()?a.getTransform():null;if(this.dependencyTracker?.save(t),a.save(),a.fillStyle=r.getPattern(a,this,ji(a),De.FILL,t),f){const p=new Path2D;p.addPath(e,a.getTransform().invertSelf().multiplySelf(f)),e=p}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(a.fill(e,"evenodd"),this.pendingEOFill=!1):a.fill(e)),this.dependencyTracker?.recordDependencies(t,Si.fill),u&&(a.restore(),this.dependencyTracker?.restore(t)),s&&this.consumePath(t,e,d)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,Si.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=vT}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=vv}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:a}=this;e!==void 0&&a.recordFutureForcedDependency("textClip",a.getOpenMarker()).recordFutureForcedDependency("textClip",t),a.recordCloseMarker(t)}if(e!==void 0){const a=new Path2D,r=s.getTransform().invertSelf();for(const{transform:c,x:u,y:d,fontSize:f,path:p}of e)p&&a.addPath(p,new DOMMatrix(c).preMultiplySelf(r).translate(u,d).scale(f,-f));s.clip(a)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,s){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const a=this.commonObjs.get(e),r=this.current;if(!a)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=a.fontMatrix||gd,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&mt("Invalid font matrix for font "+e),s<0?(s=-s,r.fontDirection=-1):r.fontDirection=1,this.current.font=a,this.current.fontSize=s,a.isType3Font)return;const c=a.loadedName||"sans-serif",u=a.systemFontInfo?.css||`"${c}", ${a.fallbackName}`;let d="normal";a.black?d="900":a.bold&&(d="bold");const f=a.italic?"italic":"normal";let p=s;s<hv?p=hv:s>dv&&(p=dv),this.current.fontSizeScale=s/p,this.ctx.font=`${f} ${d} ${p}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,e,s){this.setLeading(t,-s),this.moveText(t,e,s)}setTextMatrix(t,e){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=e,s.textMatrixScale=Math.hypot(e[0],e[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#s(t,e,s){const a=new Path2D;return a.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(e)),a}paintChar(t,e,s,a,r,c){const u=this.ctx,d=this.current,f=d.font,p=d.textRenderingMode,y=d.fontSize/d.fontSizeScale,v=p&Re.FILL_STROKE_MASK,b=!!(p&Re.ADD_TO_PATH_FLAG),A=d.patternFill&&!f.missingFile,w=d.patternStroke&&!f.missingFile;let E;if((f.disableFontFace||b||A||w)&&!f.missingFile&&(E=f.getPathGenerator(this.commonObjs,e)),E&&(f.disableFontFace||A||w)){u.save(),u.translate(s,a),u.scale(y,-y),this.dependencyTracker?.recordCharacterBBox(t,u,f);let S;if(v===Re.FILL||v===Re.FILL_STROKE)if(r){S=u.getTransform(),u.setTransform(...r);const x=this.#s(E,S,r);u.fill(x)}else u.fill(E);if(v===Re.STROKE||v===Re.FILL_STROKE)if(c){S||=u.getTransform(),u.setTransform(...c);const{a:x,b:C,c:k,d:L}=S,R=et.inverseTransform(c),D=et.transform([x,C,k,L,0,0],R);et.singularValueDecompose2dScale(D,ci),u.lineWidth*=Math.max(ci[0],ci[1])/y,u.stroke(this.#s(E,S,c))}else u.lineWidth/=y,u.stroke(E);u.restore()}else(v===Re.FILL||v===Re.FILL_STROKE)&&(u.fillText(e,s,a),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,a,()=>u.measureText(e))),(v===Re.STROKE||v===Re.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,a,()=>u.measureText(e)).recordDependencies(t,Si.stroke),u.strokeText(e,s,a));b&&((this.pendingTextPaths||=[]).push({transform:Jt(u),x:s,y:a,fontSize:y,path:E}),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,a))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let s=!1;for(let a=3;a<e.length;a+=4)if(e[a]>0&&e[a]<255){s=!0;break}return yt(this,"isFontSubpixelAAEnabled",s)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Si.showText).resetBBox(t),this.current.textRenderingMode&Re.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,a=s.font;if(a.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const r=s.fontSize;if(r===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,u=s.fontSizeScale,d=s.charSpacing,f=s.wordSpacing,p=s.fontDirection,y=s.textHScale*p,v=e.length,b=a.vertical,A=b?1:-1,w=a.defaultVMetrics,E=r*s.fontMatrix[0],S=s.textRenderingMode===Re.FILL&&!a.disableFontFace&&!s.patternFill;c.save(),s.textMatrix&&c.transform(...s.textMatrix),c.translate(s.x,s.y+s.textRise),p>0?c.scale(y,-1):c.scale(y,1);let x,C;if(s.patternFill){c.save();const z=s.fillColor.getPattern(c,this,ji(c),De.FILL,t);x=Jt(c),c.restore(),c.fillStyle=z}if(s.patternStroke){c.save();const z=s.strokeColor.getPattern(c,this,ji(c),De.STROKE,t);C=Jt(c),c.restore(),c.strokeStyle=z}let k=s.lineWidth;const L=s.textMatrixScale;if(L===0||k===0){const z=s.textRenderingMode&Re.FILL_STROKE_MASK;(z===Re.STROKE||z===Re.FILL_STROKE)&&(k=this.getSinglePixelWidth())}else k/=L;if(u!==1&&(c.scale(u,u),k/=u),c.lineWidth=k,a.isInvalidPDFjsFont){const z=[];let Y=0;for(const K of e)z.push(K.unicode),Y+=K.width;const Q=z.join("");if(c.fillText(Q,0,0),this.dependencyTracker!==null){const K=c.measureText(Q);this.dependencyTracker.recordBBox(t,this.ctx,-K.actualBoundingBoxLeft,K.actualBoundingBoxRight,-K.actualBoundingBoxAscent,K.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=Y*E*y,c.restore(),this.compose();return}let R=0,D;for(D=0;D<v;++D){const z=e[D];if(typeof z=="number"){R+=A*z*r/1e3;continue}let Y=!1;const Q=(z.isSpace?f:0)+d,K=z.fontChar,dt=z.accent;let St,vt,At=z.width;if(b){const W=z.vmetric||w,gt=-(z.vmetric?W[1]:At*.5)*E,Et=W[2]*E;At=W?-W[0]:At,St=gt/u,vt=(R+Et)/u}else St=R/u,vt=0;let P;if(a.remeasure&&At>0){P=c.measureText(K);const W=P.width*1e3/r*u;if(At<W&&this.isFontSubpixelAAEnabled){const gt=At/W;Y=!0,c.save(),c.scale(gt,1),St/=gt}else At!==W&&(St+=(At-W)/2e3*r/u)}if(this.contentVisible&&(z.isInFont||a.missingFile)){if(S&&!dt)c.fillText(K,St,vt),this.dependencyTracker?.recordCharacterBBox(t,c,P?{bbox:null}:a,r/u,St,vt,()=>P??c.measureText(K));else if(this.paintChar(t,K,St,vt,x,C),dt){const W=St+r*dt.offset.x/u,gt=vt-r*dt.offset.y/u;this.paintChar(t,dt.fontChar,W,gt,x,C)}}const G=b?At*E-Q*p:At*E+Q*p;R+=G,Y&&c.restore()}b?s.y-=R:s.x+=R*y,c.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const s=this.ctx,a=this.current,r=a.font,c=a.fontSize,u=a.fontDirection,d=r.vertical?1:-1,f=a.charSpacing,p=a.wordSpacing,y=a.textHScale*u,v=a.fontMatrix||gd,b=e.length,A=a.textRenderingMode===Re.INVISIBLE;let w,E,S,x;if(A||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),a.textMatrix&&s.transform(...a.textMatrix),s.translate(a.x,a.y+a.textRise),s.scale(y,u);const C=this.dependencyTracker;for(this.dependencyTracker=C?new ec(C,t):null,w=0;w<b;++w){if(E=e[w],typeof E=="number"){x=d*E*c/1e3,this.ctx.translate(x,0),a.x+=x*y;continue}const k=(E.isSpace?p:0)+f,L=r.charProcOperatorList[E.operatorListId];L?this.contentVisible&&(this.save(),s.scale(c,c),s.transform(...v),this.executeOperatorList(L),this.restore()):mt(`Type3 character "${E.operatorListId}" is not available.`);const R=[E.width,0];et.applyTransform(R,v),S=R[0]*c+k,s.translate(S,0),a.x+=S*y}s.restore(),C&&(this.dependencyTracker=C)}setCharWidth(t,e,s){}setCharWidthAndBounds(t,e,s,a,r,c,u){const d=new Path2D;d.rect(a,r,c-a,u-r),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,a,c,r,u).recordClipBox(t,this.ctx,a,c,r,u),this.endPath(t)}getColorN_Pattern(t,e){let s;if(e[0]==="TilingPattern"){const a=this.baseTransform||Jt(this.ctx),r={createCanvasGraphics:(c,u)=>new Pa(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new ec(this.dependencyTracker,u,!0):null)};s=new Hd(e,this.ctx,r,a)}else s=this._getPattern(t,e[1],e[2]);return s}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,s=null){let a;return this.cachedPatterns.has(e)?a=this.cachedPatterns.get(e):(a=hT(this.getObject(t,e)),this.cachedPatterns.set(e,a)),s&&(a.matrix=s),a}shadingFill(t,e){if(!this.contentVisible)return;const s=this.ctx;this.save(t);const a=this._getPattern(t,e);s.fillStyle=a.getPattern(s,this,ji(s),De.SHADING,t);const r=ji(s);if(r){const{width:c,height:u}=s.canvas,d=Da.slice();et.axialAlignedBoundingBox([0,0,c,u],r,d);const[f,p,y,v]=d;this.ctx.fillRect(f,p,y-f,v-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Si.transform).recordDependencies(t,Si.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){qt("Should not call beginInlineImage")}beginImageData(){qt("Should not call beginImageData")}paintFormXObjectBegin(t,e,s){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=Jt(this.ctx),s)){et.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[a,r,c,u]=s,d=new Path2D;d.rect(a,r,c-a,u-r),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,a,c,r,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;e.isolated||cc("TODO: Support non-isolated groups."),e.knockout&&mt("Knockout groups not supported.");const a=Jt(s);if(e.matrix&&s.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=Da.slice();et.axialAlignedBoundingBox(e.bbox,Jt(s),r);const c=[0,0,s.canvas.width,s.canvas.height];r=et.intersect(r,c)||[0,0,0,0];const u=Math.floor(r[0]),d=Math.floor(r[1]),f=Math.max(Math.ceil(r[2])-u,1),p=Math.max(Math.ceil(r[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,p]);let y="groupAt"+this.groupLevel;e.smask&&(y+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(y,f,p),b=v.context;b.translate(-u,-d),b.transform(...a);let A=new Path2D;const[w,E,S,x]=e.bbox;if(A.rect(w,E,S-w,x-E),e.matrix){const C=new Path2D;C.addPath(A,new DOMMatrix(e.matrix)),A=C}b.clip(A),e.smask&&this.smaskStack.push({canvas:v.canvas,context:b,offsetX:u,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,d),s.save()),Pr(s,b),this.ctx=b,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const r=Jt(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...r);const c=Da.slice();et.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],r,c),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,e,s,a,r,c){if(this.#t(),Gl(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],d=s[3]-s[1];if(c&&this.annotationCanvasMap){a=a.slice(),a[4]-=s[0],a[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=d,et.singularValueDecompose2dScale(Jt(this.ctx),ci);const{viewportScale:f}=this,p=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,y);const{canvas:v,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(ci[0],0,0,-ci[1],0,d*ci[1]),Gl(this.ctx)}else{Gl(this.ctx),this.endPath(t);const f=new Path2D;f.rect(s[0],s[1],u,d),this.ctx.clip(f)}}this.current=new gv(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...a),this.transform(t,...r)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const s=e.count;e=this.getObject(t,e.data,e),e.count=s;const a=this.ctx,r=this._createMaskCanvas(t,e),c=r.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(c,r.offsetX,r.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,r.offsetX,r.offsetX+c.width,r.offsetY,r.offsetY+c.height).recordOperation(t),a.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,s,a=0,r=0,c,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const d=this.ctx;d.save();const f=Jt(d);d.transform(s,a,r,c,0,0);const p=this._createMaskCanvas(t,e);d.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let y=0,v=u.length;y<v;y+=2){const b=et.transform(f,[s,a,r,c,u[y],u[y+1]]);d.drawImage(p.canvas,b[4],b[5]),this.dependencyTracker?.recordBBox(t,this.ctx,b[4],b[4]+p.canvas.width,b[5],b[5]+p.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const s=this.ctx,a=this.current.fillColor,r=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Si.transformAndFill);for(const c of e){const{data:u,width:d,height:f,transform:p}=c,y=this.cachedCanvases.getCanvas("maskCanvas",d,f),v=y.context;v.save();const b=this.getObject(t,u,c);mv(v,b),v.globalCompositeOperation="source-in",v.fillStyle=r?a.getPattern(v,this,ji(s),De.FILL,t):a,v.fillRect(0,0,d,f),v.restore(),s.save(),s.transform(...p),s.scale(1,-1),$l(s,y.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,d,0,f),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const s=this.getObject(t,e);if(!s){mt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,e,s,a,r){if(!this.contentVisible)return;const c=this.getObject(t,e);if(!c){mt("Dependent image isn't ready yet");return}const u=c.width,d=c.height,f=[];for(let p=0,y=r.length;p<y;p+=2)f.push({transform:[s,0,0,a,r[p],r[p+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:s,height:a}=t,r=this.cachedCanvases.getCanvas("inlineImage",s,a),c=r.context;return c.filter=this.current.transferMaps,c.drawImage(e,0,0),c.filter="none",r.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const s=e.width,a=e.height,r=this.ctx;this.save(t);const{filter:c}=r;c!=="none"&&c!==""&&(r.filter="none"),r.scale(1/s,-1/a);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const p=this.cachedCanvases.getCanvas("inlineImage",s,a).context;pv(p,e),u=this.applyTransferMapsToCanvas(p)}const d=this._scaleImage(u,ji(r));r.imageSmoothingEnabled=yv(Jt(r),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,r,0,s,-a,0).recordDependencies(t,Si.imageXObject).recordOperation(t),$l(r,d.img,0,0,d.paintWidth,d.paintHeight,0,-a,s,a),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,s){if(!this.contentVisible)return;const a=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const c=e.width,u=e.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;pv(f,e),r=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of s)a.save(),a.transform(...c.transform),a.scale(1,-1),$l(a,r,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,a,0,1,-1,0),a.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Si.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,s){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,s){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,s){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const r=this.ctx;this.pendingClip?(a||(this.pendingClip===vv?r.clip(e,"evenodd"):r.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Jt(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),a=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,a)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:s,c:a,d:r}=this.ctx.getTransform();let c,u;if(s===0&&a===0){const d=Math.abs(e),f=Math.abs(r);if(d===f)if(t===0)c=u=1/d;else{const p=d*t;c=u=p<1?1/p:1}else if(t===0)c=1/d,u=1/f;else{const p=d*t,y=f*t;c=p<1?1/p:1,u=y<1?1/y:1}}else{const d=Math.abs(e*r-s*a),f=Math.hypot(e,s),p=Math.hypot(a,r);if(t===0)c=p/d,u=f/d;else{const y=t*d;c=p>y?p/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:s,current:{lineWidth:a}}=this,[r,c]=this.getScaleForStroking();if(r===c){s.lineWidth=(a||1)*r,s.stroke(t);return}const u=s.getLineDash();e&&s.save(),s.scale(r,c),Zh.a=1/r,Zh.d=1/c;const d=new Path2D;if(d.addPath(t,Zh),u.length>0){const f=Math.max(r,c);s.setLineDash(u.map(p=>p/f)),s.lineDashOffset/=f}s.lineWidth=a||1,s.stroke(d),e&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const l in so)Pa.prototype[l]!==void 0&&(Pa.prototype[so[l]]=Pa.prototype[l]);class Ia{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class bT{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const xa=Symbol("INTERNAL");class _T{#t=!1;#e=!1;#s=!1;#i=!0;constructor(t,{name:e,intent:s,usage:a,rbGroups:r}){this.#t=!!(t&li.DISPLAY),this.#e=!!(t&li.PRINT),this.name=e,this.intent=s,this.usage=a,this.rbGroups=r}get visible(){if(this.#s)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,s=!1){t!==xa&&qt("Internal method `_setVisible` called."),this.#s=s,this.#i=e}}class wT{#t=null;#e=new Map;#s=null;#i=null;constructor(t,e=li.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const s of t.groups)this.#e.set(s.id,new _T(e,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(xa,!1);for(const s of t.on)this.#e.get(s)._setVisible(xa,!0);for(const s of t.off)this.#e.get(s)._setVisible(xa,!1);this.#s=this.getHash()}}#r(t){const e=t.length;if(e<2)return!0;const s=t[0];for(let a=1;a<e;a++){const r=t[a];let c;if(Array.isArray(r))c=this.#r(r);else if(this.#e.has(r))c=this.#e.get(r).visible;else return mt(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return cc("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(mt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return mt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return mt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return mt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return mt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return mt(`Unknown optional content policy ${t.policy}.`),!0}return mt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,s=!0){const a=this.#e.get(t);if(!a){mt(`Optional content group not found: ${t}`);return}if(s&&e&&a.rbGroups.length)for(const r of a.rbGroups)for(const c of r)c!==t&&this.#e.get(c)?._setVisible(xa,!1,!0);a._setVisible(xa,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let s;for(const a of t){switch(a){case"ON":case"OFF":case"Toggle":s=a;continue}const r=this.#e.get(a);if(r)switch(s){case"ON":this.setVisibility(a,!0,e);break;case"OFF":this.setVisibility(a,!1,e);break;case"Toggle":this.setVisibility(a,!r.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new ib;for(const[e,s]of this.#e)t.update(`${e}:${s.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class AT{constructor(t,{disableRange:e=!1,disableStream:s=!1}){Dt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:a,initialData:r,progressiveDone:c,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=u,r?.length>0){const d=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!e,this._contentLength=a,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((d,f)=>{this._onReceiveData({begin:d,chunk:f})}),t.addProgressListener((d,f)=>{this._onProgress({loaded:d,total:f})}),t.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const s=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const a=this._rangeReaders.some(function(r){return r._begin!==t?!1:(r._enqueue(s),!0)});Dt(a,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Dt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new ST(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new ET(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class ST{constructor(t,e,s=!1,a=null){this._stream=t,this._done=s||!1,this._filename=Pd(a)?a:null,this._queuedChunks=e||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ET{constructor(t,e,s){this._stream=t,this._begin=e,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function TT(l){let t=!0,e=s("filename\\*","i").exec(l);if(e){e=e[1];let p=u(e);return p=unescape(p),p=d(p),p=f(p),r(p)}if(e=c(l),e){const p=f(e);return r(p)}if(e=s("filename","i").exec(l),e){e=e[1];let p=u(e);return p=f(p),r(p)}function s(p,y){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function a(p,y){if(p){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const v=new TextDecoder(p,{fatal:!0}),b=co(y);y=v.decode(b),t=!1}catch{}}return y}function r(p){return t&&/[\x80-\xff]/.test(p)&&(p=a("utf-8",p),t&&(p=a("iso-8859-1",p))),p}function c(p){const y=[];let v;const b=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=b.exec(p))!==null;){let[,w,E,S]=v;if(w=parseInt(w,10),w in y){if(w===0)break;continue}y[w]=[E,S]}const A=[];for(let w=0;w<y.length&&w in y;++w){let[E,S]=y[w];S=u(S),E&&(S=unescape(S),w===0&&(S=d(S))),A.push(S)}return A.join("")}function u(p){if(p.startsWith('"')){const y=p.slice(1).split('\\"');for(let v=0;v<y.length;++v){const b=y[v].indexOf('"');b!==-1&&(y[v]=y[v].slice(0,b),y.length=v+1),y[v]=y[v].replaceAll(/\\(.)/g,"$1")}p=y.join('"')}return p}function d(p){const y=p.indexOf("'");if(y===-1)return p;const v=p.slice(0,y),A=p.slice(y+1).replace(/^[^']*'/,"");return a(v,A)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,v,b,A){if(b==="q"||b==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,E){return String.fromCharCode(parseInt(E,16))}),a(v,A);try{A=atob(A)}catch{}return a(v,A)})}return""}function cb(l,t){const e=new Headers;if(!l||!t||typeof t!="object")return e;for(const s in t){const a=t[s];a!==void 0&&e.append(s,a)}return e}function dc(l){return URL.parse(l)?.origin??null}function ub({responseHeaders:l,isHttp:t,rangeChunkSize:e,disableRange:s}){const a={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(l.get("Content-Length"),10);return!Number.isInteger(r)||(a.suggestedLength=r,r<=2*e)||s||!t||l.get("Accept-Ranges")!=="bytes"||(l.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function hb(l){const t=l.get("Content-Disposition");if(t){let e=TT(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Pd(e))return e}return null}function po(l,t){return new tc(`Unexpected server response (${l}) while retrieving PDF "${t}".`,l,l===404||l===0&&t.startsWith("file:"))}function db(l){return l===200||l===206}function fb(l,t,e){return{method:"GET",headers:l,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function gb(l){return l instanceof Uint8Array?l.buffer:l instanceof ArrayBuffer?l:(mt(`getArrayBuffer - unexpected data format: ${l}`),new Uint8Array(l).buffer)}class CT{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=cb(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Dt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new xT(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new RT(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class xT{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const s=new Headers(t.headers),a=e.url;fetch(a,fb(s,this._withCredentials,this._abortController)).then(r=>{if(t._responseOrigin=dc(r.url),!db(r.status))throw po(r.status,a);this._reader=r.body.getReader(),this._headersCapability.resolve();const c=r.headers,{allowRangeRequests:u,suggestedLength:d}=ub({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=d||this._contentLength,this._filename=hb(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Vs("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:gb(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class RT{constructor(t,e,s){this._stream=t,this._reader=null,this._loaded=0;const a=t.source;this._withCredentials=a.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!a.disableStream,this._abortController=new AbortController;const r=new Headers(t.headers);r.append("Range",`bytes=${e}-${s-1}`);const c=a.url;fetch(c,fb(r,this._withCredentials,this._abortController)).then(u=>{const d=dc(u.url);if(d!==t._responseOrigin)throw new Error(`Expected range response-origin "${d}" to match "${t._responseOrigin}".`);if(!db(u.status))throw po(u.status,c);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:gb(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const td=200,ed=206;function OT(l){const t=l.response;return typeof t!="string"?t:co(t).buffer}class kT{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=cb(this.isHttp,e),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,s=this.currXhrId++,a=this.pendingRequests[s]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[r,c]of this.headers)e.setRequestHeader(r,c);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),a.expectedStatus=ed):a.expectedStatus=td,e.responseType="arraybuffer",Dt(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,s),e.onprogress=this.onProgress.bind(this,s),a.onHeadersReceived=t.onHeadersReceived,a.onDone=t.onDone,a.onError=t.onError,a.onProgress=t.onProgress,e.send(null),s}onProgress(t,e){const s=this.pendingRequests[t];s&&s.onProgress?.(e)}onStateChange(t,e){const s=this.pendingRequests[t];if(!s)return;const a=s.xhr;if(a.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),a.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],a.status===0&&this.isHttp){s.onError(a.status);return}const r=a.status||td;if(!(r===td&&s.expectedStatus===ed)&&r!==s.expectedStatus){s.onError(a.status);return}const u=OT(a);if(r===ed){const d=a.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);f?s.onDone({begin:parseInt(f[1],10),chunk:u}):(mt('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(a.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class DT{constructor(t){this._source=t,this._manager=new kT(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Dt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new MT(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const s=new NT(this._manager,t,e);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class MT{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=dc(e.responseURL);const s=e.getAllResponseHeaders(),a=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[d,...f]=u.split(": ");return[d,f.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:c}=ub({responseHeaders:a,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=hb(a),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=po(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class NT{constructor(t,e,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=dc(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=po(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const LT=/^[a-z][a-z0-9\-+.]+:/i;function BT(l){if(LT.test(l))return new URL(l);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(l))}class PT{constructor(t){this.source=t,this.url=BT(t.url),Dt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Dt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new IT(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new UT(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class IT{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(a=>{this._contentLength=a.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},a=>{a.code==="ENOENT"&&(a=po(0,this._url.href)),this._storedError=a,this._headersCapability.reject(a)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Vs("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class UT{constructor(t,e,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const a=t.source;this._isStreamingSupported=!a.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:e,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Ir=Symbol("INITIAL_DATA");class pb{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Ir}}get(t,e=null){if(e){const a=this.#e(t);return a.promise.then(()=>e(a.data)),null}const s=this.#t[t];if(!s||s.data===Ir)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const e=this.#t[t];return!!e&&e.data!==Ir}delete(t){const e=this.#t[t];return!e||e.data===Ir?!1:(delete this.#t[t],!0)}resolve(t,e=null){const s=this.#e(t);s.data=e,s.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Ir&&(yield[t,e])}}}const jT=1e5,bv=30;class Pe{#t=Promise.withResolvers();#e=null;#s=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#a=null;#n=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#m=[];#p=null;#u=[];#g=new WeakMap;#y=null;static#b=new Map;static#v=new Map;static#T=new WeakMap;static#S=null;static#w=new Set;constructor({textContentSource:t,container:e,viewport:s}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#h=s.scale*$i.pixelRatio,this.#d=s.rotation,this.#a={div:null,properties:null,ctx:null};const{pageWidth:a,pageHeight:r,pageX:c,pageY:u}=s.rawDims;this.#y=[1,0,0,-1,-c,u+r],this.#o=a,this.#n=r,Pe.#O(),xn(e,s),this.#t.promise.finally(()=>{Pe.#w.delete(this),this.#a=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Me.platform;return yt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:s})=>{if(s){this.#t.resolve();return}this.#r??=e.lang,Object.assign(this.#f,e.styles),this.#x(e.items),t()},this.#t.reject)};return this.#c=this.#p.getReader(),Pe.#w.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const s=t.scale*$i.pixelRatio,a=t.rotation;if(a!==this.#d&&(e?.(),this.#d=a,xn(this.#l,{rotation:a})),s!==this.#h){e?.(),this.#h=s;const r={div:null,properties:null,ctx:Pe.#k(this.#r)};for(const c of this.#u)r.properties=this.#g.get(c),r.div=c,this.#E(r)}}cancel(){const t=new Vs("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#x(t){if(this.#s)return;this.#a.ctx??=Pe.#k(this.#r);const e=this.#u,s=this.#m;for(const a of t){if(e.length>jT){mt("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const r=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),a.id&&this.#e.setAttribute("id",`${a.id}`),r.append(this.#e)}else a.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(a.str),this.#_(a)}}#_(t){const e=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const a=et.transform(this.#y,t.transform);let r=Math.atan2(a[1],a[0]);const c=this.#f[t.fontName];c.vertical&&(r+=Math.PI/2);let u=this.#i&&c.fontSubstitution||c.fontFamily;u=Pe.fontFamilyMap.get(u)||u;const d=Math.hypot(a[2],a[3]),f=d*Pe.#I(u,c,this.#r);let p,y;r===0?(p=a[4],y=a[5]-f):(p=a[4]+f*Math.sin(r),y=a[5]-f*Math.cos(r));const v="calc(var(--total-scale-factor) *",b=e.style;this.#e===this.#l?(b.left=`${(100*p/this.#o).toFixed(2)}%`,b.top=`${(100*y/this.#n).toFixed(2)}%`):(b.left=`${v}${p.toFixed(2)}px)`,b.top=`${v}${y.toFixed(2)}px)`),b.fontSize=`${v}${(Pe.#S*d).toFixed(2)}px)`,b.fontFamily=u,s.fontSize=d,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),r!==0&&(s.angle=r*(180/Math.PI));let A=!1;if(t.str.length>1)A=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const w=Math.abs(t.transform[0]),E=Math.abs(t.transform[3]);w!==E&&Math.max(w,E)/Math.min(w,E)>1.5&&(A=!0)}if(A&&(s.canvasWidth=c.vertical?t.height:t.width),this.#g.set(e,s),this.#a.div=e,this.#a.properties=s,this.#E(this.#a),s.hasText&&this.#e.append(e),s.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this.#e.append(w)}}#E(t){const{div:e,properties:s,ctx:a}=t,{style:r}=e;let c="";if(Pe.#S>1&&(c=`scale(${1/Pe.#S})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:u}=r,{canvasWidth:d,fontSize:f}=s;Pe.#R(a,f*this.#h,u);const{width:p}=a.measureText(e.textContent);p>0&&(c=`scaleX(${d*this.#h/p}) ${c}`)}s.angle!==0&&(c=`rotate(${s.angle}deg) ${c}`),c.length>0&&(r.transform=c)}static cleanup(){if(!(this.#w.size>0)){this.#b.clear();for(const{canvas:t}of this.#v.values())t.remove();this.#v.clear()}}static#k(t=null){let e=this.#v.get(t||="");if(!e){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),e=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(t,e),this.#T.set(e,{size:0,family:""})}return e}static#R(t,e,s){const a=this.#T.get(t);e===a.size&&s===a.family||(t.font=`${e}px ${s}`,a.size=e,a.family=s)}static#O(){if(this.#S!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#S=t.getBoundingClientRect().height,t.remove()}static#I(t,e,s){const a=this.#b.get(t);if(a)return a;const r=this.#k(s);r.canvas.width=r.canvas.height=bv,this.#R(r,bv,t);const c=r.measureText(""),u=c.fontBoundingBoxAscent,d=Math.abs(c.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let f=.8;return u?f=u/(u+d):(Me.platform.isFirefox&&mt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#b.set(t,f),f}}const zT=100;function mb(l={}){typeof l=="string"||l instanceof URL?l={url:l}:(l instanceof ArrayBuffer||ArrayBuffer.isView(l))&&(l={data:l});const t=new $d,{docId:e}=t,s=l.url?YE(l.url):null,a=l.data?XE(l.data):null,r=l.httpHeaders||null,c=l.withCredentials===!0,u=l.password??null,d=l.range instanceof yb?l.range:null,f=Number.isInteger(l.rangeChunkSize)&&l.rangeChunkSize>0?l.rangeChunkSize:2**16;let p=l.worker instanceof ao?l.worker:null;const y=l.verbosity,v=typeof l.docBaseUrl=="string"&&!uc(l.docBaseUrl)?l.docBaseUrl:null,b=jl(l.cMapUrl),A=l.cMapPacked!==!1,w=l.CMapReaderFactory||(Ie?iT:av),E=jl(l.iccUrl),S=jl(l.standardFontDataUrl),x=l.StandardFontDataFactory||(Ie?sT:rv),C=jl(l.wasmUrl),k=l.WasmFactory||(Ie?nT:ov),L=l.stopAtErrors!==!0,R=Number.isInteger(l.maxImageSize)&&l.maxImageSize>-1?l.maxImageSize:-1,D=l.isEvalSupported!==!1,z=typeof l.isOffscreenCanvasSupported=="boolean"?l.isOffscreenCanvasSupported:!Ie,Y=typeof l.isImageDecoderSupported=="boolean"?l.isImageDecoderSupported:!Ie&&(Me.platform.isFirefox||!globalThis.chrome),Q=Number.isInteger(l.canvasMaxAreaInBytes)?l.canvasMaxAreaInBytes:-1,K=typeof l.disableFontFace=="boolean"?l.disableFontFace:Ie,dt=l.fontExtraProperties===!0,St=l.enableXfa===!0,vt=l.ownerDocument||globalThis.document,At=l.disableRange===!0,P=l.disableStream===!0,G=l.disableAutoFetch===!0,W=l.pdfBug===!0,gt=l.CanvasFactory||(Ie?eT:JE),Et=l.FilterFactory||(Ie?tT:ZE),M=l.enableHWA===!0,H=l.useWasm!==!1,X=d?d.length:l.length??NaN,J=typeof l.useSystemFonts=="boolean"?l.useSystemFonts:!Ie&&!K,ot=typeof l.useWorkerFetch=="boolean"?l.useWorkerFetch:!!(w===av&&x===rv&&k===ov&&b&&S&&C&&Fr(b,document.baseURI)&&Fr(S,document.baseURI)&&Fr(C,document.baseURI)),ft=null;wE(y);const lt={canvasFactory:new gt({ownerDocument:vt,enableHWA:M}),filterFactory:new Et({docId:e,ownerDocument:vt}),cMapReaderFactory:ot?null:new w({baseUrl:b,isCompressed:A}),standardFontDataFactory:ot?null:new x({baseUrl:S}),wasmFactory:ot?null:new k({baseUrl:C})};p||(p=ao.create({verbosity:y,port:Ia.workerPort}),t._worker=p);const ae={docId:e,apiVersion:"5.4.449",data:a,password:u,disableAutoFetch:G,rangeChunkSize:f,length:X,docBaseUrl:v,enableXfa:St,evaluatorOptions:{maxImageSize:R,disableFontFace:K,ignoreErrors:L,isEvalSupported:D,isOffscreenCanvasSupported:z,isImageDecoderSupported:Y,canvasMaxAreaInBytes:Q,fontExtraProperties:dt,useSystemFonts:J,useWasm:H,useWorkerFetch:ot,cMapUrl:b,iccUrl:E,standardFontDataUrl:S,wasmUrl:C}},$t={ownerDocument:vt,pdfBug:W,styleElement:ft,loadingParams:{disableAutoFetch:G,enableXfa:St}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Ks=p.messageHandler.sendWithPromise("GetDocRequest",ae,a?[a.buffer]:null);let gs;if(d)gs=new AT(d,{disableRange:At,disableStream:P});else if(!a){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Ws=Fr(s)?CT:Ie?PT:DT;gs=new Ws({url:s,length:X,httpHeaders:r,withCredentials:c,rangeChunkSize:f,disableRange:At,disableStream:P})}return Ks.then(Ws=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const za=new Hr(e,Ws,p.port),Gi=new $T(za,t,gs,$t,lt,M);t._transport=Gi,za.send("Ready",null)})}).catch(t._capability.reject),t}class $d{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${$d.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class yb{#t=Promise.withResolvers();#e=[];#s=[];#i=[];#r=[];constructor(t,e,s=!1,a=null){this.length=t,this.initialData=e,this.progressiveDone=s,this.contentDispositionFilename=a}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#s.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const s of this.#r)s(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const s of this.#i)s(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#s)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){qt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class FT{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return yt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class HT{#t=!1;constructor(t,e,s,a=!1){this._pageIndex=t,this._pageInfo=e,this._transport=s,this._stats=a?new Jy:null,this._pdfBug=a,this.commonObjs=s.commonObjs,this.objs=new pb,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:s=0,offsetY:a=0,dontFlip:r=!1}={}){return new ho({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:a,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return yt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:s,intent:a="display",annotationMode:r=$s.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:y=null,isEditing:v=!1,recordOperations:b=!1,operationsFilter:A=null}){this._stats?.time("Overall");const w=this._transport.getRenderingIntent(a,r,y,v),{renderingIntent:E,cacheKey:S}=w;this.#t=!1,d||=this._transport.getOptionalContentConfig(E);let x=this._intentStates.get(S);x||(x=Object.create(null),this._intentStates.set(S,x)),x.streamReaderCancelTimeout&&(clearTimeout(x.streamReaderCancelTimeout),x.streamReaderCancelTimeout=null);const C=!!(E&li.PRINT);x.displayReadyCapability||(x.displayReadyCapability=Promise.withResolvers(),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(w));const k=!!(this._pdfBug&&globalThis.StepperManager?.enabled),L=!this.recordedBBoxes&&(b||k),R=Y=>{if(x.renderTasks.delete(D),L){const Q=D.gfx?.dependencyTracker.take();Q&&(D.stepper&&D.stepper.setOperatorBBoxes(Q,D.gfx.dependencyTracker.takeDebugMetadata()),b&&(this.recordedBBoxes=Q))}C&&(this.#t=!0),this.#e(),Y?(D.capability.reject(Y),this._abortOperatorList({intentState:x,reason:Y instanceof Error?Y:new Error(Y)})):D.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},D=new Ma({callback:R,params:{canvas:e,canvasContext:t,dependencyTracker:L?new rT(e,x.operatorList.length,k):null,viewport:s,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:x.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!C,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:A});(x.renderTasks||=new Set).add(D);const z=D.task;return Promise.all([x.displayReadyCapability.promise,d]).then(([Y,Q])=>{if(this.destroyed){R();return}if(this._stats?.time("Rendering"),!(Q.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");D.initializeGraphics({transparency:Y,optionalContentConfig:Q}),D.operatorListChanged()}).catch(R),z}getOperatorList({intent:t="display",annotationMode:e=$s.ENABLE,printAnnotationStorage:s=null,isEditing:a=!1}={}){function r(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const c=this._transport.getRenderingIntent(t,e,s,a,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=r,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>no.textContent(s));const e=this.streamTextContent(t);return new Promise(function(s,a){function r(){c.read().then(function({value:d,done:f}){if(f){s(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),r()},a)}const c=e.getReader(),u={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const s of e.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new Jy),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const s=this._intentStates.get(e);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let s=0,a=t.length;s<a;s++)e.operatorList.fnArray.push(t.fnArray[s]),e.operatorList.argsArray.push(t.argsArray[s]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const s of e.renderTasks)s.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:s,modifiedIds:a}){const{map:r,transfer:c}=s,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:a},c).getReader(),f=this._intentStates.get(e);f.streamReader=d;const p=()=>{d.read().then(({value:y,done:v})=>{if(v){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),p())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const v of f.renderTasks)v.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};p()}_abortOperatorList({intentState:t,reason:e,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(e instanceof Bd){let a=zT;e.extraDelay>0&&e.extraDelay<1e3&&(a+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},a);return}}if(t.streamReader.cancel(new Vs(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[a,r]of this._intentStates)if(r===t){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}var Gs,Di,ds,Sn,sc,En,Tn,ze,Kl,vb,bb,$r,Ua,Wl;const Qt=class Qt{constructor({name:t=null,port:e=null,verbosity:s=AE()}={}){Ii(this,ze);Ii(this,Gs,Promise.withResolvers());Ii(this,Di,null);Ii(this,ds,null);Ii(this,Sn,null);if(this.name=t,this.destroyed=!1,this.verbosity=s,e){if(Wt(Qt,Tn).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Wt(Qt,Tn).set(e,this),Ui(this,ze,vb).call(this,e)}else Ui(this,ze,bb).call(this)}get promise(){return Wt(this,Gs).promise}get port(){return Wt(this,ds)}get messageHandler(){return Wt(this,Di)}destroy(){this.destroyed=!0,Wt(this,Sn)?.terminate(),Xe(this,Sn,null),Wt(Qt,Tn).delete(Wt(this,ds)),Xe(this,ds,null),Wt(this,Di)?.destroy(),Xe(this,Di,null)}static create(t){const e=Wt(this,Tn).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Qt(t)}static get workerSrc(){if(Ia.workerSrc)return Ia.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return yt(this,"_setupFakeWorkerGlobal",(async()=>Wt(this,Ua,Wl)?Wt(this,Ua,Wl):(await import(this.workerSrc)).WorkerMessageHandler)())}};Gs=new WeakMap,Di=new WeakMap,ds=new WeakMap,Sn=new WeakMap,sc=new WeakMap,En=new WeakMap,Tn=new WeakMap,ze=new WeakSet,Kl=function(){Wt(this,Gs).resolve(),Wt(this,Di).send("configure",{verbosity:this.verbosity})},vb=function(t){Xe(this,ds,t),Xe(this,Di,new Hr("main","worker",t)),Wt(this,Di).on("ready",()=>{}),Ui(this,ze,Kl).call(this)},bb=function(){if(Wt(Qt,En)||Wt(Qt,Ua,Wl)){Ui(this,ze,$r).call(this);return}let{workerSrc:t}=Qt;try{Qt._isSameOrigin(window.location,t)||(t=Qt._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),s=new Hr("main","worker",e),a=()=>{r.abort(),s.destroy(),e.terminate(),this.destroyed?Wt(this,Gs).reject(new Error("Worker was destroyed")):Ui(this,ze,$r).call(this)},r=new AbortController;e.addEventListener("error",()=>{Wt(this,Sn)||a()},{signal:r.signal}),s.on("test",u=>{if(r.abort(),this.destroyed||!u){a();return}Xe(this,Di,s),Xe(this,ds,e),Xe(this,Sn,e),Ui(this,ze,Kl).call(this)}),s.on("ready",u=>{if(r.abort(),this.destroyed){a();return}try{c()}catch{Ui(this,ze,$r).call(this)}});const c=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};c();return}catch{cc("The worker has been disabled.")}Ui(this,ze,$r).call(this)},$r=function(){Wt(Qt,En)||(mt("Setting up fake worker."),Xe(Qt,En,!0)),Qt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Wt(this,Gs).reject(new Error("Worker was destroyed"));return}const e=new QE;Xe(this,ds,e);const s=`fake${Jm(Qt,sc)._++}`,a=new Hr(s+"_worker",s,e);t.setup(a,e),Xe(this,Di,new Hr(s,s+"_worker",e)),Ui(this,ze,Kl).call(this)}).catch(t=>{Wt(this,Gs).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Ua=new WeakSet,Wl=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Ii(Qt,Ua),Ii(Qt,sc,0),Ii(Qt,En,!1),Ii(Qt,Tn,new WeakMap),Ie&&(Xe(Qt,En,!0),Ia.workerSrc||="./pdf.worker.mjs"),Qt._isSameOrigin=(t,e)=>{const s=URL.parse(t);if(!s?.origin||s.origin==="null")return!1;const a=new URL(e,s);return s.origin===a.origin},Qt._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Qt.fromPort=t=>{if(LE("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Qt.create(t)};let ao=Qt;class $T{#t=new Map;#e=new Map;#s=new Map;#i=new Map;#r=null;constructor(t,e,s,a,r,c){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new pb,this.fontLoader=new qE({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=c,this.setupMessageHandler()}#a(t,e=null){const s=this.#t.get(t);if(s)return s;const a=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,a),a}get annotationStorage(){return yt(this,"annotationStorage",new jd)}getRenderingIntent(t,e=$s.ENABLE,s=null,a=!1,r=!1){let c=li.DISPLAY,u=_d;switch(t){case"any":c=li.ANY;break;case"display":break;case"print":c=li.PRINT;break;default:mt(`getRenderingIntent - invalid intent: ${t}`)}const d=c&li.PRINT&&s instanceof sb?s:this.annotationStorage;switch(e){case $s.DISABLE:c+=li.ANNOTATIONS_DISABLE;break;case $s.ENABLE:break;case $s.ENABLE_FORMS:c+=li.ANNOTATIONS_FORMS;break;case $s.ENABLE_STORAGE:c+=li.ANNOTATIONS_STORAGE,u=d.serializable;break;default:mt(`getRenderingIntent - invalid annotationMode: ${e}`)}a&&(c+=li.IS_EDITING),r&&(c+=li.OPLIST);const{ids:f,hash:p}=d.modifiedIds,y=[c,u.hash,p];return{renderingIntent:c,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#e.values())t.push(s._destroy());this.#e.clear(),this.#s.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Pe.cleanup(),this._networkStream?.cancelAllRequests(new Vs("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(s,a)=>{Dt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},a.onPull=()=>{this._fullReader.read().then(function({value:r,done:c}){if(c){a.close();return}Dt(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{a.error(r)})},a.onCancel=r=>{this._fullReader.cancel(r),a.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:a,isRangeSupported:r,contentLength:c}=this._fullReader;return(!a||!r)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{e.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:a,isRangeSupported:r,contentLength:c}}),t.on("GetRangeReader",(s,a)=>{Dt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){a.close();return}a.onPull=()=>{r.read().then(function({value:c,done:u}){if(u){a.close();return}Dt(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{a.error(c)})},a.onCancel=c=>{r.cancel(c),a.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,e._capability.resolve(new FT(s,this))}),t.on("DocException",s=>{e._capability.reject(Ke(s))}),t.on("PasswordRequest",s=>{this.#r=Promise.withResolvers();try{if(!e.onPassword)throw Ke(s);const a=r=>{r instanceof Error?this.#r.reject(r):this.#r.resolve({password:r})};e.onPassword(a,s.code)}catch(a){this.#r.reject(a)}return this.#r.promise}),t.on("DataLoaded",s=>{e.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#e.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,a,r])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(a){case"Font":if("error"in r){const y=r.error;mt(`Error during font loading: ${y}`),this.commonObjs.resolve(s,y);break}const c=new Ht(r),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(y,v)=>globalThis.FontInspector.fontAdded(y,v):null,d=new VE(c,u,r.extra,r.charProcOperatorList);this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(s,d)});break;case"CopyLocalImage":const{imageRef:f}=r;Dt(f,"The imageRef must be defined.");for(const y of this.#e.values())for(const[,v]of y.objs)if(v?.ref===f)return v.dataLen?(this.commonObjs.resolve(s,structuredClone(v)),v.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(s,r);break;case"Pattern":const p=new _e(r);this.commonObjs.resolve(s,p.getIR());break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),t.on("obj",([s,a,r,c])=>{if(this.destroyed)return;const u=this.#e.get(a);if(!u.objs.has(s)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(r){case"Image":case"Pattern":u.objs.resolve(s,c);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",s=>{this.destroyed||e.onProgress?.({loaded:s.loaded,total:s.total})}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const a=this[s.type];if(!a)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return a.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&mt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,s=this.#s.get(e);if(s)return s;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&this.#i.set(r.refStr,t);const c=new HT(e,r,this,this._params.pdfBug);return this.#e.set(e,c),c});return this.#s.set(e,a),a}getPageIndex(t){return wd(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#a("GetFieldObjects")}hasJSActions(){return this.#a("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#a("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#a("GetOptionalContentConfig").then(e=>new wT(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const s=this.messageHandler.sendWithPromise(t,null).then(a=>({info:a[0],metadata:a[1]?new bT(a[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:a[2]}));return this.#t.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Pe.cleanup()}}cachedPageNumber(t){if(!wd(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}}class GT{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Ma{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:s,commonObjs:a,annotationCanvasMap:r,operatorList:c,pageIndex:u,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:y=!1,pageColors:v=null,enableHWA:b=!1,operationsFilter:A=null}){this.callback=t,this.params=e,this.objs=s,this.commonObjs=a,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=y,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new GT(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=b,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=A}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Ma.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Ma.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:a,background:r,dependencyTracker:c}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Pa(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:a,viewport:s,transparency:t,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Ma.#e.delete(this._canvas),t||=new Bd(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Ma.#e.delete(this._canvas),this.callback())))}}const qT="5.4.449",VT="f44e5f0e6";class Ei{#t=null;#e=null;#s;#i=null;#r=!1;#a=!1;#n=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return yt(this,"_keyboardManager",new go([[["Escape","mac+Escape"],Ei.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ei.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ei.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ei.prototype._moveToPrevious],[["Home","mac+Home"],Ei.prototype._moveToBeginning],[["End","mac+End"],Ei.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#a=!1,this.#n=t):this.#a=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#s=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Ei.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#n&&(t.ariaControls=`${this.#n.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#p.bind(this),{signal:e}),t.addEventListener("keydown",this.#m.bind(this),{signal:e});const s=this.#e=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#s,t.append(s),t}renderMainDropdown(){const t=this.#i=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",Ti,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#n&&(t.id=`${this.#n.id}_colorpicker_dropdown`);for(const[s,a]of this.#l.highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",a),r.title=s,r.setAttribute("data-l10n-id",Ei.#d[s]);const c=document.createElement("span");r.append(c),c.className="swatch",c.style.backgroundColor=a,r.ariaSelected=a===this.#s,r.addEventListener("click",this.#f.bind(this,a),{signal:e}),t.append(r)}return t.addEventListener("keydown",this.#m.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:kt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#g){this.#p(t);return}if(t.target===this.#t){this.#i.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstElementChild||t.target===this.#t){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#g){this.#p(t);return}this.#i.firstElementChild?.focus()}_moveToEnd(t){if(!this.#g){this.#p(t);return}this.#i.lastElementChild?.focus()}#m(t){Ei._keyboardManager.exec(this,t)}#p(t){if(this.#g){this.hideDropdown();return}if(this.#r=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#h();this.#t.append(e)}#u(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#g(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#a){if(!this.#g){this.#n?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#l.highlightColors.values();for(const s of this.#i.children)s.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class ro{#t=null;#e=null;#s=null;static#i=null;constructor(t){this.#e=t,this.#s=t._uiManager,ro.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,color:s}=this.#e,a=this.#t=document.createElement("input");return a.type="color",a.value=s||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",ro.#i[t]),a.addEventListener("input",()=>{this.#s.updateParams(e,a.value)},{signal:this.#s._signal}),a}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function _v(l){return Math.floor(Math.max(0,Math.min(1,l))*255).toString(16).padStart(2,"0")}function Ur(l){return Math.max(0,Math.min(255,255*l))}class wv{static CMYK_G([t,e,s,a]){return["G",1-Math.min(1,.3*t+.59*s+.11*e+a)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Ur(t),[t,t,t]}static G_HTML([t]){const e=_v(t);return`#${e}${e}${e}`}static RGB_G([t,e,s]){return["G",.3*t+.59*e+.11*s]}static RGB_rgb(t){return t.map(Ur)}static RGB_HTML(t){return`#${t.map(_v).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,s,a]){return["RGB",1-Math.min(1,t+a),1-Math.min(1,s+a),1-Math.min(1,e+a)]}static CMYK_rgb([t,e,s,a]){return[Ur(1-Math.min(1,t+a)),Ur(1-Math.min(1,s+a)),Ur(1-Math.min(1,e+a))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,s]){const a=1-t,r=1-e,c=1-s,u=Math.min(a,r,c);return["CMYK",a,r,c,u]}}class YT{create(t,e,s=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),s||(a.setAttribute("width",`${t}px`),a.setAttribute("height",`${e}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${t} ${e}`),a}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){qt("Abstract method `_createSVG` called.")}}class ic extends YT{_createSVG(t){return document.createElementNS(cs,t)}}const XT=9,Rn=new WeakSet,KT=new Date().getTimezoneOffset()*60*1e3;class id{static create(t){switch(t.data.annotationType){case ge.LINK:return new Gd(t);case ge.TEXT:return new QT(t);case ge.WIDGET:switch(t.data.fieldType){case"Tx":return new JT(t);case"Btn":return t.data.radioButton?new _b(t):t.data.checkBox?new t1(t):new e1(t);case"Ch":return new i1(t);case"Sig":return new ZT(t)}return new kn(t);case ge.POPUP:return new Ed(t);case ge.FREETEXT:return new wb(t);case ge.LINE:return new n1(t);case ge.SQUARE:return new a1(t);case ge.CIRCLE:return new r1(t);case ge.POLYLINE:return new Ab(t);case ge.CARET:return new l1(t);case ge.INK:return new qd(t);case ge.POLYGON:return new o1(t);case ge.HIGHLIGHT:return new Sb(t);case ge.UNDERLINE:return new c1(t);case ge.SQUIGGLY:return new u1(t);case ge.STRIKEOUT:return new h1(t);case ge.STAMP:return new Eb(t);case ge.FILEATTACHMENT:return new d1(t);default:return new te(t)}}}class te{#t=null;#e=!1;#s=null;constructor(t,{isRenderable:e=!1,ignoreBorder:s=!1,createQuadrilaterals:a=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(s)),a&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return te._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:s,rect:a}=this.data;let r=-1/0,c=-1/0;if(e?.length>=8){for(let u=0;u<e.length;u+=8)e[u+1]>c?(c=e[u+1],r=e[u+2]):e[u+1]===c&&(r=Math.max(r,e[u+2]));return[r,c]}if(s?.length>=1){for(const u of s)for(let d=0,f=u.length;d<f;d+=2)u[d+1]>c?(c=u[d+1],r=u[d]):u[d+1]===c&&(r=Math.max(r,u[d]));if(r!==1/0)return[r,c]}return a?[a[2],a[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:r,pageY:c}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-r)/s,t[1]=100*(t[1]-c)/a,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${io}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:s})||this.annotationStorage.setValue(`${io}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#s?.popup||this.popup)?.remove(),this.#s=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:s}=t;e&&this.#i(e);let a=this.#s?.popup||this.popup;!a&&s?.text&&(this._createPopup(s),a=this.#s.popup),a&&(a.updateEdited(t),s?.deleted&&(a.remove(),this.#s=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#s?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:e},data:{rect:s,rotation:a},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:c,pageX:u,pageY:d}}}}=this;s?.splice(0,4,...t),e.left=`${100*(t[0]-u)/r}%`,e.top=`${100*(c-t[3]+d)/c}%`,a===0?(e.width=`${100*(t[2]-t[0])/r}%`,e.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(a)}_createContainer(t){const{data:e,parent:{page:s,viewport:a}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),!(this instanceof kn)&&!(this instanceof Gd)&&(r.tabIndex=0);const{style:c}=r;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof Ed){const{rotation:w}=e;return!e.hasOwnCanvas&&w!==0&&this.setRotation(w,r),r}const{width:u,height:d}=this;if(!t&&e.borderStyle.width>0){c.borderWidth=`${e.borderStyle.width}px`;const w=e.borderStyle.horizontalCornerRadius,E=e.borderStyle.verticalCornerRadius;if(w>0||E>0){const x=`calc(${w}px * var(--total-scale-factor)) / calc(${E}px * var(--total-scale-factor))`;c.borderRadius=x}else if(this instanceof _b){const x=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;c.borderRadius=x}switch(e.borderStyle.style){case Ca.SOLID:c.borderStyle="solid";break;case Ca.DASHED:c.borderStyle="dashed";break;case Ca.BEVELED:mt("Unimplemented border style: beveled");break;case Ca.INSET:mt("Unimplemented border style: inset");break;case Ca.UNDERLINE:c.borderBottomStyle="solid";break}const S=e.borderColor||null;S?(this.#e=!0,c.borderColor=et.makeHexColor(S[0]|0,S[1]|0,S[2]|0)):c.borderWidth=0}const f=et.normalizeRect([e.rect[0],s.view[3]-e.rect[1]+s.view[1],e.rect[2],s.view[3]-e.rect[3]+s.view[1]]),{pageWidth:p,pageHeight:y,pageX:v,pageY:b}=a.rawDims;c.left=`${100*(f[0]-v)/p}%`,c.top=`${100*(f[1]-b)/y}%`;const{rotation:A}=e;return e.hasOwnCanvas||A===0?(c.width=`${100*u/p}%`,c.height=`${100*d/y}%`):this.setRotation(A,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:a}=this.parent.viewport.rawDims;let{width:r,height:c}=this;t%180!==0&&([r,c]=[c,r]),e.style.width=`${100*r/s}%`,e.style.height=`${100*c/a}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,s,a)=>{const r=a.detail[e],c=r[0],u=r.slice(1);a.target.style[s]=wv[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:wv[`${c}_rgb`](u)})};return yt(this,"_commonActions",{display:e=>{const{display:s}=e.detail,a=s%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:s===1||s===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:s}=e.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const s=e.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,e){const s=this._commonActions;for(const a of Object.keys(e.detail))(t[a]||s[a])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const s=this._commonActions;for(const[a,r]of Object.entries(e)){const c=s[a];if(c){const u={detail:{[a]:r},target:t};c(u),delete e[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,s,a,r]=this.data.rect.map(w=>Math.fround(w));if(t.length===8){const[w,E,S,x]=t.subarray(2,6);if(a===w&&r===E&&e===S&&s===x)return}const{style:c}=this.container;let u;if(this.#e){const{borderColor:w,borderWidth:E}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const d=a-e,f=r-s,{svgFactory:p}=this,y=p.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const v=p.createElement("defs");y.append(v);const b=p.createElement("clipPath"),A=`clippath_${this.data.id}`;b.setAttribute("id",A),b.setAttribute("clipPathUnits","objectBoundingBox"),v.append(b);for(let w=2,E=t.length;w<E;w+=8){const S=t[w],x=t[w+1],C=t[w+2],k=t[w+3],L=p.createElement("rect"),R=(C-e)/d,D=(r-x)/f,z=(S-C)/d,Y=(x-k)/f;L.setAttribute("x",R),L.setAttribute("y",D),L.setAttribute("width",z),L.setAttribute("height",Y),b.append(L),u?.push(`<rect vector-effect="non-scaling-stroke" x="${R}" y="${D}" width="${z}" height="${Y}"/>`)}this.#e&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${A})`}_createPopup(t=null){const{data:e}=this;let s,a;t?(s={str:t.text},a=t.date):(s=e.contentsObj,a=e.modificationDate),this.#s=new Ed({data:{color:e.color,titleObj:e.titleObj,modificationDate:a,contentsObj:s,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#s||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#s}render(){qt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const s=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:r,id:c,exportValues:u}of a){if(r===-1||c===e)continue;const d=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!Rn.has(f)){mt(`_getElementsByName - element not allowed: ${c}`);continue}s.push({id:c,exportValue:d,domElement:f})}return s}for(const a of document.getElementsByName(t)){const{exportValue:r}=a,c=a.getAttribute("data-element-id");c!==e&&Rn.has(a)&&s.push({id:c,exportValue:r,domElement:a})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class WT extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Gd extends te{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let a=!1;return t.url?(e.addLinkAttributes(s,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),a=!0):t.attachment?(this.#e(s,t.attachment,t.overlaidText,t.attachmentDest),a=!0):t.setOCGState?(this.#s(s,t.setOCGState,t.overlaidText),a=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),a=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(s,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&(this.contentElement=s,this.container.append(s)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,s=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),s&&(t.title=s)}_bindNamedAction(t,e,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),s&&(t.title=s),this.#t()}#e(t,e,s="",a=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:s&&(t.title=s),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,a),!1),this.#t()}#s(t,e,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),s&&(t.title=s),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(e.actions)){const r=s.get(a);r&&(t[r]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:a}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){mt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:a,refs:r,include:c}=e,u=[];if(a.length!==0||r.length!==0){const p=new Set(r);for(const y of a){const v=this._fieldObjects[y]||[];for(const{id:b}of v)p.add(b)}for(const y of Object.values(this._fieldObjects))for(const v of y)p.has(v.id)===c&&u.push(v)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const d=this.annotationStorage,f=[];for(const p of u){const{id:y}=p;switch(f.push(y),p.type){case"text":{const b=p.defaultValue||"";d.setValue(y,{value:b});break}case"checkbox":case"radiobutton":{const b=p.defaultValue===p.exportValues;d.setValue(y,{value:b});break}case"combobox":case"listbox":{const b=p.defaultValue||"";d.setValue(y,{value:b});break}default:continue}const v=document.querySelector(`[data-element-id="${y}"]`);if(v){if(!Rn.has(v)){mt(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class QT extends te{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class kn extends te{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Me.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,s,a,r){s.includes("mouse")?t.addEventListener(s,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:r(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(s,c=>{if(s==="blur"){if(!e.focused||!c.relatedTarget)return;e.focused=!1}else if(s==="focus"){if(e.focused)return;e.focused=!0}r&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:r(c)}})})}_setEventListeners(t,e,s,a){for(const[r,c]of s)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,r,c,a),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":et.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||XT,r=t.style;let c;const u=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(f/(Xh*a))||1,y=f/p;c=Math.min(a,d(y/Xh))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(a,d(f/Xh))}r.fontSize=`calc(${c}px * var(--total-scale-factor))`,r.color=et.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class JT extends kn{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,s,a){const r=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[e]=s),r.setValue(c.id,{[a]:s})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let r=a.value||"";const c=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;c&&r.length>c&&(r=r.slice(0,c));let u=a.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:r,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??r,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??r),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Rn.add(s),this.contentElement=s,s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:y}=this.data,v=!!p&&this.enableScripting;f&&(s.title=f),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",A=>{t.setValue(e,{value:A.target.value}),this.setPropertyOnSiblings(s,"value",A.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",A=>{const w=this.data.defaultFieldValue??"";s.value=d.userValue=w,d.formattedValue=null});let b=A=>{const{formattedValue:w}=d;w!=null&&(A.target.value=w),A.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",w=>{if(d.focused)return;const{target:E}=w;if(v&&(E.type=p,y&&(E.step=y)),d.userValue){const S=d.userValue;if(v)if(p==="time"){const x=new Date(S),C=[x.getHours(),x.getMinutes(),x.getSeconds()];E.value=C.map(k=>k.toString().padStart(2,"0")).join(":")}else E.value=new Date(S-KT).toISOString().split(p==="date"?"T":".",1)[0];else E.value=S}d.lastCommittedValue=E.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",w=>{this.showElementAndHideCanvas(w.target);const E={value(S){d.userValue=S.detail.value??"",v||t.setValue(e,{value:d.userValue.toString()}),S.target.value=d.userValue},formattedValue(S){const{formattedValue:x}=S.detail;d.formattedValue=x,x!=null&&S.target!==document.activeElement&&(S.target.value=x);const C={formattedValue:x};v&&(C.value=x),t.setValue(e,C)},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{const{charLimit:x}=S.detail,{target:C}=S;if(x===0){C.removeAttribute("maxLength");return}C.setAttribute("maxLength",x);let k=d.userValue;!k||k.length<=x||(k=k.slice(0,x),C.value=d.userValue=k,t.setValue(e,{value:k}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:k,willCommit:!0,commitKey:1,selStart:C.selectionStart,selEnd:C.selectionEnd}}))}};this._dispatchEventFromSandbox(E,w)}),s.addEventListener("keydown",w=>{d.commitKey=1;let E=-1;if(w.key==="Escape"?E=0:w.key==="Enter"&&!this.data.multiLine?E=2:w.key==="Tab"&&(d.commitKey=3),E===-1)return;const{value:S}=w.target;d.lastCommittedValue!==S&&(d.lastCommittedValue=S,d.userValue=S,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:S,willCommit:!0,commitKey:E,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}))});const A=b;b=null,s.addEventListener("blur",w=>{if(!d.focused||!w.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:E}=w;let{value:S}=E;if(v){if(S&&p==="time"){const x=S.split(":").map(C=>parseInt(C,10));S=new Date(2e3,0,1,x[0],x[1],x[2]||0).valueOf(),E.step=""}else S.includes("T")||(S=`${S}T00:00`),S=new Date(S).valueOf();E.type="text"}d.userValue=S,d.lastCommittedValue!==S&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:S,willCommit:!0,commitKey:d.commitKey,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}),A(w)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",w=>{d.lastCommittedValue=null;const{data:E,target:S}=w,{value:x,selectionStart:C,selectionEnd:k}=S;let L=C,R=k;switch(w.inputType){case"deleteWordBackward":{const D=x.substring(0,C).match(/\w*[^\w]*$/);D&&(L-=D[0].length);break}case"deleteWordForward":{const D=x.substring(C).match(/^[^\w]*\w*/);D&&(R+=D[0].length);break}case"deleteContentBackward":C===k&&(L-=1);break;case"deleteContentForward":C===k&&(R+=1);break}w.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:x,change:E||"",willCommit:!1,selStart:L,selEnd:R}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.value)}if(b&&s.addEventListener("blur",b),this.data.comb){const w=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${w}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class ZT extends kn{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class t1 extends kn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,s=e.id;let a=t.getValue(s,{value:e.exportValue===e.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",t.setValue(s,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Rn.add(r),r.setAttribute("data-element-id",s),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,a&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=0,r.addEventListener("change",c=>{const{name:u,checked:d}=c.target;for(const f of this._getElementsByName(u,s)){const p=d&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}t.setValue(s,{value:d})}),r.addEventListener("resetform",c=>{const u=e.defaultFieldValue||"Off";c.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",c=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(s,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class _b extends kn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,s=e.id;let a=t.getValue(s,{value:e.fieldValue===e.buttonValue}).value;if(typeof a=="string"&&(a=a!==e.buttonValue,t.setValue(s,{value:a})),a)for(const c of this._getElementsByName(e.fieldName,s))t.setValue(c.id,{value:!1});const r=document.createElement("input");if(Rn.add(r),r.setAttribute("data-element-id",s),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,a&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",c=>{const{name:u,checked:d}=c.target;for(const f of this._getElementsByName(u,s))t.setValue(f.id,{value:!1});t.setValue(s,{value:d})}),r.addEventListener("resetform",c=>{const u=e.defaultFieldValue;c.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const c=e.buttonValue;r.addEventListener("updatefromsandbox",u=>{const d={value:f=>{const p=c===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const v=p&&y.id===s;y.domElement&&(y.domElement.checked=v),t.setValue(y.id,{value:v})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class e1 extends Gd{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class i1 extends kn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,s=t.getValue(e,{value:this.data.fieldValue}),a=document.createElement("select");Rn.add(a),a.setAttribute("data-element-id",e),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",p=>{const y=this.data.defaultFieldValue;for(const v of a.options)v.selected=v.value===y});for(const p of this.data.options){const y=document.createElement("option");y.textContent=p.displayValue,y.value=p.exportValue,s.value.includes(p.exportValue)&&(y.setAttribute("selected",!0),r=!1),a.append(y)}let c=null;if(r){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),a.prepend(p),c=()=>{p.remove(),a.removeEventListener("input",c),c=null},a.addEventListener("input",c)}const u=p=>{const y=p?"value":"textContent",{options:v,multiple:b}=a;return b?Array.prototype.filter.call(v,A=>A.selected).map(A=>A[y]):v.selectedIndex===-1?null:v[v.selectedIndex][y]};let d=u(!1);const f=p=>{const y=p.target.options;return Array.prototype.map.call(y,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",p=>{const y={value(v){c?.();const b=v.detail.value,A=new Set(Array.isArray(b)?b:[b]);for(const w of a.options)w.selected=A.has(w.value);t.setValue(e,{value:u(!0)}),d=u(!1)},multipleSelection(v){a.multiple=!0},remove(v){const b=a.options,A=v.detail.remove;b[A].selected=!1,a.remove(A),b.length>0&&Array.prototype.findIndex.call(b,E=>E.selected)===-1&&(b[0].selected=!0),t.setValue(e,{value:u(!0),items:f(v)}),d=u(!1)},clear(v){for(;a.length!==0;)a.remove(0);t.setValue(e,{value:null,items:[]}),d=u(!1)},insert(v){const{index:b,displayValue:A,exportValue:w}=v.detail.insert,E=a.children[b],S=document.createElement("option");S.textContent=A,S.value=w,E?E.before(S):a.append(S),t.setValue(e,{value:u(!0),items:f(v)}),d=u(!1)},items(v){const{items:b}=v.detail;for(;a.length!==0;)a.remove(0);for(const A of b){const{displayValue:w,exportValue:E}=A,S=document.createElement("option");S.textContent=w,S.value=E,a.append(S)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(v)}),d=u(!1)},indices(v){const b=new Set(v.detail.indices);for(const A of v.target.options)A.selected=b.has(A.index);t.setValue(e,{value:u(!0)}),d=u(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(y,p)}),a.addEventListener("input",p=>{const y=u(!0),v=u(!1);t.setValue(e,{value:y}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:d,change:v,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):a.addEventListener("input",function(p){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class Ed extends te{constructor(t){const{data:e,elements:s,parent:a}=t,r=!!a._commentManager;if(super(t,{isRenderable:!r&&te._hasPopupData(e)}),this.elements=s,r&&te._hasPopupData(e)){const c=this.popup=this.#t();for(const u of s)u.popup=c}else this.popup=null}#t(){return new s1({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),s=[];for(const a of this.elements)a.popup=e,a.container.ariaHasPopup="dialog",s.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(a=>`${ka}${a}`).join(",")),this.container}}class s1{#t=null;#e=this.#G.bind(this);#s=this.#j.bind(this);#i=this.#N.bind(this);#r=this.#A.bind(this);#a=null;#n=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#m=null;#p=null;#u=null;#g=null;#y=null;#b=null;#v=null;#T=null;#S=null;#w=null;#x=!1;#_=null;#E=null;constructor({container:t,color:e,elements:s,titleObj:a,modificationDate:r,contentsObj:c,richText:u,parent:d,rect:f,parentRect:p,open:y,commentManager:v=null}){this.#n=t,this.#S=a,this.#o=c,this.#T=u,this.#d=d,this.#a=e,this.#v=f,this.#h=p,this.#l=s,this.#t=v,this.#_=s[0],this.#c=yd.toDateObject(r),this.trigger=s.flatMap(b=>b.getElementsToTriggerPopup()),v||(this.#k(),this.#n.hidden=!0,y&&this.#A())}#k(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const e of this.trigger)e.addEventListener("click",this.#r,{signal:t}),e.addEventListener("pointerenter",this.#i,{signal:t}),e.addEventListener("pointerleave",this.#s,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#R(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#g){this.#g.parentNode||this.#_.container.after(this.#g);return}if(this.#y||this.#R(),!this.#y)return;const{signal:t}=this.#p=new AbortController,e=this.#_.hasOwnCommentButton,s=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},a=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},r=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#g=this.#_.container;for(const c of this.trigger)c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",s,{signal:t}),c.addEventListener("pointerenter",a,{signal:t}),c.addEventListener("pointerleave",r,{signal:t}),c.classList.add("popupTriggerArea")}else{const c=this.#g=document.createElement("button");c.className="annotationCommentButton";const u=this.#_.container;c.style.zIndex=u.style.zIndex+1,c.tabIndex=0,c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#I(),this.#O(),c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",s,{signal:t}),c.addEventListener("pointerenter",a,{signal:t}),c.addEventListener("pointerleave",r,{signal:t}),u.after(c)}}#O(){if(this.#_.extraPopupElement&&!this.#_.editor)return;this.#g||this.renderCommentButton();const[t,e]=this.#y,{style:s}=this.#g;s.left=`calc(${t}%)`,s.top=`calc(${e}% - var(--comment-button-dim))`}#I(){this.#_.extraPopupElement||(this.#g||this.renderCommentButton(),this.#g.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#_.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#g?.focus()},0)}getData(){const{richText:t,color:e,opacity:s,creationDate:a,modificationDate:r}=this.#_.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:s,creationDate:a,modificationDate:r}}get elementBeforePopup(){return this.#g}get comment(){return this.#E||=this.#_.commentText,this.#E}set comment(t){t!==this.comment&&(this.#_.commentText=this.#E=t)}focus(){this.#_.container?.focus()}get parentBoundingClientRect(){return this.#_.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#g&&(this.#g.classList.toggle("selected",t),this.#g.ariaExpanded=e)}setSelectedCommentButton(t){this.#g.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#b)return this.#b;const{x:t,y:e,height:s}=this.#g.getBoundingClientRect(),{x:a,y:r,width:c,height:u}=this.#_.layer.getBoundingClientRect();return[(t-a)/c,(e+s-r)/u]}set commentPopupPosition(t){this.#b=t}hasDefaultPopupPosition(){return this.#b===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#g.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,s]=this.#b||this.commentButtonPosition.map(f=>f/100),a=this.parentBoundingClientRect,{x:r,y:c,width:u,height:d}=a;this.#t.showDialog(null,this,r+e*u,c+s*d,{...t,parentDimensions:a})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#a){const s=t.style.outlineColor=et.makeHexColor(...this.#a);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#S?.str){const s=document.createElement("span");s.className="title",e.append(s),{dir:s.dir,str:s.textContent}=this.#S}if(t.append(e),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),e.append(s)}Zv({html:this.#M||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#n.append(t)}get#M(){const t=this.#T,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#T.html||null}get#L(){return this.#M?.attributes?.style?.fontSize||0}get#U(){return this.#M?.attributes?.style?.color||null}#B(t){const e=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},a={style:{color:this.#U,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const r of t.split(`
`))e.push({name:"span",value:r,attributes:a});return s}#G(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#A()}updateEdited({rect:t,popup:e,deleted:s}){if(this.#t){s?(this.remove(),this.#E=null):e&&(e.deleted?this.remove():(this.#I(),this.#E=e.text)),t&&(this.#y=null,this.#R(),this.#O());return}if(s||e?.deleted){this.remove();return}this.#k(),this.#w||={contentsObj:this.#o,richText:this.#T},t&&(this.#u=null),e&&e.text&&(this.#T=this.#B(e.text),this.#c=yd.toDateObject(e.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#w&&({contentsObj:this.#o,richText:this.#T}=this.#w,this.#w=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#p?.abort(),this.#p=null,this.#m?.remove(),this.#m=null,this.#x=!1,this.#f=!1,this.#g?.remove(),this.#g=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#C(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:s,pageX:a,pageY:r}}}=this.#d;let c=!!this.#h,u=c?this.#h:this.#v;for(const A of this.#l)if(!u||et.intersect(A.data.rect,u)!==null){u=A.data.rect,c=!0;break}const d=et.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=c?u[2]-u[0]+5:0,y=d[0]+p,v=d[1];this.#u=[100*(y-a)/e,100*(v-r)/s];const{style:b}=this.#n;b.left=`${this.#u[0]}%`,b.top=`${this.#u[1]}%`}#A(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#N(),this.#n.addEventListener("click",this.#r),this.#n.addEventListener("keydown",this.#e)):(this.#j(),this.#n.removeEventListener("click",this.#r),this.#n.removeEventListener("keydown",this.#e))}#N(){this.#m||this.render(),this.isVisible?this.#f&&this.#n.classList.add("focused"):(this.#C(),this.#n.hidden=!1,this.#n.style.zIndex=parseInt(this.#n.style.zIndex)+1e3)}#j(){this.#n.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#n.hidden=!0,this.#n.style.zIndex=parseInt(this.#n.style.zIndex)-1e3)}forceHide(){this.#x=this.isVisible,this.#x&&(this.#n.hidden=!0)}maybeShow(){this.#t||(this.#k(),this.#x&&(this.#m||this.#N(),this.#x=!1,this.#n.hidden=!1))}get isVisible(){return this.#t?!1:this.#n.hidden===!1}}class wb extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=bt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const s=document.createElement("span");s.textContent=e,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class n1 extends te{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:s}=this,a=this.svgFactory.create(e,s,!0),r=this.#t=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),a.append(r),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class a1 extends te{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:s}=this,a=this.svgFactory.create(e,s,!0),r=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",r/2),c.setAttribute("y",r/2),c.setAttribute("width",e-r),c.setAttribute("height",s-r),c.setAttribute("stroke-width",r||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class r1 extends te{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:s}=this,a=this.svgFactory.create(e,s,!0),r=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",e/2),c.setAttribute("cy",s/2),c.setAttribute("rx",e/2-r/2),c.setAttribute("ry",s/2-r/2),c.setAttribute("stroke-width",r||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ab extends te{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:s,popupRef:a},width:r,height:c}=this;if(!e)return this.container;const u=this.svgFactory.create(r,c,!0);let d=[];for(let p=0,y=e.length;p<y;p+=2){const v=e[p]-t[0],b=t[3]-e[p+1];d.push(`${v},${b}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class o1 extends Ab{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class l1 extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class qd extends te{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?bt.HIGHLIGHT:bt.INK}#s(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:s,borderStyle:a,popupRef:r}}=this,{transform:c,width:u,height:d}=this.#s(e,t),f=this.svgFactory.create(u,d,!0),p=this.#t=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",a.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",c);for(let y=0,v=s.length;y<v;y++){const b=this.svgFactory.createElement(this.svgElementName);this.#e.push(b),b.setAttribute("points",s[y].join(",")),p.append(b)}return!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:s,rect:a}=t,r=this.#t;if(e>=0&&r.setAttribute("stroke-width",e||1),s)for(let c=0,u=this.#e.length;c<u;c++)this.#e[c].setAttribute("points",s[c].join(","));if(a){const{transform:c,width:u,height:d}=this.#s(this.data.rotation,a);r.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),r.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Sb extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=bt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class c1 extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class u1 extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class h1 extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Eb extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=bt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class d1 extends te{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let s;e.hasAppearance||e.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:a}=Me.platform;return t.addEventListener("keydown",r=>{r.key==="Enter"&&(a?r.metaKey:r.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Vd{#t=null;#e=null;#s=null;#i=new Map;#r=null;#a=null;#n=[];#o=!1;constructor({div:t,accessibilityManager:e,annotationCanvasMap:s,annotationEditorUIManager:a,page:r,viewport:c,structTreeLayer:u,commentManager:d,linkService:f,annotationStorage:p}){this.div=t,this.#t=e,this.#e=s,this.#r=u||null,this.#a=f||null,this.#s=p||new jd,this.page=r,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=a,this._commentManager=d||null}hasEditableAnnotations(){return this.#i.size>0}async render(t){const{annotations:e}=t,s=this.div;xn(s,this.viewport);const a=new Map,r=[],c={data:null,layer:s,linkService:this.#a,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new ic,annotationStorage:this.#s,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of e){if(u.noHTML)continue;const d=u.annotationType===ge.POPUP;if(d){const y=a.get(u.id);if(!y)continue;if(!this._commentManager){r.push(u);continue}c.elements=y}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;c.data=u;const f=id.create(c);if(!f.isRenderable)continue;if(!d&&(this.#n.push(f),u.popupRef)){const y=a.get(u.popupRef);y?y.push(f):a.set(u.popupRef,[f])}const p=f.render();u.hidden&&(p.style.visibility="hidden"),f._isEditable&&(this.#i.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of r){const d=c.elements=a.get(u.id);c.data=u;const f=id.create(c);if(!f.isRenderable)continue;const p=f.render();f.contentElement.id=`${ka}${u.id}`,u.hidden&&(p.style.visibility="hidden"),d.at(-1).container.after(p)}this.#l()}async#c(){if(this.#n.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:s,data:{id:a}}of this.#n){const r=s.id=`${ka}${a}`;t.push(this.#r?.getAriaAttributes(r).then(c=>{if(c)for(const[u,d]of c)s.setAttribute(u,d)}))}}this.#n.sort(({data:{rect:[s,a,r,c]}},{data:{rect:[u,d,f,p]}})=>{if(s===r&&a===c)return 1;if(u===f&&d===p)return-1;const y=c,v=a,b=(a+c)/2,A=p,w=d,E=(d+p)/2;if(b>=A&&E<=v)return-1;if(E>=y&&b<=w)return 1;const S=(s+r)/2,x=(u+f)/2;return S-x});const e=document.createDocumentFragment();for(const s of this.#n)e.append(s.container),this._commentManager?(s.extraPopupElement?.popup||s.popup)?.renderCommentButton():s.extraPopupElement&&e.append(s.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),this.#t)for(const s of this.#n)this.#t.addPointerInTextLayer(s.contentElement,!1)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#a,svgFactory:new ic,parent:this};for(const s of t){s.borderStyle||=Vd._defaultBorderStyle,e.data=s;const a=id.create(e);a.isRenderable&&(a.render(),a.contentElement.id=`${ka}${s.id}`,this.#n.push(a))}await this.#c()}update({viewport:t}){const e=this.div;this.viewport=t,xn(e,{rotation:t.rotation}),this.#l(),e.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[e,s]of this.#e){const a=t.querySelector(`[data-annotation-id="${e}"]`);if(!a)continue;s.className="annotationContent";const{firstChild:r}=a;r?r.nodeName==="CANVAS"?r.replaceWith(s):r.classList.contains("annotationContent")?r.after(s):r.before(s):a.append(s);const c=this.#i.get(e);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,a.id,s),c._hasNoCanvas=!1):c.canvas=s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:s,rotation:a}=t,r=new WT({data:{id:s,rect:t.getPDFRect(),rotation:a},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#a,annotationStorage:this.#s});return r.render(),r.contentElement.id=`${ka}${s}`,r.createOrUpdatePopup(),this.#n.push(r),r}removeAnnotation(t){const e=this.#n.findIndex(a=>a.data.id===t);if(e<0)return;const[s]=this.#n.splice(e,1);this.#t?.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return yt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Ca.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const ql=/\r\n?|\n/g;class we extends rt{#t="";#e=`${this.id}-editor`;#s=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=we.prototype,e=r=>r.isEmpty(),s=Ys.TRANSLATE_SMALL,a=Ys.TRANSLATE_BIG;return yt(this,"_keyboardManager",new go([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:e}]]))}static _type="freetext";static _editorType=bt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||we._defaultColor||rt._defaultLineColor,this.#i=t.fontSize||we._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,e){rt.initialize(t,e);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case kt.FREETEXT_SIZE:we._defaultFontSize=e;break;case kt.FREETEXT_COLOR:we._defaultColor=e;break}}updateParams(t,e){switch(t){case kt.FREETEXT_SIZE:this.#r(e);break;case kt.FREETEXT_COLOR:this.#a(e);break}}static get defaultPropertiesToUpdate(){return[[kt.FREETEXT_SIZE,we._defaultFontSize],[kt.FREETEXT_COLOR,we._defaultColor||rt._defaultLineColor]]}get propertiesToUpdate(){return[[kt.FREETEXT_SIZE,this.#i],[kt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new ro(this),[["colorPicker",this._colorPicker]]}get colorType(){return kt.FREETEXT_COLOR}#r(t){const e=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--total-scale-factor))`,this.translate(0,-(a-this.#i)*this.parentScale),this.#i=a,this.#o()},s=this.#i;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#a(t){const e=a=>{this.color=a,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-we._internalPadding*t,-(we._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#s=new AbortController;const t=this._uiManager.combinedSignal(this.#s);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#s?.abort(),this.#s=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#n(){const t=[];this.editorDiv.normalize();let e=null;for(const s of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(we.#c(s)),e=s);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:a,div:r}=this,c=r.style.display,u=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",a.div.append(this.div),s=r.getBoundingClientRect(),r.remove(),r.style.display=c,r.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/e):(this.width=s.height/t,this.height=s.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#n().trimEnd();if(t===e)return;const s=a=>{if(this.#t=a,!a){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{s(e)},undo:()=>{s(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){we._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[a,r]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[f,p]=this.pageDimensions,[y,v]=this.pageTranslation;let b,A;switch(this.rotation){case 0:b=t+(c[0]-y)/f,A=e+this.height-(c[1]-v)/p;break;case 90:b=t+(c[0]-y)/f,A=e-(c[1]-v)/p,[u,d]=[d,-u];break;case 180:b=t-this.width+(c[0]-y)/f,A=e-(c[1]-v)/p,[u,d]=[-u,-d];break;case 270:b=t+(c[0]-y-this.height*p)/f,A=e+(c[1]-v-this.width*f)/p,[u,d]=[-d,u];break}this.setAt(b*a,A*r,u,d)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(ql,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:s}=e;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const a=we.#h(e.getData("text")||"").replaceAll(ql,`
`);if(!a)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const c=r.getRangeAt(0);if(!a.includes(`
`)){c.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:u,startOffset:d}=c,f=[],p=[];if(u.nodeType===Node.TEXT_NODE){const b=u.parentElement;if(p.push(u.nodeValue.slice(d).replaceAll(ql,"")),b!==this.editorDiv){let A=f;for(const w of this.editorDiv.childNodes){if(w===b){A=p;continue}A.push(we.#c(w))}}f.push(u.nodeValue.slice(0,d).replaceAll(ql,""))}else if(u===this.editorDiv){let b=f,A=0;for(const w of this.editorDiv.childNodes)A++===d&&(b=p),b.push(we.#c(w))}this.#t=`${f.join(`
`)}${a}${p.join(`
`)}`,this.#l();const y=new Range;let v=Math.sumPrecise(f.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const A=b.nodeValue.length;if(v<=A){y.setStart(b,v),y.setEnd(b,v);break}v-=A}r.removeAllRanges(),r.addRange(y)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=we._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,s){let a=null;if(t instanceof wb){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:d,rotation:f,id:p,popupRef:y,richText:v,contentsObj:b,creationDate:A,modificationDate:w},textContent:E,textPosition:S,parent:{page:{pageNumber:x}}}=t;if(!E||E.length===0)return null;a=t={annotationType:bt.FREETEXT,color:Array.from(u),fontSize:c,value:E.join(`
`),position:S,pageIndex:x-1,rect:d.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:y,comment:b?.str||null,richText:v,creationDate:A,modificationDate:w}}const r=await super.deserialize(t,e,s);return r.#i=t.fontSize,r.color=et.makeHexColor(...t.color),r.#t=we.#h(t.value),r._initialData=a,t.comment&&r.setCommentData(t),r}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=rt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:e,fontSize:this.#i,value:this.#d()});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(t){const{value:e,fontSize:s,color:a,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==s||t.color.some((c,u)=>c!==a[u])||t.pageIndex!==r}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:s}=e;s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,e.replaceChildren();for(const a of this.#t.split(`
`)){const r=document.createElement("div");r.append(a?document.createTextNode(a):document.createElement("br")),e.append(r)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Z{static PRECISION=1e-4;toSVGPath(){qt("Abstract method `toSVGPath` must be implemented.")}get box(){qt("Abstract getter `box` must be implemented.")}serialize(t,e){qt("Abstract method `serialize` must be implemented.")}static _rescale(t,e,s,a,r,c){c||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)c[u]=e+t[u]*a,c[u+1]=s+t[u+1]*r;return c}static _rescaleAndSwap(t,e,s,a,r,c){c||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)c[u]=e+t[u+1]*a,c[u+1]=s+t[u]*r;return c}static _translate(t,e,s,a){a||=new Float32Array(t.length);for(let r=0,c=t.length;r<c;r+=2)a[r]=e+t[r],a[r+1]=s+t[r+1];return a}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,s,a,r){switch(r){case 90:return[1-e/s,t/a];case 180:return[1-t/s,1-e/a];case 270:return[e/s,1-t/a];default:return[t/s,e/a]}}static _normalizePagePoint(t,e,s){switch(s){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,s,a,r,c){return[(t+5*s)/6,(e+5*a)/6,(5*s+r)/6,(5*a+c)/6,(s+r)/2,(a+c)/2]}}class An{#t;#e=[];#s;#i;#r=[];#a=new Float32Array(18);#n;#o;#c;#l;#d;#h;#f=[];static#m=8;static#p=2;static#u=An.#m+An.#p;constructor({x:t,y:e},s,a,r,c,u=0){this.#t=s,this.#h=r*a,this.#i=c,this.#a.set([NaN,NaN,NaN,NaN,t,e],6),this.#s=u,this.#l=An.#m*a,this.#c=An.#u*a,this.#d=a,this.#f.push(t,e)}isEmpty(){return isNaN(this.#a[8])}#g(){const t=this.#a.subarray(4,6),e=this.#a.subarray(16,18),[s,a,r,c]=this.#t;return[(this.#n+(t[0]-e[0])/2-s)/r,(this.#o+(t[1]-e[1])/2-a)/c,(this.#n+(e[0]-t[0])/2-s)/r,(this.#o+(e[1]-t[1])/2-a)/c]}add({x:t,y:e}){this.#n=t,this.#o=e;const[s,a,r,c]=this.#t;let[u,d,f,p]=this.#a.subarray(8,12);const y=t-f,v=e-p,b=Math.hypot(y,v);if(b<this.#c)return!1;const A=b-this.#l,w=A/b,E=w*y,S=w*v;let x=u,C=d;u=f,d=p,f+=E,p+=S,this.#f?.push(t,e);const k=-S/A,L=E/A,R=k*this.#h,D=L*this.#h;return this.#a.set(this.#a.subarray(2,8),0),this.#a.set([f+R,p+D],4),this.#a.set(this.#a.subarray(14,18),12),this.#a.set([f-R,p-D],16),isNaN(this.#a[6])?(this.#r.length===0&&(this.#a.set([u+R,d+D],2),this.#r.push(NaN,NaN,NaN,NaN,(u+R-s)/r,(d+D-a)/c),this.#a.set([u-R,d-D],14),this.#e.push(NaN,NaN,NaN,NaN,(u-R-s)/r,(d-D-a)/c)),this.#a.set([x,C,u,d,f,p],6),!this.isEmpty()):(this.#a.set([x,C,u,d,f,p],6),Math.abs(Math.atan2(C-d,x-u)-Math.atan2(S,E))<Math.PI/2?([u,d,f,p]=this.#a.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+f)/2-s)/r,((d+p)/2-a)/c),[u,d,x,C]=this.#a.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((x+u)/2-s)/r,((C+d)/2-a)/c),!0):([x,C,u,d,f,p]=this.#a.subarray(0,6),this.#r.push(((x+5*u)/6-s)/r,((C+5*d)/6-a)/c,((5*u+f)/6-s)/r,((5*d+p)/6-a)/c,((u+f)/2-s)/r,((d+p)/2-a)/c),[f,p,u,d,x,C]=this.#a.subarray(12,18),this.#e.push(((x+5*u)/6-s)/r,((C+5*d)/6-a)/c,((5*u+f)/6-s)/r,((5*d+p)/6-a)/c,((u+f)/2-s)/r,((d+p)/2-a)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,e=this.#e;if(isNaN(this.#a[6])&&!this.isEmpty())return this.#y();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let a=6;a<t.length;a+=6)isNaN(t[a])?s.push(`L${t[a+4]} ${t[a+5]}`):s.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);this.#v(s);for(let a=e.length-6;a>=6;a-=6)isNaN(e[a])?s.push(`L${e[a+4]} ${e[a+5]}`):s.push(`C${e[a]} ${e[a+1]} ${e[a+2]} ${e[a+3]} ${e[a+4]} ${e[a+5]}`);return this.#b(s),s.join(" ")}#y(){const[t,e,s,a]=this.#t,[r,c,u,d]=this.#g();return`M${(this.#a[2]-t)/s} ${(this.#a[3]-e)/a} L${(this.#a[4]-t)/s} ${(this.#a[5]-e)/a} L${r} ${c} L${u} ${d} L${(this.#a[16]-t)/s} ${(this.#a[17]-e)/a} L${(this.#a[14]-t)/s} ${(this.#a[15]-e)/a} Z`}#b(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#v(t){const[e,s,a,r]=this.#t,c=this.#a.subarray(4,6),u=this.#a.subarray(16,18),[d,f,p,y]=this.#g();t.push(`L${(c[0]-e)/a} ${(c[1]-s)/r} L${d} ${f} L${p} ${y} L${(u[0]-e)/a} ${(u[1]-s)/r}`)}newFreeDrawOutline(t,e,s,a,r,c){return new Tb(t,e,s,a,r,c)}getOutlines(){const t=this.#r,e=this.#e,s=this.#a,[a,r,c,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let y=0,v=d.length-2;y<v;y+=2)d[y]=(this.#f[y]-a)/c,d[y+1]=(this.#f[y+1]-r)/u;if(d[d.length-2]=(this.#n-a)/c,d[d.length-1]=(this.#o-r)/u,isNaN(s[6])&&!this.isEmpty())return this.#T(d);const f=new Float32Array(this.#r.length+24+this.#e.length);let p=t.length;for(let y=0;y<p;y+=2){if(isNaN(t[y])){f[y]=f[y+1]=NaN;continue}f[y]=t[y],f[y+1]=t[y+1]}p=this.#w(f,p);for(let y=e.length-6;y>=6;y-=6)for(let v=0;v<6;v+=2){if(isNaN(e[y+v])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=e[y+v],f[p+1]=e[y+v+1],p+=2}return this.#S(f,p),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#s,this.#i)}#T(t){const e=this.#a,[s,a,r,c]=this.#t,[u,d,f,p]=this.#g(),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(e[2]-s)/r,(e[3]-a)/c,NaN,NaN,NaN,NaN,(e[4]-s)/r,(e[5]-a)/c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(e[16]-s)/r,(e[17]-a)/c,NaN,NaN,NaN,NaN,(e[14]-s)/r,(e[15]-a)/c],0),this.newFreeDrawOutline(y,t,this.#t,this.#d,this.#s,this.#i)}#S(t,e){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],e),e+=6}#w(t,e){const s=this.#a.subarray(4,6),a=this.#a.subarray(16,18),[r,c,u,d]=this.#t,[f,p,y,v]=this.#g();return t.set([NaN,NaN,NaN,NaN,(s[0]-r)/u,(s[1]-c)/d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,y,v,NaN,NaN,NaN,NaN,(a[0]-r)/u,(a[1]-c)/d],e),e+=24}}class Tb extends Z{#t;#e=new Float32Array(4);#s;#i;#r;#a;#n;constructor(t,e,s,a,r,c){super(),this.#n=t,this.#r=e,this.#t=s,this.#a=a,this.#s=r,this.#i=c,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(c);const[u,d,f,p]=this.#e;for(let y=0,v=t.length;y<v;y+=2)t[y]=(t[y]-u)/f,t[y+1]=(t[y+1]-d)/p;for(let y=0,v=e.length;y<v;y+=2)e[y]=(e[y]-u)/f,e[y+1]=(e[y+1]-d)/p}toSVGPath(){const t=[`M${this.#n[4]} ${this.#n[5]}`];for(let e=6,s=this.#n.length;e<s;e+=6){if(isNaN(this.#n[e])){t.push(`L${this.#n[e+4]} ${this.#n[e+5]}`);continue}t.push(`C${this.#n[e]} ${this.#n[e+1]} ${this.#n[e+2]} ${this.#n[e+3]} ${this.#n[e+4]} ${this.#n[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,s,a],r){const c=s-t,u=a-e;let d,f;switch(r){case 0:d=Z._rescale(this.#n,t,a,c,-u),f=Z._rescale(this.#r,t,a,c,-u);break;case 90:d=Z._rescaleAndSwap(this.#n,t,e,c,u),f=Z._rescaleAndSwap(this.#r,t,e,c,u);break;case 180:d=Z._rescale(this.#n,s,e,-c,u),f=Z._rescale(this.#r,s,e,-c,u);break;case 270:d=Z._rescaleAndSwap(this.#n,s,a,-c,-u),f=Z._rescaleAndSwap(this.#r,s,a,-c,-u);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const e=this.#n;let s=e[4],a=e[5];const r=[s,a,s,a];let c=s,u=a,d=s,f=a;const p=t?Math.max:Math.min,y=new Float32Array(4);for(let b=6,A=e.length;b<A;b+=6){const w=e[b+4],E=e[b+5];isNaN(e[b])?(et.pointBoundingBox(w,E,r),u>E?(c=w,u=E):u===E&&(c=p(c,w)),f<E?(d=w,f=E):f===E&&(d=p(d,w))):(y[0]=y[1]=1/0,y[2]=y[3]=-1/0,et.bezierBoundingBox(s,a,...e.slice(b,b+6),y),et.rectBoundingBox(y[0],y[1],y[2],y[3],r),u>y[1]?(c=y[0],u=y[1]):u===y[1]&&(c=p(c,y[0])),f<y[3]?(d=y[2],f=y[3]):f===y[3]&&(d=p(d,y[2]))),s=w,a=E}const v=this.#e;v[0]=r[0]-this.#s,v[1]=r[1]-this.#s,v[2]=r[2]-r[0]+2*this.#s,v[3]=r[3]-r[1]+2*this.#s,this.firstPoint=[c,u],this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(t,e,s,a,r,c=0){return new An(t,e,s,a,r,c)}getNewOutline(t,e){const[s,a,r,c]=this.#e,[u,d,f,p]=this.#t,y=r*f,v=c*p,b=s*f+u,A=a*p+d,w=this.newOutliner({x:this.#r[0]*y+b,y:this.#r[1]*v+A},this.#t,this.#a,t,this.#i,e??this.#s);for(let E=2;E<this.#r.length;E+=2)w.add({x:this.#r[E]*y+b,y:this.#r[E+1]*v+A});return w.getOutlines()}}class Td{#t;#e;#s;#i=[];#r=[];constructor(t,e=0,s=0,a=!0){const r=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:w,y:E,width:S,height:x}of t){const C=Math.floor((w-e)/c)*c,k=Math.ceil((w+S+e)/c)*c,L=Math.floor((E-e)/c)*c,R=Math.ceil((E+x+e)/c)*c,D=[C,L,R,!0],z=[k,L,R,!1];this.#i.push(D,z),et.rectBoundingBox(C,L,k,R,r)}const u=r[2]-r[0]+2*s,d=r[3]-r[1]+2*s,f=r[0]-s,p=r[1]-s;let y=a?-1/0:1/0,v=1/0;const b=this.#i.at(a?-1:-2),A=[b[0],b[2]];for(const w of this.#i){const[E,S,x,C]=w;!C&&a?S<v?(v=S,y=E):S===v&&(y=Math.max(y,E)):C&&!a&&(S<v?(v=S,y=E):S===v&&(y=Math.min(y,E))),w[0]=(E-f)/u,w[1]=(S-p)/d,w[2]=(x-p)/d}this.#t=new Float32Array([f,p,u,d]),this.#e=[y,v],this.#s=A}getOutlines(){this.#i.sort((e,s)=>e[0]-s[0]||e[1]-s[1]||e[2]-s[2]);const t=[];for(const e of this.#i)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#a(t)}#a(t){const e=[],s=new Set;for(const c of t){const[u,d,f]=c;e.push([u,d,c],[u,f,c])}e.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=e.length;c<u;c+=2){const d=e[c][2],f=e[c+1][2];d.push(f),f.push(d),s.add(d),s.add(f)}const a=[];let r;for(;s.size>0;){const c=s.values().next().value;let[u,d,f,p,y]=c;s.delete(c);let v=u,b=d;for(r=[u,f],a.push(r);;){let A;if(s.has(p))A=p;else if(s.has(y))A=y;else break;s.delete(A),[u,d,f,p,y]=A,v!==u&&(r.push(v,b,u,b===d?d:f),v=u),b=b===d?f:d}r.push(v,b)}return new f1(a,this.#t,this.#e,this.#s)}#n(t){const e=this.#r;let s=0,a=e.length-1;for(;s<=a;){const r=s+a>>1,c=e[r][0];if(c===t)return r;c<t?s=r+1:a=r-1}return a+1}#o([,t,e]){const s=this.#n(t);this.#r.splice(s,0,[t,e])}#c([,t,e]){const s=this.#n(t);for(let a=s;a<this.#r.length;a++){const[r,c]=this.#r[a];if(r!==t)break;if(r===t&&c===e){this.#r.splice(a,1);return}}for(let a=s-1;a>=0;a--){const[r,c]=this.#r[a];if(r!==t)break;if(r===t&&c===e){this.#r.splice(a,1);return}}}#l(t){const[e,s,a]=t,r=[[e,s,a]],c=this.#n(a);for(let u=0;u<c;u++){const[d,f]=this.#r[u];for(let p=0,y=r.length;p<y;p++){const[,v,b]=r[p];if(!(f<=v||b<=d)){if(v>=d){if(b>f)r[p][1]=f;else{if(y===1)return[];r.splice(p,1),p--,y--}continue}r[p][2]=d,b>f&&r.push([e,f,b])}}}return r}}class f1 extends Z{#t;#e;constructor(t,e,s,a){super(),this.#e=t,this.#t=e,this.firstPoint=s,this.lastPoint=a}toSVGPath(){const t=[];for(const e of this.#e){let[s,a]=e;t.push(`M${s} ${a}`);for(let r=2;r<e.length;r+=2){const c=e[r],u=e[r+1];c===s?(t.push(`V${u}`),a=u):u===a&&(t.push(`H${c}`),s=c)}t.push("Z")}return t.join(" ")}serialize([t,e,s,a],r){const c=[],u=s-t,d=a-e;for(const f of this.#e){const p=new Array(f.length);for(let y=0;y<f.length;y+=2)p[y]=t+f[y]*u,p[y+1]=a-f[y+1]*d;c.push(p)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Cd extends An{newFreeDrawOutline(t,e,s,a,r,c){return new g1(t,e,s,a,r,c)}}class g1 extends Tb{newOutliner(t,e,s,a,r,c=0){return new Cd(t,e,s,a,r,c)}}class le extends rt{#t=null;#e=0;#s;#i=null;#r=null;#a=null;#n=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#m=null;#p=null;#u="";#g;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=bt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=le.prototype;return yt(this,"_keyboardManager",new go([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||le._defaultColor,this.#g=t.thickness||le._defaultThickness,this.opacity=t.opacity||le._defaultOpacity,this.#s=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#v(t),this.#_()):this.#s&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#n=t.focusNode,this.#o=t.focusOffset,this.#b(),this.#_(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#g,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#b(){const t=new Td(this.#s,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new Td(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#a=e.getOutlines();const{firstPoint:s}=this.#l;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:a}=this.#a;this.#m=[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height]}#v({highlightOutlines:t,highlightId:e,clipPathId:s}){this.#l=t;const a=1.5;if(this.#a=t.getNewOutline(this.#g/2+a,.0025),e>=0)this.#d=e,this.#i=s,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},!0);else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:le.#E(this.#l.box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:le.#E(this.#a.box,y),path:{d:this.#a.toSVGPath()}})}const[r,c,u,d]=t.box;switch(this.rotation){case 0:this.x=r,this.y=c,this.width=u,this.height=d;break;case 90:{const[y,v]=this.parentDimensions;this.x=c,this.y=1-r,this.width=u*v/y,this.height=d*y/v;break}case 180:this.x=1-r,this.y=1-c,this.width=u,this.height=d;break;case 270:{const[y,v]=this.parentDimensions;this.x=1-c,this.y=r,this.width=u*v/y,this.height=d*y/v;break}}const{firstPoint:f}=t;this.#f=[(f[0]-r)/u,(f[1]-c)/d];const{lastPoint:p}=this.#a;this.#m=[(p[0]-r)/u,(p[1]-c)/d]}static initialize(t,e){rt.initialize(t,e),le._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case kt.HIGHLIGHT_COLOR:le._defaultColor=e;break;case kt.HIGHLIGHT_THICKNESS:le._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case kt.HIGHLIGHT_COLOR:this.#T(e);break;case kt.HIGHLIGHT_THICKNESS:this.#S(e);break}}static get defaultPropertiesToUpdate(){return[[kt.HIGHLIGHT_COLOR,le._defaultColor],[kt.HIGHLIGHT_THICKNESS,le._defaultThickness]]}get propertiesToUpdate(){return[[kt.HIGHLIGHT_COLOR,this.color||le._defaultColor],[kt.HIGHLIGHT_THICKNESS,this.#g||le._defaultThickness],[kt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#T(t){const e=(r,c)=>{this.color=r,this.opacity=c,this.onUpdatedColor()},s=this.color,a=this.opacity;this.addCommands({cmd:e.bind(this,t,le._defaultOpacity),undo:e.bind(this,s,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#S(t){const e=this.#g,s=a=>{this.#g=a,this.#w(a)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new Ei({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#O())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#O())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#x(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#_(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#x():t&&(this.#_(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#w(t){this.#h&&(this.#v({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#x(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#_(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#E([t,e,s,a],r){switch(r){case 90:return[1-e-a,t,a,s];case 180:return[1-t-s,1-e-a,s,a];case 270:return[e,1-t-s,a,s]}return[t,e,s,a]}rotate(t){const{drawLayer:e}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=le.#E(this.#l.box,t)):s=le.#E([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:le.#E(this.#a.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#k.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i,this.setDims(),eb(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#k(t){le._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#R(!0);break;case 1:case 3:this.#R(!1);break}}#R(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#n,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#h||this.#R(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#O(){return this.#h?this.rotation:0}#I(){if(this.#h)return null;const[t,e]=this.pageDimensions,[s,a]=this.pageTranslation,r=this.#s,c=new Float32Array(r.length*8);let u=0;for(const{x:d,y:f,width:p,height:y}of r){const v=d*t+s,b=(1-f)*e+a;c[u]=c[u+4]=v,c[u+1]=c[u+3]=b,c[u+2]=c[u+6]=v+p*t,c[u+5]=c[u+7]=b-y*e,u+=8}return c}#M(t){return this.#l.serialize(t,this.#O())}static startHighlighting(t,e,{target:s,x:a,y:r}){const{x:c,y:u,width:d,height:f}=s.getBoundingClientRect(),p=new AbortController,y=t.combinedSignal(p),v=b=>{p.abort(),this.#U(t,b)};window.addEventListener("blur",v,{signal:y}),window.addEventListener("pointerup",v,{signal:y}),window.addEventListener("pointerdown",ne,{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",Ti,{signal:y}),s.addEventListener("pointermove",this.#L.bind(this,t),{signal:y}),this._freeHighlight=new Cd({x:a,y:r},[c,u,d,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#U(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,s){let a=null;if(t instanceof Sb){const{data:{quadPoints:A,rect:w,rotation:E,id:S,color:x,opacity:C,popupRef:k,richText:L,contentsObj:R,creationDate:D,modificationDate:z},parent:{page:{pageNumber:Y}}}=t;a=t={annotationType:bt.HIGHLIGHT,color:Array.from(x),opacity:C,quadPoints:A,boxes:null,pageIndex:Y-1,rect:w.slice(0),rotation:E,annotationElementId:S,id:S,deleted:!1,popupRef:k,richText:L,comment:R?.str||null,creationDate:D,modificationDate:z}}else if(t instanceof qd){const{data:{inkLists:A,rect:w,rotation:E,id:S,color:x,borderStyle:{rawWidth:C},popupRef:k,richText:L,contentsObj:R,creationDate:D,modificationDate:z},parent:{page:{pageNumber:Y}}}=t;a=t={annotationType:bt.HIGHLIGHT,color:Array.from(x),thickness:C,inkLists:A,boxes:null,pageIndex:Y-1,rect:w.slice(0),rotation:E,annotationElementId:S,id:S,deleted:!1,popupRef:k,richText:L,comment:R?.str||null,creationDate:D,modificationDate:z}}const{color:r,quadPoints:c,inkLists:u,opacity:d}=t,f=await super.deserialize(t,e,s);f.color=et.makeHexColor(...r),f.opacity=d||1,u&&(f.#g=t.thickness),f._initialData=a,t.comment&&f.setCommentData(t);const[p,y]=f.pageDimensions,[v,b]=f.pageTranslation;if(c){const A=f.#s=[];for(let w=0;w<c.length;w+=8)A.push({x:(c[w]-v)/p,y:1-(c[w+1]-b)/y,width:(c[w+2]-c[w])/p,height:(c[w+1]-c[w+5])/y});f.#b(),f.#_(),f.rotate(f.rotation)}else if(u){f.#h=!0;const A=u[0],w={x:A[0]-v,y:y-(A[1]-b)},E=new Cd(w,[0,0,p,y],1,f.#g/2,!0,.001);for(let C=0,k=A.length;C<k;C+=2)w.x=A[C]-v,w.y=y-(A[C+1]-b),E.add(w);const{id:S,clipPathId:x}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:E.toSVGPath()}},!0,!0);f.#v({highlightOutlines:E.getOutlines(),highlightId:S,clipPathId:x}),f.#_(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=rt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:e,opacity:this.opacity,thickness:this.#g,quadPoints:this.#I(),outlines:this.#M(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#B(s)?null:(s.id=this.annotationElementId,s)}#B(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((s,a)=>s!==e[a])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Cb{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,s]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,s)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){qt("Not implemented")}}class Bt extends rt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#s=null;static#i=null;static#r=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#a(t),this.#c())}#a({drawOutlines:t,drawId:e,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#n(t,this.parent),this.#h(t.box)}#n(t,e){const{id:s}=e.drawLayer.draw(Bt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,e){const s=new Set(Object.keys(t));for(const[a,r]of Object.entries(e))s.has(a)?Object.assign(t[a],r):t[a]=r;return t}static getDefaultDrawingOptions(t){qt("Not implemented")}static get typesMap(){qt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,e),this._currentParent&&(Bt.#s.updateProperty(s,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[s,a]of this.typesMap)t.push([s,e[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[s,a]of this.constructor.typesMap)t.push([s,e[a]]);return t}_updateProperty(t,e,s){const a=this._drawingOptions,r=a[e],c=u=>{a.updateProperty(e,u);const d=this.#t.updateProperty(e,u);d&&this.#h(d),this.parent?.drawLayer.updateProperties(this._drawId,a.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,s),undo:c.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#n(this.#t,t)}}#l([t,e,s,a]){const{parentDimensions:[r,c],rotation:u}=this;switch(u){case 90:return[e,1-t,s*(c/r),a*(r/c)];case 180:return[1-t,1-e,s,a];case 270:return[1-e,t,s*(c/r),a*(r/c)];default:return[t,e,s,a]}}#d(){const{x:t,y:e,width:s,height:a,parentDimensions:[r,c],rotation:u}=this;switch(u){case 90:return[1-e,t,s*(r/c),a*(c/r)];case 180:return[1-t,1-e,s,a];case 270:return[e,1-t,s*(r/c),a*(c/r)];default:return[t,e,s,a]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:e,width:s,height:a,rotation:r,parentRotation:c,parentDimensions:[u,d]}=this;switch((r*4+c)/90){case 1:return[1-e-a,t,a,s];case 2:return[1-t-s,1-e-a,s,a];case 3:return[e,1-t-s,a,s];case 4:return[t,e-s*(u/d),a*(d/u),s*(u/d)];case 5:return[1-e,t,s*(u/d),a*(d/u)];case 6:return[1-t-a*(d/u),1-e,a*(d/u),s*(u/d)];case 7:return[e-s*(u/d),1-t-a*(d/u),s*(u/d),a*(d/u)];case 8:return[t-s,e-a,s,a];case 9:return[1-e,t-s,a,s];case 10:return[1-t,1-e,s,a];case 11:return[e-a,1-t,a,s];case 12:return[t-a*(d/u),e,a*(d/u),s*(u/d)];case 13:return[1-e-s*(u/d),t-a*(d/u),s*(u/d),a*(d/u)];case 14:return[1-t,1-e-s*(u/d),a*(d/u),s*(u/d)];case 15:return[e,1-t,s*(u/d),a*(d/u)];default:return[t,e,s,a]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const s=super.render();s.classList.add("draw");const a=document.createElement("div");return s.append(a),a.setAttribute("aria-hidden","true"),a.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),s}static createDrawerInstance(t,e,s,a,r){qt("Not implemented")}static startDrawing(t,e,s,a){const{target:r,offsetX:c,offsetY:u,pointerId:d,pointerType:f}=a;if(Pt.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:p}}=t,{width:y,height:v}=r.getBoundingClientRect(),b=Bt.#i=new AbortController,A=t.combinedSignal(b);if(Pt.setPointer(f,d),window.addEventListener("pointerup",w=>{Pt.isSamePointerIdOrRemove(w.pointerId)&&this._endDraw(w)},{signal:A}),window.addEventListener("pointercancel",w=>{Pt.isSamePointerIdOrRemove(w.pointerId)&&this._currentParent.endDrawingSession()},{signal:A}),window.addEventListener("pointerdown",w=>{Pt.isSamePointerType(w.pointerType)&&(Pt.initializeAndAddPointerId(w.pointerId),Bt.#s.isCancellable()&&(Bt.#s.removeLastElement(),Bt.#s.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",Ti,{signal:A}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),r.addEventListener("touchmove",w=>{Pt.isSameTimeStamp(w.timeStamp)&&ne(w)},{signal:A}),t.toggleDrawing(),e._editorUndoBar?.hide(),Bt.#s){t.drawLayer.updateProperties(this._currentDrawId,Bt.#s.startNew(c,u,y,v,p));return}e.updateUIForDefaultProperties(this),Bt.#s=this.createDrawerInstance(c,u,y,v,p),Bt.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Bt.#r.toSVGProperties(),Bt.#s.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Pt.isSameTimeStamp(t.timeStamp),!Bt.#s)return;const{offsetX:e,offsetY:s,pointerId:a}=t;if(Pt.isSamePointerId(a)){if(Pt.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Bt.#s.add(e,s)),Pt.setTimeStamp(t.timeStamp),ne(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Bt.#s=null,Bt.#r=null,Pt.clearPointerType(),Pt.clearTimeStamp()),Bt.#i&&(Bt.#i.abort(),Bt.#i=null,Pt.clearPointerIds())}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Bt.#s.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=Bt.#s,a=this._currentDrawId,r=s.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(a,s.setLastElement(r))},undo:()=>{e.drawLayer.updateProperties(a,s.removeLastElement())},mustExec:!1,type:kt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(kt.DRAW_STEP),!Bt.#s.isEmpty()){const{pageDimensions:[s,a],scale:r}=e,c=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Bt.#s.getOutlines(s*r,a*r,r,this._INNER_MARGIN),drawingOptions:Bt.#r,mustBeCommitted:!t});return this._cleanup(!0),c}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,s,a,r,c){qt("Not implemented")}static async deserialize(t,e,s){const{rawDims:{pageWidth:a,pageHeight:r,pageX:c,pageY:u}}=e.viewport,d=this.deserializeDraw(c,u,a,r,this._INNER_MARGIN,t),f=await super.deserialize(t,e,s);return f.createDrawingOptions(t),f.#a({drawOutlines:d}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,s]=this.pageTranslation,[a,r]=this.pageDimensions;return this.#t.serialize([e,s,a,r],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class p1{#t=new Float64Array(6);#e;#s;#i;#r;#a;#n="";#o=0;#c=new mo;#l;#d;constructor(t,e,s,a,r,c){this.#l=s,this.#d=a,this.#i=r,this.#r=c,[t,e]=this.#h(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#a=[t,e],this.#s=[{line:u,points:this.#a}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#r=e)}#h(t,e){return Z._normalizePoint(t,e,this.#l,this.#d,this.#i)}isEmpty(){return!this.#s||this.#s.length===0}isCancellable(){return this.#a.length<=10}add(t,e){[t,e]=this.#h(t,e);const[s,a,r,c]=this.#t.subarray(2,6),u=t-r,d=e-c;return Math.hypot(this.#l*u,this.#d*d)<=2?null:(this.#a.push(t,e),isNaN(s)?(this.#t.set([r,c,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,a,r,c,t,e],0),this.#e.push(...Z.createBezierPoints(s,a,r,c,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const s=this.add(t,e);return s||(this.#a.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,s,a,r){this.#l=s,this.#d=a,this.#i=r,[t,e]=this.#h(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#a=[t,e];const u=this.#s.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#s.push({line:c,points:this.#a}),this.#t.set(c,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(t){return this.#s?(this.#s.push(t),this.#e=t.line,this.#a=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#s)return this.#c.removeLastElement();this.#s.pop(),this.#n="";for(let t=0,e=this.#s.length;t<e;t++){const{line:s,points:a}=this.#s[t];this.#e=s,this.#a=a,this.#o=0,this.toSVGPath()}return{path:{d:this.#n}}}toSVGPath(){const t=Z.svgRound(this.#e[4]),e=Z.svgRound(this.#e[5]);if(this.#a.length===2)return this.#n=`${this.#n} M ${t} ${e} Z`,this.#n;if(this.#a.length<=6){const a=this.#n.lastIndexOf("M");this.#n=`${this.#n.slice(0,a)} M ${t} ${e}`,this.#o=6}if(this.#a.length===4){const a=Z.svgRound(this.#e[10]),r=Z.svgRound(this.#e[11]);return this.#n=`${this.#n} L ${a} ${r}`,this.#o=12,this.#n}const s=[];this.#o===0&&(s.push(`M ${t} ${e}`),this.#o=6);for(let a=this.#o,r=this.#e.length;a<r;a+=6){const[c,u,d,f,p,y]=this.#e.slice(a,a+6).map(Z.svgRound);s.push(`C${c} ${u} ${d} ${f} ${p} ${y}`)}return this.#n+=s.join(" "),this.#o=this.#e.length,this.#n}getOutlines(t,e,s,a){const r=this.#s.at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),this.#c.build(this.#s,t,e,s,this.#i,this.#r,a),this.#t=null,this.#e=null,this.#s=null,this.#n=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class mo extends Z{#t;#e=0;#s;#i;#r;#a;#n;#o;#c;build(t,e,s,a,r,c,u){this.#r=e,this.#a=s,this.#n=a,this.#o=r,this.#c=c,this.#s=u??0,this.#i=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${Z.svgRound(e[4])} ${Z.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${Z.svgRound(e[10])} ${Z.svgRound(e[11])}`);continue}for(let s=6,a=e.length;s<a;s+=6){const[r,c,u,d,f,p]=e.subarray(s,s+6).map(Z.svgRound);t.push(`C${r} ${c} ${u} ${d} ${f} ${p}`)}}return t.join("")}serialize([t,e,s,a],r){const c=[],u=[],[d,f,p,y]=this.#d();let v,b,A,w,E,S,x,C,k;switch(this.#o){case 0:k=Z._rescale,v=t,b=e+a,A=s,w=-a,E=t+d*s,S=e+(1-f-y)*a,x=t+(d+p)*s,C=e+(1-f)*a;break;case 90:k=Z._rescaleAndSwap,v=t,b=e,A=s,w=a,E=t+f*s,S=e+d*a,x=t+(f+y)*s,C=e+(d+p)*a;break;case 180:k=Z._rescale,v=t+s,b=e,A=-s,w=a,E=t+(1-d-p)*s,S=e+f*a,x=t+(1-d)*s,C=e+(f+y)*a;break;case 270:k=Z._rescaleAndSwap,v=t+s,b=e+a,A=-s,w=-a,E=t+(1-f-y)*s,S=e+(1-d-p)*a,x=t+(1-f)*s,C=e+(1-d)*a;break}for(const{line:L,points:R}of this.#i)c.push(k(L,v,b,A,w,r?new Array(L.length):null)),u.push(k(R,v,b,A,w,r?new Array(R.length):null));return{lines:c,points:u,rect:[E,S,x,C]}}static deserialize(t,e,s,a,r,{paths:{lines:c,points:u},rotation:d,thickness:f}){const p=[];let y,v,b,A,w;switch(d){case 0:w=Z._rescale,y=-t/s,v=e/a+1,b=1/s,A=-1/a;break;case 90:w=Z._rescaleAndSwap,y=-e/a,v=-t/s,b=1/a,A=1/s;break;case 180:w=Z._rescale,y=t/s+1,v=-e/a,b=-1/s,A=1/a;break;case 270:w=Z._rescaleAndSwap,y=e/a+1,v=t/s+1,b=-1/a,A=-1/s;break}if(!c){c=[];for(const S of u){const x=S.length;if(x===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1]]));continue}if(x===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1],NaN,NaN,NaN,NaN,S[2],S[3]]));continue}const C=new Float32Array(3*(x-2));c.push(C);let[k,L,R,D]=S.subarray(0,4);C.set([NaN,NaN,NaN,NaN,k,L],0);for(let z=4;z<x;z+=2){const Y=S[z],Q=S[z+1];C.set(Z.createBezierPoints(k,L,R,D,Y,Q),(z-2)*3),[k,L,R,D]=[R,D,Y,Q]}}}for(let S=0,x=c.length;S<x;S++)p.push({line:w(c[S].map(C=>C??NaN),y,v,b,A),points:w(u[S].map(C=>C??NaN),y,v,b,A)});const E=new this.prototype.constructor;return E.build(p,s,a,1,d,f,r),E}#l(t=this.#c){const e=this.#s+t/2*this.#n;return this.#o%180===0?[e/this.#r,e/this.#a]:[e/this.#a,e/this.#r]}#d(){const[t,e,s,a]=this.#t,[r,c]=this.#l(0);return[t+r,e+c,s-2*r,a-2*c]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:a}of this.#i){if(a.length<=12){for(let u=4,d=a.length;u<d;u+=6)et.pointBoundingBox(a[u],a[u+1],t);continue}let r=a[4],c=a[5];for(let u=6,d=a.length;u<d;u+=6){const[f,p,y,v,b,A]=a.subarray(u,u+6);et.bezierBoundingBox(r,c,f,p,y,v,b,A,t),r=b,c=A}}const[e,s]=this.#l();t[0]=Ue(t[0]-e,0,1),t[1]=Ue(t[1]-s,0,1),t[2]=Ue(t[2]+e,0,1),t[3]=Ue(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,s]=this.#l();this.#c=t;const[a,r]=this.#l(),[c,u]=[a-e,r-s],d=this.#t;return d[0]-=c,d[1]-=u,d[2]+=2*c,d[3]+=2*u,d}updateParentDimensions([t,e],s){const[a,r]=this.#l();this.#r=t,this.#a=e,this.#n=s;const[c,u]=this.#l(),d=c-a,f=u-r,p=this.#t;return p[0]-=d,p[1]-=f,p[2]+=2*d,p[3]+=2*f,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(Z.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let s=0,a=0,r=0,c=0,u=0,d=0;switch(this.#e){case 90:a=e/t,r=-t/e,u=t;break;case 180:s=-1,c=-1,u=t,d=e;break;case 270:a=-e/t,r=t/e,d=e;break;default:return""}return`matrix(${s} ${a} ${r} ${c} ${Z.svgRound(u)} ${Z.svgRound(d)})`}getPathResizingSVGProperties([t,e,s,a]){const[r,c]=this.#l(),[u,d,f,p]=this.#t;if(Math.abs(f-r)<=Z.PRECISION||Math.abs(p-c)<=Z.PRECISION){const w=t+s/2-(u+f/2),E=e+a/2-(d+p/2);return{path:{"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(e)}`,transform:`${this.rotationTransform} translate(${w} ${E})`}}}const y=(s-2*r)/(f-2*r),v=(a-2*c)/(p-2*c),b=f/s,A=p/a;return{path:{"transform-origin":`${Z.svgRound(u)} ${Z.svgRound(d)}`,transform:`${this.rotationTransform} scale(${b} ${A}) translate(${Z.svgRound(r)} ${Z.svgRound(c)}) scale(${y} ${v}) translate(${Z.svgRound(-r)} ${Z.svgRound(-c)})`}}}getPathResizedSVGProperties([t,e,s,a]){const[r,c]=this.#l(),u=this.#t,[d,f,p,y]=u;if(u[0]=t,u[1]=e,u[2]=s,u[3]=a,Math.abs(p-r)<=Z.PRECISION||Math.abs(y-c)<=Z.PRECISION){const E=t+s/2-(d+p/2),S=e+a/2-(f+y/2);for(const{line:x,points:C}of this.#i)Z._translate(x,E,S,x),Z._translate(C,E,S,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(s-2*r)/(p-2*r),b=(a-2*c)/(y-2*c),A=-v*(d+r)+t+r,w=-b*(f+c)+e+c;if(v!==1||b!==1||A!==0||w!==0)for(const{line:E,points:S}of this.#i)Z._rescale(E,A,w,v,b,E),Z._rescale(S,A,w,v,b,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],s){const[a,r]=s,c=this.#t,u=t-c[0],d=e-c[1];if(this.#r===a&&this.#a===r)for(const{line:f,points:p}of this.#i)Z._translate(f,u,d,f),Z._translate(p,u,d,p);else{const f=this.#r/a,p=this.#a/r;this.#r=a,this.#a=r;for(const{line:y,points:v}of this.#i)Z._rescale(y,u,d,f,p,y),Z._rescale(v,u,d,f,p,v);c[2]*=f,c[3]*=p}return c[0]=t,c[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Z.svgRound(t[0])} ${Z.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class fc extends Cb{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:rt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new fc(this._viewParameters);return t.updateAll(this),t}}class Yd extends Bt{static _type="ink";static _editorType=bt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){rt.initialize(t,e),this._defaultDrawingOptions=new fc(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return yt(this,"typesMap",new Map([[kt.INK_THICKNESS,"stroke-width"],[kt.INK_COLOR,"stroke"],[kt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,s,a,r){return new p1(t,e,s,a,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,s,a,r,c){return mo.deserialize(t,e,s,a,r,c)}static async deserialize(t,e,s){let a=null;if(t instanceof qd){const{data:{inkLists:c,rect:u,rotation:d,id:f,color:p,opacity:y,borderStyle:{rawWidth:v},popupRef:b,richText:A,contentsObj:w,creationDate:E,modificationDate:S},parent:{page:{pageNumber:x}}}=t;a=t={annotationType:bt.INK,color:Array.from(p),thickness:v,opacity:y,paths:{points:c},boxes:null,pageIndex:x-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:b,richText:A,comment:w?.str||null,creationDate:E,modificationDate:S}}const r=await super.deserialize(t,e,s);return r._initialData=a,t.comment&&r.setCommentData(t),r}get toolbarButtons(){return this._colorPicker||=new ro(this),[["colorPicker",this._colorPicker]]}get colorType(){return kt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:s}=this;e.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:s}){this._drawingOptions=Yd.getDefaultDrawingOptions({stroke:et.makeHexColor(...t),"stroke-width":e,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":r,"stroke-width":c}}=this,u=Object.assign(super.serialize(t),{color:rt._colorManager.convert(a),opacity:r,thickness:c,paths:{lines:e,points:s}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:s,opacity:a,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,u)=>c!==e[u])||t.thickness!==s||t.opacity!==a||t.pageIndex!==r}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class xd extends mo{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Vl=8,jr=3;class Ra{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,s,a){return s-=t,a-=e,s===0?a>0?0:4:s===1?a+6:2-a}static#s=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,e,s,a,r,c,u){const d=this.#e(s,a,r,c);for(let f=0;f<8;f++){const p=(-f+d-u+16)%8,y=this.#s[2*p],v=this.#s[2*p+1];if(t[(s+y)*e+(a+v)]!==0)return p}return-1}static#r(t,e,s,a,r,c,u){const d=this.#e(s,a,r,c);for(let f=0;f<8;f++){const p=(f+d+u+16)%8,y=this.#s[2*p],v=this.#s[2*p+1];if(t[(s+y)*e+(a+v)]!==0)return p}return-1}static#a(t,e,s,a){const r=t.length,c=new Int32Array(r);for(let p=0;p<r;p++)c[p]=t[p]<=a?1:0;for(let p=1;p<s-1;p++)c[p*e]=c[p*e+e-1]=0;for(let p=0;p<e;p++)c[p]=c[e*s-1-p]=0;let u=1,d;const f=[];for(let p=1;p<s-1;p++){d=1;for(let y=1;y<e-1;y++){const v=p*e+y,b=c[v];if(b===0)continue;let A=p,w=y;if(b===1&&c[v-1]===0)u+=1,w-=1;else if(b>=1&&c[v+1]===0)u+=1,w+=1,b>1&&(d=b);else{b!==1&&(d=Math.abs(b));continue}const E=[y,p],S=w===y+1,x={isHole:S,points:E,id:u,parent:0};f.push(x);let C;for(const K of f)if(K.id===d){C=K;break}C?C.isHole?x.parent=S?C.parent:d:x.parent=S?d:C.parent:x.parent=S?d:0;const k=this.#i(c,e,p,y,A,w,0);if(k===-1){c[v]=-u,c[v]!==1&&(d=Math.abs(c[v]));continue}let L=this.#s[2*k],R=this.#s[2*k+1];const D=p+L,z=y+R;A=D,w=z;let Y=p,Q=y;for(;;){const K=this.#r(c,e,Y,Q,A,w,1);L=this.#s[2*K],R=this.#s[2*K+1];const dt=Y+L,St=Q+R;E.push(St,dt);const vt=Y*e+Q;if(c[vt+1]===0?c[vt]=-u:c[vt]===1&&(c[vt]=u),dt===p&&St===y&&Y===D&&Q===z){c[v]!==1&&(d=Math.abs(c[v]));break}else A=Y,w=Q,Y=dt,Q=St}}}return f}static#n(t,e,s,a){if(s-e<=4){for(let D=e;D<s-2;D+=2)a.push(t[D],t[D+1]);return}const r=t[e],c=t[e+1],u=t[s-4]-r,d=t[s-3]-c,f=Math.hypot(u,d),p=u/f,y=d/f,v=p*c-y*r,b=d/u,A=1/f,w=Math.atan(b),E=Math.cos(w),S=Math.sin(w),x=A*(Math.abs(E)+Math.abs(S)),C=A*(1-x+x**2),k=Math.max(Math.atan(Math.abs(S+E)*C),Math.atan(Math.abs(S-E)*C));let L=0,R=e;for(let D=e+2;D<s-2;D+=2){const z=Math.abs(v-p*t[D+1]+y*t[D]);z>L&&(R=D,L=z)}L>(f*k)**2?(this.#n(t,e,R+2,a),this.#n(t,R,s,a)):a.push(r,c)}static#o(t){const e=[],s=t.length;return this.#n(t,0,s,e),e.push(t[s-2],t[s-1]),e.length<=4?null:e}static#c(t,e,s,a,r,c){const u=new Float32Array(c**2),d=-2*a**2,f=c>>1;for(let w=0;w<c;w++){const E=(w-f)**2;for(let S=0;S<c;S++)u[w*c+S]=Math.exp((E+(S-f)**2)/d)}const p=new Float32Array(256),y=-2*r**2;for(let w=0;w<256;w++)p[w]=Math.exp(w**2/y);const v=t.length,b=new Uint8Array(v),A=new Uint32Array(256);for(let w=0;w<s;w++)for(let E=0;E<e;E++){const S=w*e+E,x=t[S];let C=0,k=0;for(let R=0;R<c;R++){const D=w+R-f;if(!(D<0||D>=s))for(let z=0;z<c;z++){const Y=E+z-f;if(Y<0||Y>=e)continue;const Q=t[D*e+Y],K=u[R*c+z]*p[Math.abs(Q-x)];C+=Q*K,k+=K}}const L=b[S]=Math.round(C/k);A[L]++}return[b,A]}static#l(t){const e=new Uint32Array(256);for(const s of t)e[s]++;return e}static#d(t){const e=t.length,s=new Uint8ClampedArray(e>>2);let a=-1/0,r=1/0;for(let u=0,d=s.length;u<d;u++){const f=s[u]=t[u<<2];a=Math.max(a,f),r=Math.min(r,f)}const c=255/(a-r);for(let u=0,d=s.length;u<d;u++)s[u]=(s[u]-r)*c;return s}static#h(t){let e,s=-1/0,a=-1/0;const r=t.findIndex(d=>d!==0);let c=r,u=r;for(e=r;e<256;e++){const d=t[e];d>s&&(e-c>a&&(a=e-c,u=e-1),s=d,c=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:s,height:a}=t,{maxDim:r}=this.#t;let c=s,u=a;if(s>r||a>r){let v=s,b=a,A=Math.log2(Math.max(s,a)/r);const w=Math.floor(A);A=A===w?w-1:w;for(let S=0;S<A;S++){c=Math.ceil(v/2),u=Math.ceil(b/2);const x=new OffscreenCanvas(c,u);x.getContext("2d").drawImage(t,0,0,v,b,0,0,c,u),v=c,b=u,t!==e&&t.close(),t=x.transferToImageBitmap()}const E=Math.min(r/c,r/u);c=Math.round(c*E),u=Math.round(u*E)}const f=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,u);const p=f.getImageData(0,0,c,u).data;return[this.#d(p),c,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:s,fontWeight:a},r,c,u,d){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const y=200,v=p.font=`${s} ${a} ${y}px ${e}`,{actualBoundingBoxLeft:b,actualBoundingBoxRight:A,actualBoundingBoxAscent:w,actualBoundingBoxDescent:E,fontBoundingBoxAscent:S,fontBoundingBoxDescent:x,width:C}=p.measureText(t),k=1.5,L=Math.ceil(Math.max(Math.abs(b)+Math.abs(A)||0,C)*k),R=Math.ceil(Math.max(Math.abs(w)+Math.abs(E)||y,Math.abs(S)+Math.abs(x)||y)*k);f=new OffscreenCanvas(L,R),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=v,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,L,R),p.fillStyle="black",p.fillText(t,L*(k-1)/2,R*(3-k)/2);const D=this.#d(p.getImageData(0,0,L,R).data),z=this.#l(D),Y=this.#h(z),Q=this.#a(D,L,R,Y);return this.processDrawnLines({lines:{curves:Q,width:L,height:R},pageWidth:r,pageHeight:c,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,e,s,a,r){const[c,u,d]=this.#f(t),[f,p]=this.#c(c,u,d,Math.hypot(u,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),y=this.#h(p),v=this.#a(f,u,d,y);return this.processDrawnLines({lines:{curves:v,width:u,height:d},pageWidth:e,pageHeight:s,rotation:a,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:s,rotation:a,innerMargin:r,mustSmooth:c,areContours:u}){a%180!==0&&([e,s]=[s,e]);const{curves:d,width:f,height:p}=t,y=t.thickness??0,v=[],b=Math.min(e/f,s/p),A=b/e,w=b/s,E=[];for(const{points:x}of d){const C=c?this.#o(x):x;if(!C)continue;E.push(C);const k=C.length,L=new Float32Array(k),R=new Float32Array(3*(k===2?2:k-2));if(v.push({line:R,points:L}),k===2){L[0]=C[0]*A,L[1]=C[1]*w,R.set([NaN,NaN,NaN,NaN,L[0],L[1]],0);continue}let[D,z,Y,Q]=C;D*=A,z*=w,Y*=A,Q*=w,L.set([D,z,Y,Q],0),R.set([NaN,NaN,NaN,NaN,D,z],0);for(let K=4;K<k;K+=2){const dt=L[K]=C[K]*A,St=L[K+1]=C[K+1]*w;R.set(Z.createBezierPoints(D,z,Y,Q,dt,St),(K-2)*3),[D,z,Y,Q]=[Y,Q,dt,St]}}if(v.length===0)return null;const S=u?new xd:new mo;return S.build(v,e,s,1,a,u?0:y,r),{outline:S,newCurves:E,areContours:u,thickness:y,width:f,height:p}}static async compressSignature({outlines:t,areContours:e,thickness:s,width:a,height:r}){let c=1/0,u=-1/0,d=0;for(const C of t){d+=C.length;for(let k=2,L=C.length;k<L;k++){const R=C[k]-C[k-2];c=Math.min(c,R),u=Math.max(u,R)}}let f;c>=-128&&u<=127?f=Int8Array:c>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const p=t.length,y=Vl+jr*p,v=new Uint32Array(y);let b=0;v[b++]=y*Uint32Array.BYTES_PER_ELEMENT+(d-2*p)*f.BYTES_PER_ELEMENT,v[b++]=0,v[b++]=a,v[b++]=r,v[b++]=e?0:1,v[b++]=Math.max(0,Math.floor(s??0)),v[b++]=p,v[b++]=f.BYTES_PER_ELEMENT;for(const C of t)v[b++]=C.length-2,v[b++]=C[0],v[b++]=C[1];const A=new CompressionStream("deflate-raw"),w=A.writable.getWriter();await w.ready,w.write(v);const E=f.prototype.constructor;for(const C of t){const k=new E(C.length-2);for(let L=2,R=C.length;L<R;L++)k[L-2]=C[L]-C[L-2];w.write(k)}w.close();const S=await new Response(A.readable).arrayBuffer(),x=new Uint8Array(S);return Qv(x)}static async decompressSignature(t){try{const e=DE(t),{readable:s,writable:a}=new DecompressionStream("deflate-raw"),r=a.getWriter();await r.ready,r.write(e).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let c=null,u=0;for await(const C of s)c||=new Uint8Array(new Uint32Array(C.buffer,0,4)[0]),c.set(C,u),u+=C.length;const d=new Uint32Array(c.buffer,0,c.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=d[2],y=d[3],v=d[4]===0,b=d[5],A=d[6],w=d[7],E=[],S=(Vl+jr*A)*Uint32Array.BYTES_PER_ELEMENT;let x;switch(w){case Int8Array.BYTES_PER_ELEMENT:x=new Int8Array(c.buffer,S);break;case Int16Array.BYTES_PER_ELEMENT:x=new Int16Array(c.buffer,S);break;case Int32Array.BYTES_PER_ELEMENT:x=new Int32Array(c.buffer,S);break}u=0;for(let C=0;C<A;C++){const k=d[jr*C+Vl],L=new Float32Array(k+2);E.push(L);for(let R=0;R<jr-1;R++)L[R]=d[jr*C+Vl+R+1];for(let R=0;R<k;R++)L[R+2]=L[R]+x[u++]}return{areContours:v,thickness:b,outlines:E,width:p,height:y}}catch(e){return mt(`decompressSignature: ${e}`),null}}}class Xd extends Cb{constructor(){super(),super.updateProperties({fill:rt._defaultLineColor,"stroke-width":0})}clone(){const t=new Xd;return t.updateAll(this),t}}class Kd extends fc{constructor(t){super(t),super.updateProperties({stroke:rt._defaultLineColor,"stroke-width":1})}clone(){const t=new Kd(this._viewParameters);return t.updateAll(this),t}}class Fi extends Bt{#t=!1;#e=null;#s=null;#i=null;static _type="signature";static _editorType=bt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#s=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){rt.initialize(t,e),this._defaultDrawingOptions=new Xd,this._defaultDrawnSignatureOptions=new Kd(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return yt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#s){const{lines:a,mustSmooth:r,areContours:c,description:u,uuid:d,heightInPage:f}=this.#s,{rawDims:{pageWidth:p,pageHeight:y},rotation:v}=this.parent.viewport,b=Ra.processDrawnLines({lines:a,pageWidth:p,pageHeight:y,rotation:v,innerMargin:Fi._INNER_MARGIN,mustSmooth:r,areContours:c});this.addSignature(b,f,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:s,width:a,height:r}=this.#s,c=Math.max(a,r),u=Ra.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:s,width:a,height:r},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,s,a){const{x:r,y:c}=this,{outline:u}=this.#s=t;this.#t=u instanceof xd,this.description=s;let d;this.#t?d=Fi.getDefaultDrawingOptions():(d=Fi._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,f]=this.pageDimensions;let p=e/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=r,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(a),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!a,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:s},rotation:a}=this.parent.viewport;return Ra.process(t,e,s,a,Fi._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:s,pageHeight:a},rotation:r}=this.parent.viewport;return Ra.extractContoursFromText(t,e,s,a,r,Fi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:s},rotation:a}=this.parent.viewport;return Ra.processDrawnLines({lines:t,pageWidth:e,pageHeight:s,rotation:a,innerMargin:Fi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Fi.getDefaultDrawingOptions():(this._drawingOptions=Fi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,r=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a});return this.addComment(r),t?(r.paths={lines:e,points:s},r.uuid=this.#i,r.isCopy=!0):r.lines=e,this.#e&&(r.accessibilityData={type:"Figure",alt:this.#e}),r}static deserializeDraw(t,e,s,a,r,c){return c.areContours?xd.deserialize(t,e,s,a,r,c):mo.deserialize(t,e,s,a,r,c)}static async deserialize(t,e,s){const a=await super.deserialize(t,e,s);return a.#t=t.areContours,a.description=t.accessibilityData?.alt||"",a.#i=t.uuid,a}}class m1 extends rt{#t=null;#e=null;#s=null;#i=null;#r=null;#a="";#n=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=bt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){rt.initialize(t,e)}static isHandlingMimeForPasting(t){return vd.includes(t)}static paste(t,e){e.pasteEditor({mode:bt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#a=t.file.name),this.#p()}#f(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#n){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:r,height:c}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:a,width:r,height:c,channels:a.length/(r*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),e&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#h(s,!0)).finally(()=>this.#f());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(s).then(a=>this.#h(a)).finally(()=>this.#f());return}if(this.#r){const s=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(s).then(a=>this.#h(a)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=vd.join(",");const e=this._uiManager._signal;this.#s=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(a)}s()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#n?.remove(),this.#n=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#n===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#s||this.#t||this.#i||this.#r||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#p():this.#m()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:s,bitmap:a}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#e=s,a&&(this.#t=a),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#g()},t)}#p(){const{div:t}=this;let{width:e,height:s}=this.#t;const[a,r]=this.pageDimensions,c=.75;if(this.width)e=this.width*a,s=this.height*r;else if(e>c*a||s>c*r){const d=Math.min(c*a/e,c*r/s);e*=d,s*=d}this._uiManager.enableWaiting(!1);const u=this.#n=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=e/a,this.height=s/r,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#g(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#a&&this.div.setAttribute("aria-description",this.#a),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,s=!1){t||(t=224);const{width:a,height:r}=this.#t,c=new $i;let u=this.#t,d=a,f=r,p=null;if(e){if(a>e||r>e){const R=Math.min(e/a,e/r);d=Math.floor(a*R),f=Math.floor(r*R)}p=document.createElement("canvas");const v=p.width=Math.ceil(d*c.sx),b=p.height=Math.ceil(f*c.sy);this.#l||(u=this.#u(v,b));const A=p.getContext("2d");A.filter=this._uiManager.hcmFilter;let w="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":IE.isDarkMode&&(w="#8f8f9d",E="#42414d");const S=15,x=S*c.sx,C=S*c.sy,k=new OffscreenCanvas(x*2,C*2),L=k.getContext("2d");L.fillStyle=w,L.fillRect(0,0,x*2,C*2),L.fillStyle=E,L.fillRect(0,0,x,C),L.fillRect(x,C,x,C),A.fillStyle=A.createPattern(k,"repeat"),A.fillRect(0,0,v,b),A.drawImage(u,0,0,u.width,u.height,0,0,v,b)}let y=null;if(s){let v,b;if(c.symmetric&&u.width<t&&u.height<t)v=u.width,b=u.height;else if(u=this.#t,a>t||r>t){const E=Math.min(t/a,t/r);v=Math.floor(a*E),b=Math.floor(r*E),this.#l||(u=this.#u(v,b))}const w=new OffscreenCanvas(v,b).getContext("2d",{willReadFrequently:!0});w.drawImage(u,0,0,u.width,u.height,0,0,v,b),y={width:v,height:b,data:w.getImageData(0,0,v,b).data}}return{canvas:p,width:d,height:f,imageData:y}}#u(t,e){const{width:s,height:a}=this.#t;let r=s,c=a,u=this.#t;for(;r>2*t||c>2*e;){const d=r,f=c;r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),c>2*e&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const p=new OffscreenCanvas(r,c);p.getContext("2d").drawImage(u,0,0,d,f,0,0,r,c),u=p.transferToImageBitmap()}return u}#g(){const[t,e]=this.parentDimensions,{width:s,height:a}=this,r=new $i,c=Math.ceil(s*t*r.sx),u=Math.ceil(a*e*r.sy),d=this.#n;if(!d||d.width===c&&d.height===u)return;d.width=c,d.height=u;const f=this.#l?this.#t:this.#u(c,u),p=d.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,c,u)}#y(t){if(t){if(this.#l){const a=this._uiManager.imageManager.getSvgUrl(this.#e);if(a)return a}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,s]=this.pageDimensions,a=Math.round(this.width*e*ja.PDF_TO_CSS_UNITS),r=Math.round(this.height*s*ja.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(a,r);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,a,r),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,s){let a=null,r=!1;if(t instanceof Eb){const{data:{rect:w,rotation:E,id:S,structParent:x,popupRef:C,richText:k,contentsObj:L,creationDate:R,modificationDate:D},container:z,parent:{page:{pageNumber:Y}},canvas:Q}=t;let K,dt;Q?(delete t.canvas,{id:K,bitmap:dt}=s.imageManager.getFromCanvas(z.id,Q),Q.remove()):(r=!0,t._hasNoCanvas=!0);const St=(await e._structTree.getAriaAttributes(`${ka}${S}`))?.get("aria-label")||"";a=t={annotationType:bt.STAMP,bitmapId:K,bitmap:dt,pageIndex:Y-1,rect:w.slice(0),rotation:E,annotationElementId:S,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:St},isSvg:!1,structParent:x,popupRef:C,richText:k,comment:L?.str||null,creationDate:R,modificationDate:D}}const c=await super.deserialize(t,e,s),{rect:u,bitmap:d,bitmapUrl:f,bitmapId:p,isSvg:y,accessibilityData:v}=t;r?(s.addMissingCanvas(t.id,c),c.#o=!0):p&&s.imageManager.isValidId(p)?(c.#e=p,d&&(c.#t=d)):c.#i=f,c.#l=y;const[b,A]=c.pageDimensions;return c.width=(u[2]-u[0])/b,c.height=(u[3]-u[1])/A,v&&(c.altTextData=v),c._initialData=a,t.comment&&c.setCommentData(t),c.#d=!!a,c}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(s),t)return s.bitmapUrl=this.#y(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:a,altText:r}=this.serializeAltText(!1);if(!a&&r&&(s.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const u=this.#b(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(e===null)return s;e.stamps||=new Map;const c=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:c,serialized:s}),s.bitmap=this.#y(!1);else if(this.#l){const u=e.stamps.get(this.#e);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return s}#b(t){const{pageIndex:e,accessibilityData:{altText:s}}=this._initialData,a=t.pageIndex===e,r=(t.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&a&&r,isSameAltText:r}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class hs{#t;#e=!1;#s=null;#i=null;#r=null;#a=new Map;#n=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#m=null;#p=-1;#u;static _initialized=!1;static#g=new Map([we,Yd,m1,le,Fi].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:s,structTreeLayer:a,accessibilityManager:r,annotationLayer:c,drawLayer:u,textLayer:d,viewport:f,l10n:p}){const y=[...hs.#g.values()];if(!hs._initialized){hs._initialized=!0;for(const v of y)v.initialize(p,t)}t.registerEditorTypes(y),this.#u=t,this.pageIndex=e,this.div=s,this.#t=r,this.#s=c,this.viewport=f,this.#h=d,this.drawLayer=u,this._structTree=a,this.#u.addLayer(this)}get isEmpty(){return this.#a.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===bt.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#w(),t){case bt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case bt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case bt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===bt.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const s of hs.#g.values())e.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#s?.togglePointerEvents(t)}get#y(){return this.#a.size!==0?this.#a.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const s of this.#y)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const e=this.#s;if(e)for(const s of e.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const a=await this.deserialize(s);a&&(this.addOrRebuild(a),a.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const a=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",r=>{const{clientX:u,clientY:d,timeStamp:f}=r,p=this.#p;if(f-p>500){this.#p=f;return}this.#p=-1;const{classList:y}=this.div;y.toggle("getElements",!0);const v=document.elementsFromPoint(u,d);if(y.toggle("getElements",!1),!this.div.contains(v[0]))return;let b;const A=new RegExp(`^${io}[0-9]+$`);for(const E of v)if(A.test(E.id)){b=E.id;break}if(!b)return;const w=this.#a.get(b);w?.annotationElementId===null&&(r.stopPropagation(),r.preventDefault(),w.dblclick(r))},{signal:a,capture:!0})}const t=this.#s,e=[];if(t){const a=new Map,r=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){e.push(u);continue}if(u.serialize()!==null){a.set(u.annotationElementId,u);continue}else r.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const c=t.getEditableAnnotations();for(const u of c){const{id:d}=u.data;if(this.#u.isDeletedAnnotationElement(d)){u.updateEdited({deleted:!0});continue}let f=r.get(d);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=a.get(d),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const a of hs.#g.values())s.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(e),this.#o=!1}getEditableAnnotation(t){return this.#s?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#b.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#b(t){this.#u.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:s}=Me.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),le.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#u.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#a.set(t.id,t);const{annotationElementId:e}=t;e&&this.#u.isDeletedAnnotationElement(e)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#a.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),rt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:e,undo:s,mustExec:!1})}getEditorByUID(t){for(const e of this.#a.values())if(e.uid===t)return e;return null}getNextId(){return this.#u.getId()}get#v(){return hs.#g.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#T(t){const e=this.#v;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:s,offsetY:a}=this.#S(),r=this.getNextId(),c=this.#T({parent:this,id:r,x:s,y:a,uiManager:this.#u,isCentered:!0,...e});c&&this.add(c)}async deserialize(t){return await hs.#g.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,e,s={}){const a=this.getNextId(),r=this.#T({parent:this,id:a,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:e,...s});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}#S(){const{x:t,y:e,width:s,height:a}=this.boundingClientRect,r=Math.max(0,t),c=Math.max(0,e),u=Math.min(window.innerWidth,t+s),d=Math.min(window.innerHeight,e+a),f=(r+u)/2-t,p=(c+d)/2-e,[y,v]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:y,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#S(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:e}=Me.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#n||(this.#n=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const s=this.#u.getMode();if(s===bt.STAMP||s===bt.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===bt.HIGHLIGHT&&this.enableTextSelection(),this.#n){this.#n=!1;return}const{isMac:e}=Me.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#n=!0,this.#v?.isDrawer){this.startDrawingSession(t);return}const s=this.#u.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#v.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#v.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#v.endDrawing(t)):null}findNewParent(t,e,s){const a=this.#u.findParent(e,s);return a===null||a===this?!1:(a.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#a.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#a.clear(),this.#u.removeLayer(this)}#w(){for(const t of this.#a.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,xn(this.div,t);for(const e of this.#u.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#w();const e=this.viewport.rotation,s=t.rotation;if(this.viewport=t,xn(this.div,{rotation:s}),e!==s)for(const a of this.#a.values())a.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#u.viewParameters.realScale}}class ke{#t=null;#e=new Map;#s=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return yt(this,"_svgFactory",new ic)}static#r(t,[e,s,a,r]){const{style:c}=t;c.top=`${100*s}%`,c.left=`${100*e}%`,c.width=`${100*a}%`,c.height=`${100*r}%`}#a(){const t=ke._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#n(t,e){const s=ke._svgFactory.createElement("clipPath");t.append(s);const a=`clip_${e}`;s.setAttribute("id",a),s.setAttribute("clipPathUnits","objectBoundingBox");const r=ke._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),a}#o(t,e){for(const[s,a]of Object.entries(e))a===null?t.removeAttribute(s):t.setAttribute(s,a)}draw(t,e=!1,s=!1){const a=ke.#i++,r=this.#a(),c=ke._svgFactory.createElement("defs");r.append(c);const u=ke._svgFactory.createElement("path");c.append(u);const d=`path_p${this.pageIndex}_${a}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#s.set(a,u);const f=s?this.#n(c,d):null,p=ke._svgFactory.createElement("use");return r.append(p),p.setAttribute("href",`#${d}`),this.updateProperties(r,t),this.#e.set(a,r),{id:a,clipPathId:`url(#${f})`}}drawOutline(t,e){const s=ke.#i++,a=this.#a(),r=ke._svgFactory.createElement("defs");a.append(r);const c=ke._svgFactory.createElement("path");r.append(c);const u=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let d;if(e){const y=ke._svgFactory.createElement("mask");r.append(y),d=`mask_p${this.pageIndex}_${s}`,y.setAttribute("id",d),y.setAttribute("maskUnits","objectBoundingBox");const v=ke._svgFactory.createElement("rect");y.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const b=ke._svgFactory.createElement("use");y.append(b),b.setAttribute("href",`#${u}`),b.setAttribute("stroke","none"),b.setAttribute("fill","black"),b.setAttribute("fill-rule","nonzero"),b.classList.add("mask")}const f=ke._svgFactory.createElement("use");a.append(f),f.setAttribute("href",`#${u}`),d&&f.setAttribute("mask",`url(#${d})`);const p=f.cloneNode();return a.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(a,t),this.#e.set(s,a),s}finalizeDraw(t,e){this.#s.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:s,bbox:a,rootClass:r,path:c}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(s&&this.#o(u,s),a&&ke.#r(u,a),r){const{classList:d}=u;for(const[f,p]of Object.entries(r))d.toggle(f,p)}if(c){const f=u.firstElementChild.firstElementChild;this.#o(f,c)}}}updateParent(t,e){if(e===this)return;const s=this.#e.get(t);s&&(e.#t.append(s),this.#e.delete(t),e.#e.set(t,s))}remove(t){this.#s.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#s.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Td};globalThis.pdfjsLib={AbortException:Vs,AnnotationEditorLayer:hs,AnnotationEditorParamsType:kt,AnnotationEditorType:bt,AnnotationEditorUIManager:Ys,AnnotationLayer:Vd,AnnotationMode:$s,AnnotationType:ge,applyOpacity:jE,build:VT,ColorPicker:Ei,createValidAbsoluteUrl:Yv,CSSConstants:UE,DOMSVGFactory:ic,DrawLayer:ke,FeatureTest:Me,fetchData:uo,findContrastColor:zE,getDocument:mb,getFilenameFromUrl:ME,getPdfFilenameFromUrl:NE,getRGB:fo,getUuid:Wv,getXfaPageViewport:BE,GlobalWorkerOptions:Ia,ImageKind:Xl,InvalidPDFException:md,isDataScheme:uc,isPdfFile:Pd,isValidExplicitDest:WE,MathClamp:Ue,noContextMenu:Ti,normalizeUnicode:OE,OPS:so,OutputScale:$i,PasswordResponses:_E,PDFDataRangeTransport:yb,PDFDateString:yd,PDFWorker:ao,PermissionFlag:bE,PixelsPerInch:ja,RenderingCancelledException:Bd,renderRichText:Zv,ResponseException:tc,setLayerDimensions:xn,shadow:yt,SignatureExtractor:Ra,stopEvent:ne,SupportedImageMimeTypes:vd,TextLayer:Pe,TouchManager:hc,updateUrlHash:Xv,Util:et,VerbosityLevel:oc,version:qT,XfaLayer:Jv};const y1="/extratordecurriculos/assets/pdf.worker.min-CXgfMxHN.mjs";Ia.workerSrc=y1;async function v1(l){try{const t=await l.arrayBuffer(),e=await mb({data:t,cMapUrl:"https://cdn.jsdelivr.net/npm/pdfjs-dist@4.0.379/cmaps/",cMapPacked:!0,standardFontDataUrl:"https://cdn.jsdelivr.net/npm/pdfjs-dist@4.0.379/standard_fonts/"}).promise;let s="";for(let a=1;a<=e.numPages;a++){const u=(await(await e.getPage(a)).getTextContent()).items.map(d=>d.str).join(`
`);s+=u+`
`}return s}catch(t){throw console.error("PDF Parsing Error:",t),new Error("Falha ao ler o arquivo PDF.")}}const b1=l=>l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_1=l=>l.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,s)=>s?s.toUpperCase():e.toLowerCase()),Av=l=>{const t=_1(l);return t.charAt(0).toUpperCase()+t.slice(1)},xb=(...l)=>l.filter((t,e,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===e).join(" ").trim(),w1=l=>{for(const t in l)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var A1={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const S1=je.forwardRef(({color:l="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:s,className:a="",children:r,iconNode:c,...u},d)=>je.createElement("svg",{ref:d,...A1,width:t,height:t,stroke:l,strokeWidth:s?Number(e)*24/Number(t):e,className:xb("lucide",a),...!r&&!w1(u)&&{"aria-hidden":"true"},...u},[...c.map(([f,p])=>je.createElement(f,p)),...Array.isArray(r)?r:[r]]));const Xs=(l,t)=>{const e=je.forwardRef(({className:s,...a},r)=>je.createElement(S1,{ref:r,iconNode:t,className:xb(`lucide-${b1(Av(l))}`,`lucide-${l}`,s),...a}));return e.displayName=Av(l),e};const E1=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],T1=Xs("circle-alert",E1);const C1=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],x1=Xs("file-text",C1);const R1=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],O1=Xs("loader-circle",R1);const k1=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],D1=Xs("moon",k1);const M1=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],N1=Xs("sun",M1);const L1=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],B1=Xs("trash-2",L1);const P1=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Sv=Xs("upload",P1);const I1=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],U1=Xs("x",I1);function j1(){const[l,t]=je.useState("light"),[e,s]=je.useState(null),[a,r]=je.useState(!1),[c,u]=je.useState([]),[d,f]=je.useState([]),[p,y]=je.useState(""),[v]=je.useState("AIzaSyCc-bKa4MtMQRpafxpOjoGEJjq_vgO64og"),[b,A]=je.useState(null);je.useEffect(()=>{const R=localStorage.getItem("theme")||"light";t(R),document.documentElement.classList.toggle("dark",R==="dark"),E()},[]);const w=()=>{const R=l==="light"?"dark":"light";t(R),localStorage.setItem("theme",R),document.documentElement.classList.toggle("dark",R==="dark")},E=async()=>{try{const{data:R,error:D}=await Yh.from("candidatos").select("*").order("created_at",{ascending:!1});if(D)throw D;u(R||[])}catch(R){console.error("Error fetching candidates:",R)}},S=R=>{R.target.files&&R.target.files[0]&&(s(R.target.files[0]),A(null))},x=async()=>{if(e){if(!v&&!v){A("Por favor, configure a chave da API Gemini no arquivo .env.");return}r(!0),A(null);try{let R="";if(e.type==="application/pdf"?R=await v1(e):R=await e.text(),!R.trim())throw new Error("No foi possvel extrair texto do arquivo.");const D=await vE(R,v);let z=null;if("sb_publishable_0n5CauVZHVHawSW5WIQINg_DZ0xaw6q")try{const{data:Q,error:K}=await Yh.from("candidatos").insert([{nome:D.nome,email:D.email,telefone:D.telefone}]).select();if(K)throw K;z=Q[0]}catch(Q){console.error("Falha ao salvar no Supabase (ignorando e usando modo local):",Q),z={id:`local-error-${Date.now()}`,created_at:new Date().toISOString(),nome:D.nome,email:D.email,telefone:D.telefone}}z&&u([z,...c]),s(null),document.getElementById("file-upload").value=""}catch(R){console.error(R),A(R.message||"Ocorreu um erro ao processar o currculo.")}finally{r(!1)}}},C=R=>{f(D=>D.includes(R)?D.filter(z=>z!==R):[...D,R])},k=()=>{d.length===c.length?f([]):f(c.map(R=>R.id))},L=async()=>{if(d.length===0)return;const{error:R}=await Yh.from("candidatos").delete().in("id",d);R||(u(c.filter(D=>!d.includes(D.id))),f([]))};return st.jsx("div",{className:"min-h-screen p-6 transition-colors duration-300",children:st.jsxs("div",{className:"container",children:[st.jsxs("header",{className:"flex items-center justify-between mb-10",children:[st.jsx("div",{children:st.jsx("h1",{className:"title",children:"Extrator de Currculos"})}),st.jsx("div",{className:"flex gap-3",children:st.jsxs("label",{className:"theme-switch",title:"Alternar Tema",children:[st.jsx("input",{type:"checkbox",checked:l==="dark",onChange:w}),st.jsx("span",{className:"switch-track",children:st.jsx("span",{className:"switch-thumb",children:l==="light"?st.jsx(N1,{size:14,className:"switch-icon"}):st.jsx(D1,{size:14,className:"switch-icon"})})})]})})]}),st.jsxs("div",{className:`card upload-area ${a?"loading":""}`,children:[st.jsx("input",{id:"file-upload",type:"file",accept:".pdf,.txt",onChange:S,className:"hidden"}),e?st.jsxs("div",{className:"flex flex-col items-center gap-4 fade-in",children:[st.jsxs("div",{className:"file-preview",style:{position:"relative",paddingRight:"2.5rem"},children:[st.jsx(x1,{size:20,className:"file-icon"}),st.jsx("span",{className:"font-medium",children:e.name}),st.jsx("button",{onClick:()=>{s(null),A(null),document.getElementById("file-upload").value=""},className:"btn-outline",style:{position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",padding:"0.375rem",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--bg-card)",border:"1px solid var(--border)"},title:"Remover arquivo",children:st.jsx(U1,{size:16})})]}),st.jsx("button",{onClick:x,disabled:a,className:"btn btn-primary",style:{fontSize:"1.125rem",padding:"1.25rem 3rem"},children:a?st.jsxs(st.Fragment,{children:[st.jsx(O1,{className:"animate-spin"})," Processando IA..."]}):"Processar Extrao"})]}):st.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem"},children:[st.jsx("div",{className:"upload-icon",children:st.jsx(Sv,{size:32})}),st.jsxs("div",{style:{textAlign:"center"},children:[st.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Upload do Currculo"}),st.jsx("p",{className:"text-muted mb-4",children:"Selecione um arquivo PDF para processar"})]}),st.jsxs("label",{htmlFor:"file-upload",className:"btn btn-primary cursor-pointer",style:{fontSize:"1rem",padding:"1rem 2.5rem"},children:[st.jsx(Sv,{size:20}),"Escolher Arquivo"]})]}),b&&st.jsxs("div",{className:"alert alert-error",children:[st.jsx(T1,{size:16})," ",b]})]}),st.jsxs("div",{children:[st.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[st.jsx("h3",{className:"text-xl font-bold",children:"Candidatos Processados"}),d.length>0&&st.jsxs("button",{onClick:L,className:"btn btn-outline",style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--error)"},children:[st.jsx(B1,{size:18}),"Excluir Selecionados (",d.length,")"]})]}),st.jsx("div",{className:"card table-container p-0 overflow-hidden",children:st.jsxs("table",{className:"w-full",children:[st.jsx("thead",{children:st.jsxs("tr",{children:[st.jsx("th",{style:{width:"50px",textAlign:"center"},children:st.jsx("input",{type:"checkbox",checked:c.length>0&&d.length===c.length,onChange:k,style:{cursor:"pointer",width:"18px",height:"18px"}})}),st.jsx("th",{className:"text-left",children:"Nome"}),st.jsx("th",{className:"text-left",children:"Email"}),st.jsx("th",{className:"text-left",children:"Telefone"})]})}),st.jsx("tbody",{children:c.length===0?st.jsx("tr",{children:st.jsx("td",{colSpan:4,className:"text-center py-8 text-muted",children:"Nenhum candidato processado ainda."})}):c.map(R=>st.jsxs("tr",{children:[st.jsx("td",{style:{textAlign:"center"},children:st.jsx("input",{type:"checkbox",checked:d.includes(R.id),onChange:()=>C(R.id),style:{cursor:"pointer",width:"18px",height:"18px"}})}),st.jsx("td",{children:R.nome}),st.jsx("td",{children:R.email}),st.jsx("td",{children:R.telefone})]},R.id))})]})})]})]})})}rw.createRoot(document.getElementById("root")).render(st.jsx(je.StrictMode,{children:st.jsx(j1,{})}));
